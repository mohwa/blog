<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!-- viewport 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- keyword 설정 -->
    
    <!-- description 설정 -->
    

    <!-- open graph 설정 -->
    <meta property="og:type" content="mohwa blog">
    
    
    <!--<meta property="og:image" content="http://mysite.com/myimage.jpg">-->
    <meta property="og:url" content="/blog">

    <meta name="copyright" content="by mohwa" />

    <!--<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />-->

    <!-- google search console 설정 -->
    <link rel="alternate" hreflang="ko" href="http://mohwa.github.io" />
    <link rel="alternate" hreflang="ko" href="https://mohwa.github.io" />

    <link rel="stylesheet" href="/blog/assets/css/site.css" />
    <link rel="stylesheet" href="/blog/bower_components/highlightjs/styles/darkula.css">

    <script src="/blog/bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/highlightjs/highlight.pack.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/purl/purl.js" type="text/javascript"></script>
    <!-- Script pointing to jekyll-search.js -->
    <script src="/blog/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>

    <title>Mohwa blog</title>

    <script type="text/javascript">

        // code highlight 적용
        // https://highlightjs.org/static/demo/
        $(document).ready(function() {
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
    </script>
</head>

<body>

  <div class="top-bar"></div>

  <div class="container">
    <div class="site">
      <header>
        <nav>
    <span style="float:left;">
        <a class="" href="/blog/">Home</a>
        <!--<a class="" href="/archive/">전체글</a>-->
        <!--<a class="" href="//github.com/nolboo/nolboo.github.io/wiki">번역글 위키</a>-->
    </span>
    <span style="float:right;">
        <div id="search-container" class="search-container">
            <input type="text" id="search-input" class="search-input" placeholder="search...">
        </div>
    </span>
</nav>

        <div class="pull-right right logo">
          <div class="name"></div>
          <!--<a href="/feed.xml"><img class="avatar" src="/images/rss.jpg" alt="RSS" /></a>-->
        </div>
      </header>
      <div class="separator"></div>
      <ul id="results-container" class="results-container"></ul>
      <!-- ./_layouts/default.html 파일에 정의된  영역으로 아래 내용들이 들어간다. -->
<section>
  <ul class="posts">
    <!-- This loops through the paginated posts -->
    
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/architecture/2015/12/28/jsx-transpilier/">JSXTransformer(in React) 소스 분석</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=architecture">architecture</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-12-28">
                Dec 28, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <h2 id="1-jsxtransformer">1. <a href="https://facebook.github.io/react/blog/2015/06/12/deprecating-jstransform-and-react-tools.html">JSXTransformer</a></h2>

<ul>
<li><p>JSXTransformer 내부에서 사용되는 <a href="https://github.com/facebookarchive/esprima">Esprima-FB</a> 파서는 기존 <a href="https://github.com/ariya/esprima/tree/harmony">Esprima</a> 파서를 확장(<a href="https://github.com/facebook/jsx">JSX 명세</a>) 구현한 버전이다.</p>

<ul>
<li>현재 버전은 <span style="color:#c11f1f">15001.1001.0-dev-harmony-fb</span> 이며, 분석된 내용은 <span style="color:#c11f1f">13001.1001.0-dev-harmony-fb</span> 버전을 따른다.<p></li>
<li><a href="https://fbcdn-dragon-a.akamaihd.net/hphotos-ak-xtf1/t39.3284-6/11057100_835863049837306_1087123501_n.js">JSXTransformer CDN</a></li>
</ul></li>
<li><p>생성된 <a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parse 트리</a> 구조는 모질라의 <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey/Parser_API">Parser AST</a> 인터페이스 명세를 따르고 있다.(or <strong>구현</strong>되어있다)<p></p>

<ul>
<li><p><a href="https://github.com/estree/estree/blob/master/spec.md#programs">Program Interface 명세</a></p>

<p><img src="/blog/assets/images/posts/20151228/jsx_1.png" alt=""></p></li>
</ul></li>
<li><p>소스상의 parser 옵션 수정하여, (파서를 통해)수집된 토큰을 반환받을 수 있다.<p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">getAstForSource</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">disableAstCache</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">esprima</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="p">{</span>
        <span class="c1">// 아래와 같이 tokens 속성을 추가 한다.</span>
        <span class="nx">tokens</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">comment</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">loc</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">range</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">sourceType</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">sourceType</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">disableAstCache</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ast</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ast</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151228/jsx_2.png" alt=""></p></li>
<li><p><a href="http://esprima.org/">Esprima 공식 홈페이지</a></p></li>
<li><p><a href="https://github.com/estree/estree">The ESTree Spec</a><p></p></li>
<li><p><a href="https://github.com/facebook/jsx/blob/master/AST.md">JSX Tree Spec</a></p></li>
</ul>

<h2 id="2-parse">2. 소스 수집 및 <a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parse 트리</a> 가 생성되는 과정</h2>

<ul>
<li><p>아래 소스는 <em><a href="https://github.com/facebookarchive/esprima">Parser</a></em> 에 의해 파싱될 <span style="color:#c11f1f">원본 소스</span>이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/jsx&quot;</span><span class="o">&gt;</span>

    <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">){</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;;</span>

        <span class="k">return</span> <span class="nx">elem</span><span class="p">;</span>
    <span class="p">}</span>

<span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div></li>
<li><p>소스 수집 과정</p>

<ul>
<li><p>기본적으로 <span style="color:#c11f1f"><em>text/jsx</em></span> 타입을 가진 <em>Script Element</em> 내부 소스(or 코드)는 브라우저에 의해 처리되지않는다.</p>
<div class="highlight"><pre><code class="language-html" data-lang="html">  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/jsx&quot;</span><span class="nt">&gt;</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;이 실행 코드는 브라우저에 의해 처리되지 않는다....&#39;</span><span class="p">);</span>
  <span class="nt">&lt;/script&gt;</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f"><em>text/jsx</em></span> 타입을 가진 모든 <em>Script Element</em> 를 수집한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">runScripts</span><span class="p">()</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">scripts</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>

      <span class="c1">// Array.prototype.slice cannot be used on NodeList on IE8</span>
      <span class="kd">var</span> <span class="nx">jsxScripts</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">scripts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="sr">/^text\/jsx(;|$)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">scripts</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
              <span class="nx">jsxScripts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">scripts</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
          <span class="p">}</span>
      <span class="p">}</span>

      <span class="p">...</span> 

      <span class="c1">// loadScripts 함수를 호출하여, script element 내부에 포함된 원본 소스를 가져온다.    </span>
      <span class="nx">loadScripts</span><span class="p">(</span><span class="nx">jsxScripts</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p>만약 inline code 로 작성된 경우에는 <em>script.innerHTML</em> 속성 값을 통해 소스를 가져오고, <em>script.src</em> 속성 값이 있는 경우에는 <span style="color:#c11f1f"><em>xhr</em></span> 을 통해 가져온다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// script.src 속성 값이 있는 경우</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">async</span><span class="o">:</span> <span class="nx">async</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">executed</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">content</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">loaded</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="nx">script</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
    <span class="p">};</span>

    <span class="c1">// xhr 을 통해 해당 소스를 가져온다.    </span>
    <span class="nx">load</span><span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">loaded</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="c1">// content === source code</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">content</span> <span class="o">=</span> <span class="nx">content</span><span class="p">;</span>
        <span class="nx">check</span><span class="p">();</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">error</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">check</span><span class="p">();</span>
    <span class="p">});</span>

<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

    <span class="c1">// inline code 로 작성된 경우..</span>
    <span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">async</span><span class="o">:</span> <span class="nx">async</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">executed</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nx">content</span><span class="o">:</span> <span class="nx">script</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">,</span>
        <span class="nx">loaded</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">options</span><span class="o">:</span> <span class="nx">options</span>
    <span class="p">};</span>
<span class="p">}</span>  
</code></pre></div></li>
<li><p>수집된 <span style="color:#c11f1f">원본 소스</span>는 <em><a href="https://github.com/facebookarchive/esprima">Parser</a></em> 를 통해 <strong>파싱</strong>된 후, 새로운 <em>Script Element</em> 를 통해 로드 및 실행된다.</p>

<ul>
<li><em>즉 생성된 Script Element 에 할당된 소스는 <span style="color:#c11f1f">파싱된 소스</span>를 가리킨다.</em><p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">run</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// script element 를 생성한다.</span>
      <span class="kd">var</span> <span class="nx">scriptEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
      <span class="c1">// transformCode 함수를 통해 파서가 호출된다.</span>
      <span class="nx">scriptEl</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">transformCode</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

      <span class="c1">// 파서에 의해 파싱된 소스</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">scriptEl</span><span class="p">.</span><span class="nx">text</span><span class="p">);</span>

      <span class="c1">// header element 의 자식 element 로 추가 시킨다.</span>
      <span class="nx">headEl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">scriptEl</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">파싱된 소스</span> 및 <span style="color:#c11f1f">원본 소스</span></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 파서를 통해 파싱된 소스</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">){</span>

 <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>

 <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>

 <span class="k">return</span> <span class="nx">elem</span><span class="p">;</span>
<span class="p">}</span> 
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151228/jsx_3.png" alt=""></p></li>
</ul></li>
<li><p><a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parse 트리</a> 생성 과정</p>

<ul>
<li><p><span style="color:#6298c1">transformCode</span> 함수가 호출된 후, 여러 단계(<span style="color:#6298c1">transformReact</span>... , <span style="color:#6298c1">transform</span> 등)를 거쳐, esprima.parse 함수를 통해, <em>Parse</em> 트리(AST)를 생성하는 함수인 <span style="color:#6298c1">getAstForSource</span> 함수를 호출하게 된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">getAstForSource</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">disableAstCache</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">// esprima 파서를 호출한다.(최종 파스 트리를 반환받는다)</span>
    <span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">esprima</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">comment</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">loc</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">range</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">sourceType</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">sourceType</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">disableAstCache</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_astCache</span><span class="p">[</span><span class="nx">source</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ast</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 생성된 파스 트리를 반환한다.</span>
    <span class="k">return</span> <span class="nx">ast</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></li>
<li><p>먼저 <span style="color:#6298c1">esprima.parse</span> 함수가 호출되면, (여러 단계를 거친 후...)<span style="color:#6298c1"> advance</span> 함수를 통해 <span style="color:#c11f1f">원본 소스</span>에 포함된 각 문자(Char)의 의미를 분석 후, 분리된 토큰(어휘)을 객체화 시킨다.(<em>내부적으로는 더 많은 단계를 거치게된다</em>)</p>

<ul>
<li><p><span style="color:#6298c1">advance</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">advance</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">ch</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">state</span><span class="p">.</span><span class="nx">inJSXChild</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">skipComment</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// 소스 분석이 종료되는 시점</span>
    <span class="c1">// 현재 index(코드의 위치)가 length(포함된 소스의 전체 길이) 보다 크거나 같을경우</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">EOF</span><span class="p">,</span>
            <span class="nx">lineNumber</span><span class="o">:</span> <span class="nx">lineNumber</span><span class="p">,</span>
            <span class="nx">lineStart</span><span class="o">:</span> <span class="nx">lineStart</span><span class="p">,</span>
            <span class="nx">range</span><span class="o">:</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">index</span><span class="p">]</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="c1">// state.inJSXChild 가 true 인 경우(tag 열림(&#39;&lt;&#39;) 상태가, 닫힘(&#39;&gt;&#39;) 상태로 변경되었을 경우)</span>
    <span class="c1">// 즉 div element 가 닫힘(&#39;&gt;&#39;) 문자로 인해 닫힌경우(단 열림(&#39;&lt;&#39;) 문자 뒤에 &#39;/&#39; 문자가 오는 경우는 제외된다)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">inJSXChild</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">advanceJSXChild</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// 원본 소스에 포함된 각 문자(Char)를 아스키 코드로 변환한다.               </span>
    <span class="nx">ch</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>

    <span class="cm">/*</span>
<span class="cm">      변환된 아스키 코드를 식별 후, 각 token 객체를 생성한다.</span>
<span class="cm">    */</span>

    <span class="c1">// Very common: ( and ) and ;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">40</span> <span class="o">||</span> <span class="nx">ch</span> <span class="o">===</span> <span class="mi">41</span> <span class="o">||</span> <span class="nx">ch</span> <span class="o">===</span> <span class="mi">58</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scanPunctuator</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// String literal starts with single quote (#39) or double quote (#34).</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">39</span> <span class="o">||</span> <span class="nx">ch</span> <span class="o">===</span> <span class="mi">34</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">inJSXTag</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">scanJSXStringLiteral</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">scanStringLiteral</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">inJSXTag</span> <span class="o">&amp;&amp;</span> <span class="nx">isJSXIdentifierStart</span><span class="p">(</span><span class="nx">ch</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scanJSXIdentifier</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">96</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scanTemplate</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// 해당 문자의 의미를 분석 후, 토큰 객체를 생성한다.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isIdentifierStart</span><span class="p">(</span><span class="nx">ch</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scanIdentifier</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Dot (.) char #46 can also start a floating-point number, hence the need</span>
    <span class="c1">// to check the next character.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">46</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isDecimalDigit</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">scanNumericLiteral</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">scanPunctuator</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isDecimalDigit</span><span class="p">(</span><span class="nx">ch</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scanNumericLiteral</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Slash (/) char #47 can also start a regex.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">extra</span><span class="p">.</span><span class="nx">tokenize</span> <span class="o">&amp;&amp;</span> <span class="nx">ch</span> <span class="o">===</span> <span class="mi">47</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">advanceSlash</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">scanPunctuator</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></li>
</ul></li>
<li><p>예를들어, 위 <span style="color:#6298c1">isIdentifierStart</span> 함수로 해당 <span style="color:#c11f1f">아스키 코드</span>(문자)의 <a href="https://ko.wikibooks.org/wiki/%EC%8B%9D%EB%B3%84%EC%9E%90">의미</a>를 분석 후, <span style="color:#6298c1">scanIdentifier</span> 함수를 통해 <span style="color:#c11f1f">토큰</span>(어휘) 객체를 생성한다.</p>

<ul>
<li><p><span style="color:#6298c1">isIdentifierStart</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">isIdentifierStart</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 해당 아스키 코드의 의미를 분석한다.</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">36</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">95</span><span class="p">)</span> <span class="o">||</span>  <span class="c1">// $ (dollar) and _ (underscore)</span>
          <span class="p">(</span><span class="nx">ch</span> <span class="o">&gt;=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="nx">ch</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">)</span> <span class="o">||</span>         <span class="c1">// A..Z</span>
          <span class="p">(</span><span class="nx">ch</span> <span class="o">&gt;=</span> <span class="mi">97</span> <span class="o">&amp;&amp;</span> <span class="nx">ch</span> <span class="o">&lt;=</span> <span class="mi">122</span><span class="p">)</span> <span class="o">||</span>        <span class="c1">// a..z</span>
          <span class="p">(</span><span class="nx">ch</span> <span class="o">===</span> <span class="mi">92</span><span class="p">)</span> <span class="o">||</span>                    <span class="c1">// \ (backslash)</span>
          <span class="p">((</span><span class="nx">ch</span> <span class="o">&gt;=</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Regex</span><span class="p">.</span><span class="nx">NonAsciiIdentifierStart</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">ch</span><span class="p">)));</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#6298c1">scanIdentifier</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">scanIdentifier</span><span class="p">()</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">type</span><span class="p">;</span>

      <span class="nx">start</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>

      <span class="c1">// Backslash (char #92) starts an escaped character.</span>

      <span class="cm">/*</span>

<span class="cm">      // 토큰 타입</span>
<span class="cm">      Token = {</span>
<span class="cm">          BooleanLiteral: 1,</span>
<span class="cm">          EOF: 2,</span>
<span class="cm">          Identifier: 3,</span>
<span class="cm">          Keyword: 4,</span>
<span class="cm">          NullLiteral: 5,</span>
<span class="cm">          NumericLiteral: 6,</span>
<span class="cm">          Punctuator: 7,</span>
<span class="cm">          StringLiteral: 8,</span>
<span class="cm">          RegularExpression: 9,</span>
<span class="cm">          Template: 10,</span>
<span class="cm">          JSXIdentifier: 11,</span>
<span class="cm">          JSXText: 12</span>
<span class="cm">      };</span>

<span class="cm">      */</span>                          
      <span class="c1">// 식별된 토큰이 id 변수로 할당된다.               </span>
      <span class="c1">// 예: function(분리된 토큰 문자열)</span>
      <span class="nx">id</span> <span class="o">=</span> <span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="o">===</span> <span class="mi">92</span><span class="p">)</span> <span class="o">?</span> <span class="nx">getEscapedIdentifier</span><span class="p">()</span> <span class="o">:</span> <span class="nx">getIdentifier</span><span class="p">();</span> 

      <span class="c1">// There is no keyword or literal with only one character.</span>
      <span class="c1">// Thus, it must be an identifier.</span>

      <span class="c1">// 해당 토큰 타입을 설정한다.(식별자, 키워드, 일부 literal(null, boolean))</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">id</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">type</span> <span class="o">=</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">Identifier</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isKeyword</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">type</span> <span class="o">=</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">Keyword</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;null&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">type</span> <span class="o">=</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">NullLiteral</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;true&#39;</span> <span class="o">||</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">type</span> <span class="o">=</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">BooleanLiteral</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">type</span> <span class="o">=</span> <span class="nx">Token</span><span class="p">.</span><span class="nx">Identifier</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="c1">// 생성된 토큰 객체를 반환한다.</span>
      <span class="k">return</span> <span class="p">{</span>
          <span class="nx">type</span><span class="o">:</span> <span class="nx">type</span><span class="p">,</span> <span class="c1">// 4(Keyword)</span>
          <span class="nx">value</span><span class="o">:</span> <span class="nx">id</span><span class="p">,</span> <span class="c1">// &#39;function&#39;</span>
          <span class="nx">lineNumber</span><span class="o">:</span> <span class="nx">lineNumber</span><span class="p">,</span> <span class="c1">// 3</span>
          <span class="nx">lineStart</span><span class="o">:</span> <span class="nx">lineStart</span><span class="p">,</span> <span class="c1">// 2</span>
          <span class="nx">range</span><span class="o">:</span> <span class="p">[</span><span class="nx">start</span><span class="p">,</span> <span class="nx">index</span><span class="p">]</span> <span class="c1">// 6, 14</span>
      <span class="p">};</span>
  <span class="p">}</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151228/jsx_4.png" alt=""></p></li>
</ul></li>
<li><p>생성된 <span style="color:#c11f1f">토큰</span>(어휘) 객체를 통해 <em>Parse</em>(AST) 트리 구성을 위한 <span style="color:#c11f1f">노드</span>가 구성된다.</p>

<ul>
<li><p><a href="https://github.com/estree/estree/blob/master/spec.md#functiondeclaration">FunctionDeclaration 명세</a></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kr">interface</span> <span class="nx">FunctionDeclaration</span> <span class="o">&lt;:</span> <span class="nb">Function</span><span class="p">,</span> <span class="nx">Declaration</span> <span class="p">{</span>
      <span class="c1">// 노드 타입</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;FunctionDeclaration&quot;</span><span class="p">;</span>
      <span class="c1">// 해당 함수 선언식에 대한 식별자 정보</span>
      <span class="nx">id</span><span class="o">:</span> <span class="nx">Identifier</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#6298c1">parseFunctionDeclaration</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">parseFunctionDeclaration</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="nx">tmp</span><span class="p">,</span> <span class="nx">firstRestricted</span><span class="p">,</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">generator</span><span class="p">,</span> <span class="nx">isAsync</span><span class="p">,</span>
        <span class="nx">previousStrict</span><span class="p">,</span> <span class="nx">previousYieldAllowed</span><span class="p">,</span> <span class="nx">previousAwaitAllowed</span><span class="p">,</span>
        <span class="nx">marker</span> <span class="o">=</span> <span class="nx">markerCreate</span><span class="p">(),</span> <span class="nx">typeParameters</span><span class="p">;</span>

    <span class="nx">isAsync</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">matchAsync</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">lex</span><span class="p">();</span>
        <span class="nx">isAsync</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">expectKeyword</span><span class="p">(</span><span class="s1">&#39;function&#39;</span><span class="p">);</span>

    <span class="nx">generator</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">lex</span><span class="p">();</span>
        <span class="nx">generator</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">token</span> <span class="o">=</span> <span class="nx">lookahead</span><span class="p">;</span>

    <span class="nx">id</span> <span class="o">=</span> <span class="nx">parseVariableIdentifier</span><span class="p">();</span>

    <span class="p">...</span>

    <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">parseParams</span><span class="p">(</span><span class="nx">firstRestricted</span><span class="p">);</span>
    <span class="nx">firstRestricted</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">firstRestricted</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">tmp</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">message</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="p">...</span>

    <span class="nx">body</span> <span class="o">=</span> <span class="nx">parseFunctionSourceElements</span><span class="p">();</span>

    <span class="p">...</span>

    <span class="c1">// 함수 선언식에 대한 Parse 트리 노드를 생성한다.</span>
    <span class="k">return</span> <span class="nx">markerApply</span><span class="p">(</span>
        <span class="nx">marker</span><span class="p">,</span>
        <span class="nx">delegate</span><span class="p">.</span><span class="nx">createFunctionDeclaration</span><span class="p">(</span>
            <span class="nx">id</span><span class="p">,</span>
            <span class="nx">tmp</span><span class="p">.</span><span class="nx">params</span><span class="p">,</span>
            <span class="nx">tmp</span><span class="p">.</span><span class="nx">defaults</span><span class="p">,</span>
            <span class="nx">body</span><span class="p">,</span>
            <span class="nx">tmp</span><span class="p">.</span><span class="nx">rest</span><span class="p">,</span>
            <span class="nx">generator</span><span class="p">,</span>
            <span class="kc">false</span><span class="p">,</span>
            <span class="nx">isAsync</span><span class="p">,</span>
            <span class="nx">tmp</span><span class="p">.</span><span class="nx">returnType</span><span class="p">,</span>
            <span class="nx">typeParameters</span>
        <span class="p">)</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151228/jsx_5.png" alt=""></p></li>
</ul></li>
<li><p>각 <span style="color:#c11f1f">노드</span>가 조합되어, 최종 <em>Parse</em> 트리가 생성된다.</p>

<p><img src="/blog/assets/images/posts/20151228/jsx_6.png" alt=""></p></li>
<li><p><span style="color:#6298c1">utils.append</span>, <span style="color:#6298c1">utils.catchup</span> 함수(또 다른 함수 등)로 각 <span style="color:#c11f1f">노드</span> 객체 및 <span style="color:#c11f1f">state</span> 등을 전달하여, 최종 결과물인 <span style="color:#c11f1f">파싱된 소스</span>를 만들어 간다.(즉 source buffer 를 채워나간다)</p>

<ul>
<li><p><span style="color:#6298c1">utils.append</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="cm">/**</span>
<span class="cm">   * Appends a string of text to the buffer</span>
<span class="cm">   *</span>
<span class="cm">   * @param {string} str</span>
<span class="cm">   * @param {object} state</span>
<span class="cm">   */</span>
  <span class="kd">function</span> <span class="nx">append</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMap</span> <span class="o">&amp;&amp;</span> <span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMap</span><span class="p">.</span><span class="nx">addMapping</span><span class="p">({</span>
              <span class="nx">generated</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="p">},</span>
              <span class="nx">original</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceColumn</span> <span class="p">},</span>
              <span class="nx">source</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMapFilename</span>
          <span class="p">});</span>
          <span class="kd">var</span> <span class="nx">transformedLines</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">transformedLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span> <span class="o">+=</span> <span class="nx">transformedLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="o">+=</span>
              <span class="nx">transformedLines</span><span class="p">[</span><span class="nx">transformedLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">+=</span> <span class="nx">str</span><span class="p">;</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#6298c1">utils.catchup</span> 함수 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="cm">/**</span>
<span class="cm">   * Given a state fill the resulting buffer from the original source up to</span>
<span class="cm">   * the end</span>
<span class="cm">   *</span>
<span class="cm">   * @param {number} end</span>
<span class="cm">   * @param {object} state</span>
<span class="cm">   * @param {?function} contentTransformer Optional callback to transform newly</span>
<span class="cm">   *                                       added content.</span>
<span class="cm">   */</span>
  <span class="kd">function</span> <span class="nx">catchup</span><span class="p">(</span><span class="nx">end</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">contentTransformer</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;utils.catchup 함수 호출&#39;</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;source position&#39;</span><span class="p">,</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">position</span><span class="p">,</span> <span class="nx">end</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">end</span> <span class="o">&lt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// cannot move backwards</span>
          <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">position</span><span class="p">,</span> <span class="nx">end</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">transformed</span> <span class="o">=</span> <span class="nx">updateIndent</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">state</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMap</span> <span class="o">&amp;&amp;</span> <span class="nx">transformed</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// record where we are</span>
          <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMap</span><span class="p">.</span><span class="nx">addMapping</span><span class="p">({</span>
              <span class="nx">generated</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="p">},</span>
              <span class="nx">original</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceColumn</span> <span class="p">},</span>
              <span class="nx">source</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMapFilename</span>
          <span class="p">});</span>

          <span class="c1">// record line breaks in transformed source</span>
          <span class="kd">var</span> <span class="nx">sourceLines</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">transformedLines</span> <span class="o">=</span> <span class="nx">transformed</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
          <span class="c1">// Add line break mappings between last known mapping and the end of the</span>
          <span class="c1">// added piece. So for the code piece</span>
          <span class="c1">//  (foo, bar);</span>
          <span class="c1">// &gt; var x = 2;</span>
          <span class="c1">// &gt; var b = 3;</span>
          <span class="c1">//   var c =</span>
          <span class="c1">// only add lines marked with &quot;&gt;&quot;: 2, 3.</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">sourceLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMap</span><span class="p">.</span><span class="nx">addMapping</span><span class="p">({</span>
                  <span class="nx">generated</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="mi">0</span> <span class="p">},</span>
                  <span class="nx">original</span><span class="o">:</span> <span class="p">{</span> <span class="nx">line</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceLine</span><span class="p">,</span> <span class="nx">column</span><span class="o">:</span> <span class="mi">0</span> <span class="p">},</span>
                  <span class="nx">source</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceMapFilename</span>
              <span class="p">});</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceLine</span><span class="o">++</span><span class="p">;</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span><span class="o">++</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="c1">// offset for the last piece</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">sourceLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceLine</span><span class="o">++</span><span class="p">;</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferLine</span><span class="o">++</span><span class="p">;</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceColumn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
              <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">sourceColumn</span> <span class="o">+=</span> <span class="nx">sourceLines</span><span class="p">[</span><span class="nx">sourceLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
          <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">bufferColumn</span> <span class="o">+=</span>
              <span class="nx">transformedLines</span><span class="p">[</span><span class="nx">transformedLines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">+=</span>
          <span class="nx">contentTransformer</span> <span class="o">?</span> <span class="nx">contentTransformer</span><span class="p">(</span><span class="nx">transformed</span><span class="p">)</span> <span class="o">:</span> <span class="nx">transformed</span><span class="p">;</span>

      <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">end</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div></li>
</ul>

<p><img src="/blog/assets/images/posts/20151228/jsx_7.png" alt=""></p></li>
</ul></li>
<li><p><span style="color:#6298c1">transform</span> 함수를 통해, 최종 <span style="color:#c11f1f">파싱된 소스</span>가 포함된 객체를 반환하여, <strong>소스 수집 과정</strong>에서 말한바와 같이 <em>Script Element</em> 를 통해 로드 및 실행된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">transform</span><span class="p">(</span><span class="nx">visitors</span><span class="p">,</span> <span class="nx">source</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{};</span>

    <span class="kd">var</span> <span class="nx">ast</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// 파스 트리를 생성한다.</span>
        <span class="nx">ast</span> <span class="o">=</span> <span class="nx">getAstForSource</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s1">&#39;Parse Error: &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
        <span class="k">throw</span> <span class="nx">e</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">createState</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">ast</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">visitors</span> <span class="o">=</span> <span class="nx">visitors</span><span class="p">;</span>

    <span class="p">....</span>

    <span class="nx">traverse</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">[],</span> <span class="nx">state</span><span class="p">);</span>

    <span class="nx">utils</span><span class="p">.</span><span class="nx">catchup</span><span class="p">(</span><span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">state</span><span class="p">);</span>

    <span class="c1">// state.g.buffer: 최종 파싱된 소스</span>
    <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">{</span><span class="nx">code</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">extra</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">extra</span><span class="p">};</span>

    <span class="p">....</span>

    <span class="c1">// 파싱된 소스(ret.code)를 포함하는 객체를 반환한다.</span>
    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">}</span>  
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151228/jsx_8.png" alt=""></p></li>
</ul>

<h2 id="3">3. 마치며</h2>

<ul>
<li><p>이 글은 <span style="color:#c11f1f">파서</span> 과정 중 <span style="color:#c11f1f">포인트</span>가 될만한 부분을 골라내어 분석한 글이며, 더 자세한 내용을 알기위해서는 더 깊이있는 <span style="color:#c11f1f">소스 분석</span>이 필요하다.</p></li>
<li><p>요즘 트렌드인 <a href="https://facebook.github.io/react/index.html">React</a> 사용 방법과는 크게 상관 부분이지만, <strong>JSXTransformer</strong> 와 같은, 자신만의 Transpiler(or 언어) 를 제작해보고 싶은 사람이라면, 한번쯤 <a href="https://fbcdn-dragon-a.akamaihd.net/hphotos-ak-xtf1/t39.3284-6/11057100_835863049837306_1087123501_n.js">이와 같은</a> 소스를 분석해보는것도 좋을 듯 하다.</p></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/architecture/2015/12/28/jsx-transpilier/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/architecture/2015/12/10/dom/">DOM(Document Object Model)</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=architecture">architecture</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-12-10">
                Dec 10, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <h2 id="1-dom">1. DOM 이라는 단어가 가진 <a href="http://krdic.naver.com/detail.nhn?docid=13706300">모호</a>성</h2>

<ul>
<li><p><strong>DOM</strong> 은 바라보는 <span style="color:#c11f1f">관점</span>에 따라 여러가지로 표현될 수 있다.</p>

<ul>
<li><em>문서의 성격에 따라 DOM 을 다르게 표현하는 가장 큰 이유 중 하나이다.</em></li>
</ul></li>
</ul>

<h2 id="2">2. 용어 정리</h2>

<ul>
<li>브라우저의 주요 구성 요소</li>
</ul>

<p><img src="/blog/assets/images/posts/20151207/dom_11.png" alt=""></p>

<ul>
<li><p><span style="color:#c11f1f"><a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4">인터페이스</a> 관점</span>에서 바라본 DOM: <strong>DOM</strong> Interfaces(<a href="https://developer.mozilla.org/en-US/docs/Web/API/Attr">Attr</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document">Document</a> Interface 등), <strong>HTML</strong> Interfaces(<a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLHtmlElement">HTMLHtmlElement</a> Interface 등), <strong>SVG</strong> Interfaces(<a href="https://developer.mozilla.org/en-US/docs/Web/API/SVGAElement">SVGAElement</a> Interface 등) 등을 포함한 <span style="color:#c11f1f">Programing Interface</span> 를 의미한다.<p /></p></li>
<li><p><span style="color:#c11f1f"><a href="https://ko.wikipedia.org/wiki/API">API</a> 관점</span>에서 바라본 DOM: 특정 <a href="https://ko.wikipedia.org/wiki/%EC%BB%B4%ED%93%A8%ED%8C%85_%ED%94%8C%EB%9E%AB%ED%8F%BC">플랫폼</a> 상에서 특정 <strong>언어</strong>(C++, JAVA, JS 등)를 통해 <span style="color:#c11f1f">Programing Interface</span> 를 구현한 <span style="color:#c11f1f">API</span> 를 의미한다.<p /></p>

<ul>
<li><p>구현된 <strong>API</strong> 는 두 가지 형태로 나눌 수 있다.</p>

<ul>
<li><p>엔진 내부에 구현된 API<p></p>

<ul>
<li>webkit 엔진은 <strong>C++</strong> 언어를 통해 <span style="color:#c11f1f">Programing Interface</span> 를 구현한 <span style="color:#c11f1f">API</span> 를 사용한다.<p>

<ul>
<li>해당 인터페이스를 작성하기 위해 <a href="https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4_%EC%A0%95%EC%9D%98_%EC%96%B8%EC%96%B4">인터페이스 정의 언어</a>(*.idl) 를 사용한다.<p></li>
<li><a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/dom/Document.idl">Document.idl</a>, <a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/dom/Document.h">Document.h</a>, <a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/dom/Document.cpp">Document.cpp</a><p></li>
<li><a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/html/HTMLHtmlElement.idl">HTMLHtmlElement.idl</a>, <a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/html/HTMLHtmlElement.h">HTMLHtmlElement.h</a>, <a href="https://github.com/WebKit/webkit/blob/master/Source/WebCore/html/HTMLHtmlElement.cpp">HTMLHtmlElement.cpp</a><p></li>
</ul></li>
</ul></li>
<li><p><strong>DOM 트리</strong>(or <a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parse 트리</a>)를 JS 로 제어하기위해 구현된 API(즉 문서(HTML 등)의 Element 를 제어하기 위한 API 이다)<p></p>

<ul>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLHtmlElement">HTMLHtmlElement</a> 인터페이스 명세에는, 문서의 DTD <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLHtmlElement/version">version</a> 정보를 반환받기 위한 속성이 명세되어있으며, 이 속성은 아래와 같이 구현되어있다.</p>

<ul>
<li><em>HTMLHtmlElement 는 root element(html)를 위한 인터페이스이다.</em><p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// HTMLHtmlElement 생성자 함수 객체</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">HTMLHtmlElement</span><span class="p">);</span>

  <span class="c1">// HTMLHtmlElement 생성자 함수 객체의 원형</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">HTMLHtmlElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151207/dom_13.png" alt=""></p>

<p>원형(prototype) 객체 내부에는 <strong>version</strong> 속성이 구현되어있다.</p>

<p><img src="/blog/assets/images/posts/20151207/dom_14.png" alt="">       </p>

<p>또한 html element 를 가리키는 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/documentElement">Document.documentElement</a> 객체를 통해, <strong>version</strong> 정보를 가져올 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">);</span> <span class="c1">// html element object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">version</span><span class="p">);</span> <span class="c1">// dtd version</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151207/dom_15.png" alt=""></p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/documentElement">Document.documentElement</a> 객체의 __proto__ 속성은 HTMLHtmlElement 함수 객체의 원형(prototype) 을 가리키고 있다.</p>

<ul>
<li>즉 document.documentElement 객체는 HTMLHtmlElement 생성자 함수 객체로 생성된 <strong>객체</strong>라는것을 알 수 있다.<p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// 위임 과정을 통해 HTMLHtmlElement.prototype 객체가 생성된 document.documentElement 객체의 __proto__ 속성으로 위임된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nx">HTMLHtmlElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div>
<p><a href="http://mohwa.github.io/blog/javascript/2015/10/16/prototype/">객체 지향 언어의 두 가지 줄기</a></p></li>
<li><p>Element 를 생성하기 위한 모든 생성자 함수(HTMLHtmlElement, HTMLHeadElement 등) 객체는 명시적으로 호출 할 수 없으며, 원형 객체의 속성에도 접근할 수 없다.</p>

<ul>
<li><em>Element 생성자 함수 객체에 대한, <strong>접근 권한</strong>을 두고 있는듯 하다.</em><p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">try</span> <span class="p">{</span>

    <span class="c1">// HTMLHtmlElement 생성자 함수 객체를 호출한다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">HTMLHtmlElement</span><span class="p">());</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// Illegal constructor</span>
<span class="p">}</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="c1">// 원형(prototype) 객체에 구현된 version 속성에 접근한다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">HTMLHtmlElement</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">version</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// llegal invocation</span>
<span class="p">}</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="c1">// HTMLHeadElement 생성자 함수 객체를 호출한다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">new</span> <span class="nx">HTMLHeadElement</span><span class="p">());</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// Illegal constructor</span>
<span class="p">}</span>
</code></pre></div></li>
<li><p><a href="https://developer.mozilla.org/ko/docs/Web/API/Document/createElement">document.createElement</a> 함수는 암묵적으로 Element 를 생성하기위한 방법 중 하나이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 암묵적으로 html element 를 생성할 수 있다.</span>
<span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">html</span><span class="p">.</span><span class="nx">version</span><span class="p">);</span> <span class="c1">// dtd version</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h2 id="3">3. 어휘 분석과 구문 분석 과정</h2>

<ul>
<li>문서 분석 과정</li>
</ul>

<p><img src="/blog/assets/images/posts/20151207/dom_16.png" alt=""></p>

<ul>
<li><p>DOM 트리(or <a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parse 트리</a>) 생성 과정을 이해하기위해서는, 먼저 문서를 분석하는 과정인 <span style="color:#c11f1f">어휘 분석</span>과 <span style="color:#c11f1f">구문 분석</span> 과정을 이해해야한다.</p></li>
<li><p>어휘분석(lexical analysis): 문서의 내용을 의미 있는 문자(<strong>태그</strong>)로 분리하여 <span style="color:#c11f1f">토큰화</span> 시키는 과정을 말한다.<p></p>

<ul>
<li><p><em>생성된 토큰은 태그 이름, 속성 이름, 속성 값이 포함된 객체로 나타낼 수 있다.</em></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="p">{</span><span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">attrs</span><span class="o">:</span> <span class="p">[{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;http://google.com&#39;</span><span class="p">},</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;_blank&#39;</span><span class="p">}]};</span>
</code></pre></div></li>
</ul></li>
<li><p>구문분석(syntax analysis): 생성된 <span style="color:#c11f1f">토큰</span>을 <a href="https://ko.wikipedia.org/wiki/%EA%B5%AC%EB%AC%B8_%EB%B6%84%EC%84%9D">Parser</a>(구문 분석기)를 통해, <span style="color:#c11f1f">노드화</span>(노드 객체) 시킨 후 DOM 트리에 추가시키는 과정을 말한다.</p></li>
</ul>

<h2 id="4-dom">4. DOM 트리 생성 과정</h2>

<ul>
<li><p>HTML 파싱 시퀀스 다이어그램</p>

<p><img src="/blog/assets/images/posts/20151207/dom_17.png" alt=""></p></li>
<li><p>브라우저는 디스크나 네트워크를 통해 해당 문서를 <a href="http://m.terms.naver.com/entry.nhn?docId=844067&amp;cid=42346&amp;categoryId=42346">바이트 코드</a>로 읽어드린 후, 지정된 인코딩 값(or <strong>방식</strong>)에 따라 원시 데이터인 <span style="color:#c11f1f">문자열</span>로 변환한다.</p>

<ul>
<li><em>바이트 코드: 프로그램이 컴파일된 형태</em></li>
</ul></li>
<li><p>변환된 <span style="color:#c11f1f">문자열</span>을 의미 있는 문자(<strong>태그</strong>)로 분리하여 <span style="color:#c11f1f">토큰화</span> 시킨다.</p></li>
<li><p><span style="color:#c11f1f">토큰</span>이 가진 tagName 과 일치하는 HTMLElement 를 생성 후 해당 속성을 추가시킨다.</p></li>
<li><p>부모 노드의 자식 노드로 생성된 HTMLElement 를 추가 시킨다(즉 DOM 트리에 반영시킨다)<p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// tagName 을 통해 Element 를 생성한다.</span>
<span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">createHTMLElement</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">tagName</span><span class="p">);</span>

<span class="c1">// 속성을 추가 시킨다.</span>
<span class="nx">elem</span><span class="p">.</span><span class="nx">setAttrs</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>

<span class="c1">// 부모 노드의 자식 노드로 해당 Element 를 추가 시킨다.</span>
<span class="nx">parentNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">elem</span><span class="p">);</span>
</code></pre></div></li>
</ul>

<h2 id="url">관련 URL</h2>

<ul>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model">MDN Document Object Model (DOM)</a><p /></p></li>
<li><p><a href="http://www.w3.org/TR/DOM-Level-2-Core/introduction.html">What is the Document Object Model?</a><p /></p></li>
<li><p><a href="http://www.w3.org/DOM/">W3C Document Object Model (DOM)</a><p /></p></li>
<li><p><a href="http://okjungsoo.tistory.com/entry/DOM%EC%9D%84-%EA%B5%AC%ED%98%84%ED%95%9C%EB%8B%A4%EB%8A%94-%ED%91%9C%ED%98%84%EC%9D%80-%EB%B0%98%EB%93%9C%EC%8B%9C-binding%EC%9D%B4-%EB%90%98%EC%96%B4%EC%95%BC-%ED%95%A0%EA%B9%8C%EC%9A%94">DOM을 구현한다는 표현은 반드시 binding이 되어야 할까요?</a><p /></p></li>
<li><p><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/constructing-the-object-model?hl=ko">객체 모델 생성</a></p></li>
<li><p><a href="http://okky.kr/article/112613">브라우저와 dom 관련</a></p></li>
<li><p><a href="http://seodh007.tistory.com/entry/%EC%9D%B8%ED%84%B0%ED%94%84%EB%A6%AC%ED%84%B0%EC%96%B8%EC%96%B4-%EC%99%80-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%96%B8%EC%96%B4%EC%9D%98-%EB%9C%BB">인터프리터언어 와 컴파일언어의 뜻</a></p></li>
<li><p><a href="http://haejung.egloos.com/v/1250745">[WebKit] Parse a HTML document</a></p></li>
<li><p><a href="http://d2.naver.com/helloworld/59361">브라우저는 어떻게 동작하는가?</a></p></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/architecture/2015/12/10/dom/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/book/2015/11/20/JS-high-performance-book/">Javascript 성능 최적화 책을 읽고.. - 데이터 접근 -</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=book">book</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-11-20">
                Nov 20, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <p>꽤 오래전에 구입했었던, <a href="http://www.hanbit.co.kr/book/look.html?isbn=978-89-7914-855-8">JavaScript 성능 최적화</a>라는 책을 다시 한번 읽어보며, 책 내용 중 개인적으로 중요하다고 느꼈던 부분과, 당시 <a href="http://krdic.naver.com/detail.nhn?docid=13706300">모호</a>했었던 부분들을, 이 포스트를 통해, 다시한번 정리해나갈 생각이다. 아마 이 책을 소지하고계신 분이라면, 책 내용을 이해하는데, 조금은 도움이될 듯 합니다.</p>

<h2 id=">글에 대해</h2>

<ul>
<li>자주 언급되는 특정 <span style="color:#c11f1f"><a href="http://mohwa.github.io/blog/search/?category=javascript">JS 용어</a></span>(<strong>VO</strong>, <strong>AO</strong>, <strong>Scope Chain</strong> 등)에 대해서는 따로 설명하지 않으며, <strong>링크</strong>된 <strong>블로그 글</strong>을 통해 찾아볼 수 있을것이다.</li>
</ul>

<h2 id=">데이터 접근</h2>

<ul>
<li><h3>원글: <em><strong>리터널 값</strong>이란? 단순히 자신을 나타낼 뿐이며, 특정 장소에 저장되지 않는 <strong>모든 값</strong>입니다. JS 에서는 문자열, 숫자, 불리언, 객체, 배열, <span style="color:#c11f1f">함수</span>, 정규 표현식, 특별한 값인 null 과 undefined 가 <strong>리터널</strong>입니다.</em></h3>

<ul>
<li><p>여기서 말하는 <span style="color:#c11f1f">함수</span>는 <strong>함수 선언식</strong>이 아닌, <span style="color:#c11f1f">함수 표현식</span>만을 <strong>의미</strong>한다.</p>

<ul>
<li><p><strong>함수 선언식</strong>은 단순히 <u>함수를 정의하는 <strong>문장</strong>으로 해석</u>되며, 실행 코드 처리 시 <span style="color:#c11f1f">값</span>으로 평가되지않는다.</p>

<ul>
<li><p>함수 선언식</p>

<p><img src="/blog/assets/images/posts/20151019/performance_1.png" alt=""></p></li>
</ul></li>
<li><p><span style="color:#c11f1f">함수 표현식</span>은 <span style="color:#c11f1f">값</span>으로 평가된다.</p>

<ul>
<li><p>함수 표현식</p>

<p><img src="/blog/assets/images/posts/20151019/performance_3.png" alt=""></p></li>
</ul></li>
<li><p><span style="color:#c11f1f">함수 선언식</span>은 <strong>함수 표현식</strong>과 달리, 반드시 <strong>함수 이름</strong>을 가져야한다.(즉 <strong>익명 함수</strong>가 허용되지 않는다)</p>

<ul>
<li><em>The main difference between a function expression and a function statement is the function name, which can be omitted in function expressions to create anonymous functions.</em></li>
<li><p>함수 선언식</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// 함수 선언식은 반드시 함수 이름을 가져야한다.</span>
<span class="kd">function</span> <span class="p">(){</span>

    <span class="c1">// function execution context</span>
<span class="p">}</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151019/performance_2.png" alt=""></p></li>
<li><p>함수 표현식                  </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// 익명 함수 표현식(AFE)</span>
<span class="kd">var</span> <span class="nx">fn1</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>
<span class="p">};</span>

<span class="c1">// 기명 함수 표현식(NFE)</span>
<span class="kd">var</span> <span class="nx">fn2</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="p">};</span>

<span class="c1">// 괄호 연산자를 통한 익명 함수 표현식</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(){</span>
    <span class="c1">// function execution context</span>
<span class="p">});</span>

<span class="c1">// 괄호 연산자를 통한 기명 함수 표현식</span>
<span class="p">(</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>
<span class="p">});</span>

<span class="c1">// 괄호 연산자를 통한 즉시 실행 함수(익명/기명)</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;immediately invoked function&#39;</span><span class="p">);</span> <span class="c1">// immediately invoked function</span>
<span class="p">})();</span>

<span class="p">(</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// function object</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;immediately invoked function&#39;</span><span class="p">);</span> <span class="c1">// immediately invoked function</span>
<span class="p">})();</span>

<span class="c1">// 그밖의 함수 표현식들</span>

<span class="c1">// 하지만 아래 표현식들은 의도된 함수 반환 값을 가질 수 없다는 단점이 존재한다.</span>
<span class="c1">// 즉 아래 함수 표현식들은 실제 코드상에서 사용하지 않는 편이 좋다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// 0 1</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// false</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">!</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// true</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">~</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// -2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">-</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// 100</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="o">+</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span> <span class="p">}());</span> <span class="c1">// -100</span>

<span class="c1">// 위에서 언급했던것처럼 함수 표현식은 값으로 평가된다. </span>
<span class="c1">// 즉 아래, 함수 표현식들은 값으로 평가되어 new 연산자를 통해, 새로운 객체를 생성하게된다.</span>
<span class="k">new</span> <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="p">};</span> <span class="c1">// === new A;</span>

<span class="k">new</span> <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="p">}();</span> <span class="c1">// === new A();                </span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/15/function-inJS/">Function in JS</a></p></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/14/vo-inJS/">Variable Object in JS</a></p></li>
<li><p><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Values,_variables,_and_literals#Literals">문법과 타입</a></p></li>
<li><p><a href="http://www.tutorialspoint.com/javascript/javascript_function_literals.htm">JavaScript Function Literals</a></p></li>
<li><p><a href="http://docstore.mik.ua/orelly/webprog/jscript/ch03_04.htm">3.4. Functions</a></p></li>
<li><p><a href="http://insanehong.kr/post/javascript-function/">Function Declarations(함수선언) vs Function Expressions(함수표현)</a></p></li>
<li><p><a href="https://javascriptweblog.wordpress.com/2010/07/06/function-declarations-vs-function-expressions/">Function Declarations vs. Function Expressions</a></p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/function">function expression</a></p></li>
<li><p><a href="http://stackoverflow.com/questions/1013385/what-is-the-difference-between-a-function-expression-vs-declaration-in-javascrip">What is the difference between a function expression vs declaration in JavaScript?</a></p></li>
<li><p><a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/">IIFE</a></p></li>
</ul></li>
<li><h3>원글: <em><strong>변수</strong>는 데이터를 저장할 목적으로, <u><span style="color:#c11f1f">var</span> 키워드를 써서 만든</u>, 개발자가 정의한 위치입니다.</em></h3>

<ul>
<li><strike><em>&quot;개발자가 정의한 위치&quot;</em> 라는 <strong>표현</strong>은 왜 썼는지 이해가 되지 않는다.</strike><p /></li>
<li>글 공개 후, 지인을 통해 <span style="color:#c11f1f">&quot;개발자가 정의한 위치&quot;</span> 라는 표현은 <strong>스코프</strong>를 말하는 것이 아닐까?&quot; 라는 말을 들었다.<p /></li>
<li>내 생각도 그것과 크게 다르지 않으나, 구지 <strong>Scope</strong> 라는 큰 범위의 의미를 <strong>변수</strong>를 설명하기 위한 이 <strong>한 문장</strong>에 꼭 넣어야 했을까? 라는 생각이 들기도 한다...<p /></li>
<li><p><strong>변수</strong>는 오직 <span style="color:#c11f1f">var</span> 키워드를 통해서만 선언된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// var 키워드를 통한(변수 선언식) x 변수는 execution context 진입 시 VO 의 속성으로 추가되며, undefined 로 초기화된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// undefined</span>

  <span class="k">try</span><span class="p">{</span>
      <span class="c1">// var 키워드가 생략된 y 속성은 execution context 진입 시 VO 의 속성으로 추가되지않는다.</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="nx">ex</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// y is not defined</span>
  <span class="p">}</span>

  <span class="c1">// var 키워드를 통한 x 변수</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// var 키워드가 생략된 y 속성</span>
  <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="c1">// var 키워드를 통한 x 변수는 non-configurable(DontDelete) 로 정의된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">));</span> <span class="c1">// Object {value: 1, writable: true, enumerable: true, configurable: false}</span>

  <span class="c1">// var 키워드가 생략된 y 속성은 configurable 로 정의된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">));</span> <span class="c1">// Object {value: 2, writable: true, enumerable: true, configurable: true}</span>

  <span class="c1">// 실행 코드 처리 후 1 이 할당된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1 === this.x</span>

  <span class="c1">// 실행 코드 처리 후 2 가 할당된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2 === this.y</span>

  <span class="c1">// non-configurable(DontDelete) 속성으로 정의된 x 변수는 delete 연산자를 통해 삭제되지 않는다.</span>
  <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>

  <span class="c1">// configurable 속성으로 정의된 y 속성은 delete 연산자를 통해 삭제된다.</span>
  <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>

  <span class="c1">// delete 연산자를 통해 삭제되지 않았다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1 === this.x</span>

  <span class="k">try</span><span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="nx">ex</span><span class="p">){</span>
      <span class="c1">// delete 연산자를 통해 삭제되었다.</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// y is not defined</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/14/variable-inJS/">Variable in JS</a></p></li>
</ul></li>
</ul>

<h2 id="scope-chain"><strong>Scope Chain</strong> 과 <strong>식별자 해석</strong></h2>

<ul>
<li><h3>원글: <em><u>JS 함수는 <strong>객체</strong>이고, 엄밀히 말해 <span style="color:#c11f1f">Function</span> 의 인스턴스 입니다.</u> 함수 객체는 다른 모든 객체와 마찬가지로 속성이 있는데, 이 속성은 프로그램에서 접근할 수 있는 속성과 JS 엔진에서 사용되며, 코드(개발자가 직접)에서 접근할 수 없는 <strong>내부 속성</strong>으로 나뉩니다. 이러한 <strong>내부 속성</strong> 중 하나가 ECMA-262 세 번째 판에서 정의한 [[Scope]] 속성 입니다.</em></h3>

<ul>
<li><p>JS 함수는 <span style="color:#c11f1f">Function</span> <strong>생성자 함수 객체</strong>로 만든 또 다른 <strong>함수 객체</strong> 이다.</p>

<ul>
<li><p>이전에 작성했었던, <a href="http://mohwa.github.io/blog/javascript/2015/10/16/prototype/">객체 지향 언어의 두 가지 줄기</a>라는 글에서, <strong>inifnite regress problem of classes</strong> 라는 말을 언급한적이있었다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="err">프로토타입</span> <span class="err">기반</span> <span class="nx">OO</span><span class="err">는</span> <span class="err">객체를</span> <span class="err">직접</span> <span class="err">이용하는데</span> <span class="err">비해</span><span class="p">,</span> <span class="err">클래스</span> <span class="err">기반의</span> <span class="nx">OO</span><span class="err">는</span> <span class="err">클래스라는</span> <span class="err">틀을</span> <span class="err">이용해서</span> <span class="err">객체를</span> <span class="err">생성하죠</span><span class="p">.</span>

  <span class="err">자연스럽게</span> <span class="err">나오는</span> <span class="err">질문은</span> <span class="s2">&quot;그럼 클래스는 대체 어디서 나온 것인가?&quot;</span><span class="err">라는</span> <span class="err">거죠</span><span class="p">.</span>

  <span class="err">대표적</span> <span class="err">클래스</span> <span class="err">기반</span> <span class="nx">OO</span><span class="err">인</span> <span class="nx">Java</span><span class="err">는</span> <span class="err">클래스도</span> <span class="err">객체로</span> <span class="err">봅니다</span><span class="p">.</span> <span class="err">그런데</span> <span class="err">클래스가</span> <span class="err">객체면</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스가</span> <span class="err">있어야</span> <span class="err">합니다</span><span class="p">.</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스도</span> <span class="err">객체이므로</span><span class="p">,</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스를</span> <span class="err">만드는</span> <span class="err">클래스도</span> <span class="err">있어야</span> <span class="err">합니다</span><span class="p">.</span> 

  <span class="err">이렇게</span> <span class="err">무한히</span> <span class="err">반복</span> <span class="err">되기</span> <span class="err">때문에</span> <span class="s2">&quot;inifnite regress problem of classes&quot;</span><span class="err">라고</span> <span class="err">불리는</span> <span class="err">것이죠</span><span class="p">.</span>

  <span class="nx">Java</span><span class="err">는</span> <span class="err">이</span> <span class="err">문제를</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">Class</span><span class="err">가</span> <span class="err">모든</span> <span class="err">클래스의</span> <span class="err">틀이라고</span> <span class="err">이야기하면서</span><span class="p">,</span> <span class="err">은근</span> <span class="err">슬쩍</span> <span class="err">넘어갔지만</span> <span class="err">여기에</span> <span class="err">숨은</span> <span class="err">논리적인</span> <span class="err">문제를</span> <span class="err">확실히</span> <span class="err">못풀고</span> <span class="s2">&quot;태초에 Class가 있었다&quot;</span><span class="err">라는</span> <span class="err">해법이</span> <span class="err">나와버리는거죠</span><span class="p">.</span>

  <span class="err">다른</span> <span class="err">접근</span> <span class="err">방법을</span> <span class="err">취한</span> <span class="err">언어가</span> <span class="err">있는지</span> <span class="err">모르겠지만</span><span class="p">,</span> <span class="err">대부분의</span> <span class="err">클래스</span> <span class="err">기반</span> <span class="err">언어는</span> <span class="err">클래스는</span> <span class="nx">second</span><span class="o">-</span><span class="nx">order</span> <span class="nx">citizen</span><span class="err">으로</span> <span class="err">특별히</span> <span class="err">취급해서</span> <span class="err">찍어낼</span> <span class="err">수</span> <span class="err">있는</span> <span class="err">틀은</span> <span class="err">원래</span> <span class="err">있었다라고</span> <span class="err">얘기하게</span> <span class="err">되는거죠</span><span class="p">.</span>

  <span class="err">그</span> <span class="err">대상이</span> <span class="err">클래스라는</span> <span class="err">거만</span> <span class="err">제외하면</span> <span class="err">접근</span> <span class="err">방법은</span> <span class="err">프로토타입</span> <span class="err">방식과</span> <span class="err">크게</span> <span class="err">다르지</span> <span class="err">않은</span> <span class="err">거고요</span><span class="p">.</span> 
</code></pre></div></li>
<li><p>이 말은 JS <strong>함수 객체</strong>에서도 동일하게 적용될 수 있다. 즉 <strong>함수</strong>를 생성하는 <span style="color:#c11f1f">Function</span> <strong>생성자 함수 객체</strong>를 생성하기 위해서는, 또 다른 <span style="color:#c11f1f">Function</span> <strong>생성자 함수 객체</strong>가 무한히 반복되기 때문이다.</p>

<p><img src="/blog/assets/images/posts/20151019/performance_4.png" alt=""></p></li>
</ul></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/14/vo-inJS/">Variable Object in JS</a>             </p></li>
</ul></li>
<li><h3>원글: <em>함수가 만들어질 때(함수 생성 시), 함수가 생성된 스코프에서 접근할 수 있는, 데이터를 나타내는 객체(<span style="color:#c11f1f">VO</span>)와 함께 <strong>Scope Chain</strong>이 만들어집니다.</em></h3>

<ul>
<li>원글과 달리, <strong>Scope Chain</strong> 은 <u><span style="color:#c11f1f">함수 생성 시점</span></u>이 아닌, <u><span style="color:#c11f1f">함수 호출 시점</span></u>에서 해당 Function Execution Context 내부에 <strong>생성</strong>된다.</li>
<li><p><span style="color:#c11f1f">함수 생성 시에는</span>, 해당 Function Execution Context 상위에 있는, <strong>모든 부모 계층</strong>의 <span style="color:#c11f1f">VO</span> 들을 [[Scope]] 속성으로 <strong>할당</strong>시킨다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
      <span class="c1">// function Execution Context</span>
      <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>          
</code></pre></div></li>
<li><p>생성된 <strong>함수 객체</strong> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">A</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
      <span class="c1">// [[Scope]] 속성에는 해당 function execution context 상위에 있는, 모든 부모 계층의 VO 가 할당된다.</span>
      <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
</code></pre></div></li>
</ul></li>
<li><h3>원글: <em>실행 문맥도 식별자 해석에 쓸 자기만의 <strong>Scope Chain</strong> 이 있습니다. 실행 문맥이 만들어질 때 이 문맥의 <strong>Scope Chain</strong>은 실행 중인 함수의 [[Scope]] 속성에 있는 <strong>객체로 초기화</strong>됩니다. 이 과정이 끝나면 활성화 객체(<span style="color:#c11f1f">AO</span>)라고 부르는 새로운 객체가 실행 문맥에 생성됩니다. 활성화 객체(<span style="color:#c11f1f">AO</span>)는 이 실행에 대해 변수 객체(<span style="color:#c11f1f">VO</span>) 구실을 하며, 모든 지역 변수, 명명된 매개변수, arguments 집합, this 항목을 포함합니다.</em></h3></li>
<li><h3><em>활성화 객체(<span style="color:#c11f1f">AO</span>)는 <strong>Scope Chain</strong> 의 앞에 자리 잡습니다. 실행 문맥이 파괴될 때, 활성화 객체(<span style="color:#c11f1f">AO</span>)도 같이 파괴됩니다.</em></h3>

<ul>
<li><p><span style="color:#c11f1f">함수 호출 시</span>, 함수 [[Scope]] 속성과, Function Execution Context 내부 <span style="color:#c11f1f">AO</span>(VO) 를 포함하는, <strong>Scope Chain</strong> 이 생성된다.</p>

<ul>
<li> [<span style="color:#c11f1f">AO</span>(VO), [[Scope]]] = <strong>Scope Chain</strong></li>
<li><p><span style="color:#c11f1f">AO</span> 는 <strong>Scope Chain</strong> 의 가장 <span style="color:#c11f1f">앞</span>(ScopeChain[0])에 추가되며, <strong>식별자 검색</strong> 시 가장 먼저 검색된다.<p></p>

<p><img src="http://figures.oreilly.com/tagoreillycom20090601oreillybooks300541I_book_d1e1/figs/I_mediaobject7_d1e6895-web.png" alt=""></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// VO.x</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
      <span class="c1">// function Execution Context</span>
      <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// AO(VO).y</span>
  <span class="p">}</span>  

  <span class="c1">// A 함수객체를 호출한다.     </span>
  <span class="nx">A</span><span class="p">();</span>                  
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">// A function execution context</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// 함수 호출 시, 생성된 AO(VO) 는 Scope Chain 의 가장 앞에(ScopeChain[0]) 추가되며, 식별자 검색 시, 가장 먼저 검색된다.</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
        <span class="p">},</span>              
        <span class="c1">// 함수 생성 시, [[Scope]] 속성에 추가되었던, globalExecutionContext 의 VO</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="k">this</span><span class="o">:</span> <span class="nx">global</span> <span class="nx">object</span>              
    <span class="p">},</span>
    <span class="c1">// global execution context</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>        
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// global execution context 내부 Scope Chain 에는 globalExecutionContext.VO 만 포함된다.</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">],</span>
      <span class="k">this</span><span class="o">:</span> <span class="nx">global</span> <span class="nx">object</span>                            
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><h3>원글: <em><span style="color:#c11f1f">식별자 검색</span>을 통해, 끝까지 찾지 못하면 <strong>변수</strong>가 선언되지 않은 것으로 간주합니다.</em></h3>

<ul>
<li><p><strong>런타임 오류</strong>가 발생된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">A</span><span class="p">();</span>
</code></pre></div>
<p><img src="/blog/assets/images/posts/20151019/performance_7.png" alt=""></p></li>
</ul></li>
<li><h3>원글: <em>함수 스코프 바깥에 있는 값을 한번 이상 사용할 거라면, 항상 지역 변수에 저장한다는 원칙을 가지는게 좋습니다. 만약 수십 개의 <strong>전역 변수</strong>에 반복해서 접근해야하는 큰 함수일경우, 성능이 비약적으로 좋아질것입니다.</em></h3>

<ul>
<li>이 말은, <span style="color:#c11f1f">식별자 검색</span>이 <strong>JS 엔진</strong>에 의해, <strong>최적화</strong>되지않은 <strong>상황</strong>을 고려해야한다는 말이다.(즉 <strong>APP</strong> 이 오래된 브라우저(IE 7 ~ 8 등)를 지원해야하는 경우를 말한다)<p></li>
<li><a href="http://mohwa.github.io/blog/tool/2015/11/12/scope-chain-search-test/">식별자 검색 테스트</a><br></li>
</ul></li>
<li><h3>원글: <em>실행 중에 with 문을 만나면 실행 문맥의 <strong>Scope Chain</strong> 이 임시로 확장되면서, 명시한 객체의 속성 전체를 포함하는 새로운 변수 객체(<span style="color:#c11f1f">VO</span>)가 만들어집니다.</em></h3></li>
<li><h3><em>만약 document 객체를 with 문에 전달하면 document 객체의 속성을 모두 포함하는 새로운 객체(<span style="color:#c11f1f">VO</span>)가 <strong>Scope Chain</strong>의 가장 앞에 삽입됩니다. 이렇게하면 document 객체 속성에는 매우 빠르게 접근할 수 있지만, 함수 <strong>지역 변수</strong>에 접근하는것은 느려집니다.</em></h3>

<ul>
<li><p>사실, 이 <strong>시나리오</strong>로 인해, <strong>식별자 검색</strong>이 느려지는 <strong>상황</strong>은 아마 거의 없을것이다.(<strong>production code</strong> 코드를 작정하고 느려지게 만들지 않는한은...)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

      <span class="c1">// function execution context</span>

      <span class="c1">// 지역 변수</span>
      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

      <span class="c1">// with 문에 document 객체를 전달한다.</span>
      <span class="kd">with</span> <span class="p">(</span><span class="nb">document</span><span class="p">){</span>

          <span class="c1">// 전달된 document 객체 속성을 수정한다.</span>
          <span class="nx">getElementById</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">);</span> <span class="c1">// null</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">// A function execution context</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// with 문으로 인해, 해당 Scope Chain 이 확장된다.</span>
        <span class="kd">with</span><span class="p">(</span><span class="nx">VO</span><span class="p">(</span><span class="nb">document</span> <span class="nx">object</span><span class="p">))</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">getElementById</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="p">...</span>
        <span class="p">},</span>
        <span class="c1">// 확장된 Scope Chain 으로 인해, AO(VO) 에 대한 접근이 느려진다.</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
        <span class="p">},</span>              
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="k">this</span><span class="o">:</span> <span class="nx">global</span> <span class="nx">object</span>              
    <span class="p">},</span>
    <span class="c1">// global execution context</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>        
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">],</span>
      <span class="k">this</span><span class="o">:</span> <span class="nx">global</span> <span class="nx">object</span>                            
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><h3>원글: <em><span style="color:#c11f1f">동적 스코프</span>는 with 문, catch 절, eval() 함수와 같이 <span style="color:#c11f1f">실행 코드 처리</span>시, <strong>동적</strong>으로 해당 <strong>Scope Chain</strong> 이 변경되는 <strong>환경</strong>을 의미합니다.</em></h3></li>
<li><h3><em><strong>최적화</strong>된 브라우저 엔진의 경우, 전통적인 <strong>Scope Chain</strong> 을 참조를 하지 않고, <strong>식별자 색인</strong>을 따로 만들어 식별자를 더 빠르게 해석합니다. 하지만 코드에 <span style="color:#c11f1f">동적 스코프</span>가 있다면, 이런 식으로 최적화할 수 없습니다. 따라서 <span style="color:#c11f1f">동적 스코프</span>는 꼭 필요할때만 쓰길 권장합니다.</em></h3>

<ul>
<li><p><span style="color:#6298c1">eval</span> 함수를 활용한 <strong>동적 스코프</strong></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

      <span class="c1">// function execution context</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

      <span class="c1">// function execution context</span>

      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

      <span class="c1">// eval execution context 는 calling context 의 Scope Chain 을 갖는다.</span>
      <span class="c1">// evalExecutionContext.Scope ==&gt; BFunctionExecutionContext.Scope</span>
      <span class="c1">// 여기서 callingContext 는 BFunctionExecutionContext 를 가리킨다.</span>
      <span class="nb">eval</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">A</span><span class="p">));</span>

      <span class="nx">A</span><span class="p">();</span> <span class="c1">// 2</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>

  <span class="nx">B</span><span class="p">();</span>
</code></pre></div></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/11/scope-chain-inJS/">Scope Chain 그리고 Closure</a>          </p></li>
</ul></li>
<li><h3>원글: <em>클로저란? 함수가 자신의 스코프 밖에 있는 데이터에 접근할 수 있게 하는 <strong>환경</strong>을 말한다.</em></h3>

<ul>
<li>클로저란? <strong>Scope Chain</strong> 매커니즘을 통해, 해당 Function Execution Context 상위에 있는 <strong>모든 부모 계층</strong>의 <span style="color:#c11f1f">VO</span> 에 접근하는 <strong>환경</strong>을 말한다.</li>
<li><p>클로저 <strong>환경</strong>으로 인한, <strong>메모리 누수</strong></p>

<ul>
<li><p>즉, makeAdder 함수 종료 시, 소멸되는 <span style="color:#c11f1f">AO</span>(VO) 가, <strong>반환</strong>되는 <strong>함수</strong> [[Scope]] 속성에, 영구적으로 보관되는 <strong>환경</strong>을 말한다.(<strong>메모리 누수의 원인</strong>)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">makeAdder</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// &lt;makeAdder&gt; function execution context</span>

    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// &lt;anonymous&gt; function execution context</span>

      <span class="c1">// 반환되는 익명 함수의 [[Scope]] 속성에는, &lt;anonymous&gt; function execution context 상위에 있는 모든 부모 계층의 VO 가 포함되어있다.</span>
      <span class="c1">// 다시 말해, 해당 함수의 [[Scope]] 속성에는, &lt;makeAdder&gt; function execution context 내부 AO(VO) 가 포함된다는 것이다.</span>

      <span class="c1">// 해당 Scope Chain 의 식별자 검색을 통해, 부모 계층의 AO.x 속성을 접근할 수 있다.</span>

      <span class="c1">// anonymousFunctionExecutionContext.scopeChain.makeAdderFunctionExecutionContext.AO.x</span>
      <span class="c1">// anonymousFunctionExecutionContext.scopeChain.AO.y</span>
      <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// 결국 반환되는 함수 [[Scope]] 속성에서는 makeAdderFunctionExecutionContext.AO 가 영구적으로 남게된다.(메모리 누수의 원인) </span>
  <span class="kd">var</span> <span class="nx">add5</span> <span class="o">=</span> <span class="nx">makeAdder</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

  <span class="c1">// 반환받은 익명 함수를 실행한다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add5</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>  <span class="c1">// 7</span>
</code></pre></div></li>
<li><p>anonymousFunction(<span style="color:#c11f1f">add5</span>) 함수의 [[Scope]] 속성 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">anonymousFunction</span><span class="p">(</span><span class="nx">add5</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
  <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">makeAdder</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span>                
      <span class="p">},</span>
      <span class="nx">x</span><span class="o">:</span> <span class="mi">5</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">makeAdder</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
      <span class="nx">add5</span><span class="o">:</span> <span class="kc">undefined</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></li>
<li><p>anonymousFunction(<span style="color:#c11f1f">add5</span>) 함수 실행 시, 생성되는 <strong>Scope Chain</strong> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">anonymousFunctionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">AO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">2</span>                
      <span class="p">},</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>                
    <span class="p">},</span>             
  <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">AO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">2</span>                
      <span class="p">},</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>                
    <span class="p">},</span>
    <span class="o">&lt;</span><span class="nx">makeAdder</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span>                
      <span class="p">},</span>
      <span class="nx">x</span><span class="o">:</span> <span class="mi">5</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">makeAdder</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
      <span class="nx">add5</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul>

<h2 id=">프로토타입 체인</h2>

<ul>
<li><h3>원글: <em><strong>프로토타입</strong>이란? 다른 객체의 <strong>기반</strong>이 되는 객체이고, 새 객체가 가져야 할 <strong>맴버</strong>를 정의하고 구현합니다.</em></h3>

<ul>
<li><p>생성된 A 함수 <strong>객체</strong>는, Function 생성자 함수 객체의 <strong>원형</strong>을 위임 받는다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
<span class="p">}</span>

<span class="c1">// A 함수 객체의 __proto__ 속성은, 자신을 만든 Function 생성자 함수 객체의 원형(Function.prototype)과 동일하다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><p>A 생성자 함수 객체를 통해 생성될, 새로운 <strong>객체</strong>가 가져야 할 <strong>맴버</strong>를 정의하고 구현한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">name</span><span class="p">){</span>

    <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="c1">// name 속성</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 새로운 객체(objA)가 가져야할 맴버를 구성하고 구현한다.</span>
<span class="c1">// 즉 A 생성자 함수 객체로 만들어질, 새로운 객체의 특성을 A.prototype 객체를 통해, 구현한다.</span>
<span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">// name 속성을 반환환다.</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// new 연산자를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">objA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">(</span><span class="s1">&#39;mohwa&#39;</span><span class="p">);</span>

<span class="c1">// 위임받은 특성을 통해, name 속성을 반환한다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">objA</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span> <span class="c1">// mohwa</span>
</code></pre></div></li>
</ul></li>
<li><h3>원글: <em><strong>객체</strong>는 내부 속성(__proto__)을 통해, 자신의 <strong>프로토타입</strong>에 묶입니다. FF, Safari, Chrome 은 이 속성을 <span style="color:#c11f1f">__proto__</span> 라는 이름으로 노출하므로, 개발자가 사용할 수 있지만, 다른 브라우저는 스크립트로 이 속성에 접근할 수 없습니다.</em></h3>

<p><img src="http://dmitrysoshnikov.com/wp-content/uploads/basic-object.png" alt=""></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
<span class="p">}</span>

<span class="c1">// new 연산자를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">objA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="c1">// A.prototype: 나를 통해 생성될, 객체(objA)가 위임받을 원형</span>
<span class="c1">// objA.__proto__: 나를 만든 생성자 함수 객체의 원형(A.prototype)</span>

<span class="c1">// objA.__proto__ === A.prototype</span>

<span class="c1">// 결국 objA.__proto__ 속성은 A.prototype 을 가리키게 된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">objA</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><h3>원글: <em>예를들어 <strong>Date</strong> 나 <strong>Array</strong> 같은 객체 인스턴스를 새로 만들면 인스턴스의 <strong>프로토타입</strong>은 자동으로 <strong>Object</strong> 가 됩니다.</em></h3>

<ul>
<li><p>원글의 의미가 이해가 가지 않는다.;;</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Date 생성자 함수 객체로 생성된 새로운 객체의 __proto__ 속성은, 생성자 함수 객체의 원형인 Date.prototype 을 위임받는다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>

<span class="c1">// Array 생성자 함수 객체로 생성된 새로운 객체의 __proto__ 속성은, 생성자 함수 객체의 원형인 Array.prototype 을 위임받는다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">new</span> <span class="nb">Array</span><span class="p">().</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
</ul></li>
<li><h3>원글: <em>객체 맴버 해석은 변수 해석과 매우 비슷합니다. book.toString() 을 호출하면, 먼저 객체 인스턴스에서 toString 맴버를 찾습니다. 하지만 book 객체에는 toString 맴버가 없으므로 <strong>프로토타입</strong> 객체를 검색해서 toString() 메서드를 찾아 실행합니다.</em></h3>

<ul>
<li><p>위임 받은 <strong>자식 객체</strong>(obj)는 원하는 특징(속성 or 메서드)에 도달하기위해, <strong>객체</strong>가 가진 원형을 연속적으로 따라가 검색하게된다.(<strong>프로토타입 체인 검색</strong>) </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 모든 객체는 Object 생성자 함수 객체를 통해 만든 새로운 객체이다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>

<span class="c1">// 1. 먼저 obj 객체를 통해, toString 메서드를 검색한다.</span>
<span class="c1">// 2. 하지만 obj 객체에는 toString 메서드가 존재하지 않으므로, 위임 받은 부모 객체(obj.__proto__ ==&gt; Object.prototype)의 원형을 검색한다.</span>
<span class="c1">// 3. 부모 객체의 원형(Object.prototype)에는 toString 메서드가 존재하므로, 해당 메서드를 반환하게된다.</span>

<span class="c1">// obj 객체에는 toString 맴버가 존재하지않으므로, 위임받은 원형 객체(Object.prototype)을 통해, toString 메서드를 찾아 실행하게된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">);</span> <span class="c1">// toString function object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">);</span> <span class="c1">// toString function object </span>
</code></pre></div></li>
</ul></li>
<li><h3>원글: <em>찾는 맴버가 프로토타입 체인 깊숙이 있을수록 접근 시간이 늘어납니다.</em></h3>

<ul>
<li><strong>프로토타입 체인 검색 테스트</strong><p></li>
<li>테스트(모던 브라우저를 통한) 후 알게된 사실이지만, <strong>Chrome</strong>(<span style="color:#c11f1f">46.0.2490.86</span> (64-bit)) or <strong>FF</strong>(<span style="color:#c11f1f">42.0</span>) 는 <strong>프로토타입 체인 검색</strong>을 통한, <strong>쓰기</strong> 과정이 <strong>읽기</strong> 보다 더욱 빨랐다...(하지만 <strong>Safari</strong>(<span style="color:#c11f1f">9.0.1</span>(10601.2.7.2)) 의 경우, 예상했던대로 <strong>읽기 과정</strong>이 더 빨랐다.;;)<p></li>
<li>위의 <a href="http://mohwa.github.io/blog/tool/2015/11/12/scope-chain-search-test/">식별자 검색 테스트</a>와 같이 모던 브라우저상에서는, <strong>성능</strong>상 <strong>큰 이슈</strong>가 되지 않을듯 하다.</li>
<li><p>하지만 <strong>오래된 브라우저</strong>상에서도 이에 대한 <strong>성능 이슈</strong>를 피하고 싶다면, <strong>반복 검색</strong>해야하는 <strong>객체 맴버</strong>를 <strong>변수</strong>를 통해, <strong>접근</strong>하는것이 좋다.</p>

<p><iframe height='368' scrolling='no' src='http://codepen.io/yanione/embed/QjPbRM/?height=368&theme-id=0&default-tab=result' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='http://codepen.io/yanione/pen/QjPbRM/'>QjPbRM</a> by mohwa (<a href='http://codepen.io/yanione'>@yanione</a>) on <a href='http://codepen.io'>CodePen</a>.
</iframe></p></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/16/prototype/">객체 지향 언어의 두 가지 줄기</a></p></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/09/enumerable-inJS/">JS Enumerable(열거자) or Nonenumerable(비 열거자)</a></p></li>
</ul></li>
</ul>

<h2 id=">글을 마치며</h2>

<ul>
<li><strong>말머리</strong>에서 <strong>언급</strong>한바와같이, 이 글은 책의 내용을 <strong>비판</strong>하고자하는 목적이 아닌, 책 내용중 개인적으로 중요하다고 판단한 부분과, 의미상 <strong>모호</strong>했던 부분을 다시한번 정리해본것이다.</li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/book/2015/11/20/JS-high-performance-book/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/tool/2015/11/12/scope-chain-search-test/">식별자 검색 테스트</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=tool">tool</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-11-12">
                Nov 12, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <p>현재 정리중인 &quot;<a href="http://www.hanbit.co.kr/book/look.html?isbn=978-89-7914-855-8">JavaScript 성능 최적화</a> 책을 읽고..&quot; 라는 포스트 내용 중 <strong>Scope Chain</strong> 을 통한, <strong>식별자 검색</strong>에 대한 이야기가 나온다.</p>

<p>또, 이 내용을 <strong>검증</strong>하기위한 <strong>테스트 코드</strong>를 아래와 같이 작성해보았다.</p>

<h2 id=">식별자 검색 테스트</h2>

<ul>
<li>(<span style="color:#c11f1f">n</span>) 개의 <strong>전역 변수</strong> 및 <strong>중첩 함수</strong>를 생성하여, <strong>식별자 검색</strong>에 대한 <span style="color:#c11f1f">성능 테스트</span>를 진행할 수 있다.</li>
</ul>

<p><iframe height='350' scrolling='no' src='http://codepen.io/yanione/embed/epbYzm/?height=268&theme-id=0&default-tab=result' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='http://codepen.io/yanione/pen/epbYzm/'>epbYzm</a> by mohwa (<a href='http://codepen.io/yanione'>@yanione</a>) on <a href='http://codepen.io'>CodePen</a>.
  </iframe></p>

<h2 id=">개선된 식별자 검색</h2>

<ul>
<li><p>마지막 <strong>중첩 함수</strong>의 <strong>지역 변수</strong>를 통해, <strong>식별자 검색</strong>을 개선시켰다.</p>

<ul>
<li><p>생성된 모든 <strong>전역 변수</strong>를 해당 <strong>지역 변수</strong>에 할당하여, <strong>식별자 검색</strong>에 걸리는 시간을 <strong>최소화</strong>한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// 마지막 중첩 함수일 경우</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="p">(</span><span class="nx">fnDepthCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>

      <span class="c1">// 식별자 검색 시작 시간</span>
      <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;var start = new Date().getTime();&#39;</span><span class="p">);</span>

      <span class="cm">/******************************************************************/</span>
      <span class="cm">/******************************************************************/</span>
      <span class="c1">// 생성된 모든 전역 변수를 해당 function execution context 내부 AO 에 할당한다.</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">jj</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">jj</span> <span class="o">&lt;</span> <span class="nx">globalVariableCount</span><span class="p">;</span> <span class="nx">jj</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// 지역 변수에 값을 할당한다.</span>
          <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;var y_&#39;</span> <span class="o">+</span> <span class="nx">jj</span> <span class="o">+</span> <span class="s1">&#39; = x_&#39;</span> <span class="o">+</span> <span class="nx">jj</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="cm">/******************************************************************/</span>
      <span class="cm">/******************************************************************/</span>

      <span class="c1">// 마지막 중첩 함수 내부에서, 생성된 n 개의 지역 변수를 n 번 순회하며, 식별자 검색을 통해 값을 가져온다.</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">ii</span> <span class="o">&lt;</span> <span class="nx">globalVariableLoopCount</span><span class="p">;</span> <span class="nx">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

          <span class="cm">/******************************************************************/</span>
          <span class="cm">/******************************************************************/</span>
          <span class="c1">// 생성된 모든 지역 변수를 순회한다.</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">jjj</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">jjj</span> <span class="o">&lt;</span> <span class="nx">globalVariableCount</span><span class="p">;</span> <span class="nx">jjj</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
              <span class="c1">// 식별자 검색을 통해, 값을 가져온다.</span>
              <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="nx">jjj</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="cm">/******************************************************************/</span>
          <span class="cm">/******************************************************************/</span>
      <span class="p">}</span>

      <span class="c1">// 식별자 검색 종료 시간</span>
      <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;var end = new Date().getTime();&#39;</span><span class="p">);</span>
      <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;document.getElementById(\&#39;searchTime\&#39;).value = (end - start) + \&#39; ms\&#39;;&#39;</span><span class="p">);</span>

      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">fns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;} A_&#39;</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">+</span> <span class="s1">&#39;();&#39;</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></li>
</ul></li>
</ul>

<h2 id=">테스트 결과</h2>

<ul>
<li><p>이 결과는 <strong>테스트 환경</strong>에 따라, <span style="color:#c11f1f">오차 범위</span>를 보일 수 있다.</p></li>
<li><p>읽기에 비해, 쓰는 시간이 더 오래 걸린다.(당연하지만)  </p>

<ul>
<li>IE: <span style="color:#c11f1f">차후 테스트 진행...</span><p></li>
<li>Chrome: 

<ul>
<li>읽기: <span style="color:#c11f1f">7 ~ 12</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /></li>
<li>쓰기: <span style="color:#c11f1f">9 ~ 14</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /></li>
</ul></li>
<li>Safari:

<ul>
<li>읽기: <span style="color:#c11f1f">5 ~ 7</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /></li>
<li>쓰기: <span style="color:#c11f1f">9 ~ 12</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /><br></li>
</ul></li>
<li>FF: 

<ul>
<li>읽기: <span style="color:#c11f1f">0 ~ 2</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /></li>
<li>쓰기: <span style="color:#c11f1f">5 ~ 6</span>ms(개선 전) / <span style="color:#c11f1f">0 ~ 1</span>ms(개선 후)<p /><br></li>
</ul></li>
</ul></li>
</ul>

<h2 id=">마치며</h2>

<ul>
<li><p>이 코드는 <strong>ms 단위</strong>의 <strong>정확한 테스트</strong>를 위해 사용하기에는 무리가 따르며, 환경(브라우저)별, <strong>엔진 최적화</strong> 범위를 알 수 있는 정도로 사용하는것이 좋다.</p></li>
<li><p>결과를 통해, 알 수 있듯이, <strong>최적화</strong>된 <strong>엔진</strong>을 보유한 대부분의 모던 브라우저에서는 <strong>식별자 검색</strong>에 대한 <span style="color:#c11f1f">성능 차이</span>가 크게 존재하지 않았다.</p></li>
<li><p>즉 <strong>App</strong> 이 오래된 브라우저를 지원하지 않아도 되는 경우에는, <strong>식별자 검색</strong>에 대한 성능 만큼은, 큰 <strong>이슈</strong>가 되지 않을 듯 하다.</p></li>
</ul>

<h2 id="url">참고 URL</h2>

<ul>
<li><a href="http://mohwa.github.io/blog/javascript/2015/10/11/scope-chain-inJS/">Scope Chain 그리고 Closure</a></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/tool/2015/11/12/scope-chain-search-test/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/javascript/2015/10/30/variable-consider-inJS/">GC 를 통한 객체 소멸 시점</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=javascript">javascript</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-30">
                Oct 30, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <p>이 글에서는, 생성된 <strong>객체</strong>가 <strong>GC</strong> 에 의해, <strong>소멸되는 시점</strong>에 대해 테스트해볼 것이다.<br/><br/></p>

<ul>
<li><p>Global Execution Context 내부</p>

<ul>
<li><p>테스트 1</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// object Object</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>해당 <strong>객체</strong>가 <strong>Heap Memory 영역</strong>에 존재하는것을 볼 수 있다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_2.png" alt=""></p></li>
</ul></li>
<li><p>테스트 2            </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// null</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><code style="background:#d1cccc">obj = null</code> 코드를 통해, 해당 <strong>객체</strong>를 <strong>GC</strong> 대상으로 만들었다.</li>
<li><p>해당 <strong>객체</strong>가 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된 것을 볼 수 있다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_3.png" alt=""></p></li>
</ul></li>
<li><p>테스트 3            </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="c1">// x 변수에 obj 값(객체 참조 포인터)을 할당한다.</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>

<span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="c1">// 해당 객체(new A())를 참조하는 대상(x 변수)이 아직 남아있기때문에, GC 에 의해 Heap Memory 영역에서 소멸되지않는다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="c1">// obj Object</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>해당 <strong>객체</strong>를 참조하는 <strong>대상</strong>이 아직 남아있기때문에, <strong>GC</strong> 에 의해 <strong>Heap Memory</strong> 영역에서 소멸되지않는다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_4.png" alt=""></p></li>
</ul></li>
<li><p>테스트 4           </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="c1">// x 변수에 obj 값(객체 참조 포인터)을 할당한다.</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>

<span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="c1">// x 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
<span class="nx">x</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="c1">// x 변수에 새롭게 할당된 null 값이 반환된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="c1">// null</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>해당 <strong>객체</strong>를 참조하는 대상이 모두 사라졌기때문에, <strong>객체</strong>가 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된 것을 볼 수 있다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_5.png" alt=""></p></li>
</ul></li>
<li><p>반드시 <strong>null</strong> 값만 할당해야 하는가?          </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="c1">// obj 변수에 다른 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// 1</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p><strong>null</strong> 값이 아닌, 다른 값을 할당해도, <strong>객체</strong>는 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_5.png" alt="">                        </p></li>
</ul></li>
</ul></li>
<li><p>Function Execution Context 내부</p>

<ul>
<li><p>x 변수에는 obj 변수에 할당된 <strong>객체 참조 포인터</strong>(값)가 할당된다. </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// obj 변수에 객체를 할당한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">};</span>

<span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// x 변수를 obj 변수 값으로 초기화한다.</span>
    <span class="c1">// obj 변수 값: 객체 참조 포인터</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>

    <span class="c1">// x 변수를 통해, 객체를 확장한다.</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// {x: 1, y: 2}</span>
<span class="p">}</span>

<span class="nx">B</span><span class="p">();</span>
</code></pre></div></li>
<li><p>테스트 1          </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){};</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">B</span><span class="p">();</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>예상했던대로, <strong>객체</strong>는 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_7.png" alt=""></p></li>
</ul></li>
<li><p>테스트 2        </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){};</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// null</span>

    <span class="c1">// 해당 객체(new A())를 참조하는 대상(x 변수)이 아직 남아있기때문에, GC 에 의해 Heap Memory 영역에서 소멸되지않았다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// object Object</span>
<span class="p">}</span>

<span class="nx">B</span><span class="p">();</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>함수 종료 후(== <span style="color:#c11f1f">AO</span> 가 소멸되는 시점)에는 해당 <strong>객체</strong>를 참조하는 대상이 모두 사라졌기때문에, <strong>객체</strong>가 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된 것을 볼 수 있다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_8.png" alt=""></p></li>
</ul></li>
<li><p>테스트 3        </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){};</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// x 는 globalExecutionContext 내부 VO 의 새로운 속성으로 추가된다.</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span> <span class="c1">// === this.x = obj;</span>
    <span class="c1">// obj 변수에 null 값을 할당하여, 생성된 객체를 GC 대상으로 만든다.</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span> <span class="c1">// null</span>

    <span class="c1">// 해당 객체(new A())를 참조하는 대상(x 변수)이 아직 남아있기때문에, GC 에 의해 Heap Memory 영역에서 소멸되지않았다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// object Object</span>
<span class="p">}</span>

<span class="nx">B</span><span class="p">();</span>
</code></pre></div></li>
<li><p>HEAP MEMORY CHECK</p>

<ul>
<li><p>이 같은 경우, 함수 종료 후(== <span style="color:#c11f1f">AO</span> 가 소멸되는 시점)에도 해당 <strong>객체</strong>를 참조하는 대상(globalExecutionContext.VO.x)이 아직 남아있기때문에, <strong>객체</strong>가 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>되지 않는다.</p>

<p><img src="/blog/assets/images/posts/20151030/variable_9.png" alt="">            </p></li>
</ul></li>
</ul></li>
</ul>

<h2 id=">테스트 결과</h2>

<ul>
<li><p><code style="background:#d1cccc">var x = obj</code> 코드를 통해, x 변수에는 obj 변수에 할당된 <strong>객체 포인터(값)</strong>가 할당된다.<p></p></li>
<li><p>생성된 <strong>객체</strong>는 그 <strong>객체</strong>를 참조하는 대상이 없을경우에만 <strong>GC</strong> 에 의해, <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된다.<p></p>

<ul>
<li>즉 <strong>null</strong>(or 다른 값) 값만 <strong>할당</strong>한다고 무조건 <strong>소멸</strong>되는 것은 아니다.</li>
</ul></li>
<li><p><strong>null</strong> 값이 아닌, 다른 값을 할당해도, <strong>객체</strong>는 <strong>Heap Memory 영역</strong>에서 <strong>소멸</strong>된다.</p></li>
<li><p>JS 는 개발자가 직접 <strong>Heap Memory 영역</strong>에 할당된 <strong>객체</strong>를 <strong>소멸</strong>시킬 수 있는 방법을 제공하지 않는다. </p>

<ul>
<li>즉 <code style="background:#d1cccc">null</code> 값을 <strong>할당</strong>하거나, <code style="background:#d1cccc">delete</code> 연산자를 통해 <span style="color:#c11f1f">VO</span> 의 속성을 <strong>삭제</strong>하는것은, 모두 <strong>간접</strong>적으로 <strong>GC</strong>를 통해, <strong>객체</strong>를 <strong>소멸</strong>시키는 <strong>방법</strong>들이다.<p></li>
</ul></li>
<li><p><span style="color:#c11f1f">AO</span> 의 속성으로 할당된 <strong>객체 참조</strong>는 <strong>함수 종료 시</strong> 모두 <strong>GC</strong> 에 의해 <strong>소멸</strong>된다.<p></p></li>
</ul>

<h2 id="url">참조 URL</h2>

<ul>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/14/variable-inJS/">Variable in JS</a></p></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/14/vo-inJS/">Variable Object in JS</a></p></li>
<li><p><a href="http://mohwa.github.io/blog/javascript/2015/10/11/scope-chain-inJS/">Scope Chain 그리고 Closure</a></p></li>
<li><p><a href="http://mohwa.github.io/blog/designpattern/2015/08/07/struct-inJS/">Struct in JS</a></p></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/javascript/2015/10/30/variable-consider-inJS/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/generator/2015/10/16/yo-generator/">Yeoman-Generator</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=generator">generator</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-16">
                Oct 16, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <h2 id="1">1. 문서 내용에 대해</h2>

<ul>
<li><p>이 문서에서는 <strong>Yeoman</strong> 을 통해 자신만의 <strong>app generator</strong> 모듈을 생성하는 방법에 대해 알아볼 것이다.</p></li>
<li><p><strong>Yeoman</strong> 은 <a href="http://yeoman.io/">공식 홈페이지</a>를 통해, 이를 시작하기 위한 내용을 제공하고있다.</p>

<ul>
<li><a href="http://yeoman.io/authoring/">WRITING YOUR OWN YEOMAN GENERATOR</a></li>
</ul></li>
<li><p>이 문서의 내용은 <strong>MAC 환경</strong>을 기준으로 작성되어있다.</p></li>
</ul>

<h2 id="2-app-generator">2 app generator 개발 환경 구축</h2>

<ul>
<li><p><a href="https://github.com/yeoman/generator-generator">generator-generator</a> 모듈은 사용자가 자신만의 <strong>app generator</strong> 모듈을 개발할때, 그 기반 설계를 도와주는 <strong>Yeoman generator</strong> 모듈 중 하나이다.</p>

<ul>
<li>반드시 이 구조를 따라갈 필요는 없겠지만, <strong>generator-generator</strong> 모듈은 어차피 <u>기본 골격만 제공하므로,</u> 해당되는 부분에 대해서는 동일하게 따라가도 좋을 듯 하다.</li>
</ul></li>
<li><p><strong>generator-generator</strong> 모듈을 설치한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">sudo</span> <span class="nx">npm</span> <span class="nx">install</span> <span class="o">-</span><span class="nx">g</span> <span class="nx">generator</span><span class="o">-</span><span class="nx">generator</span>
</code></pre></div></li>
<li><p>설치된 <strong>generator-generator</strong> 모듈을 통해 생성할 <strong>app generator</strong> 모듈의 <u><strong>기반</strong>을 생성한다</u>.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">yo</span> <span class="nx">generator</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_1.jpg" alt=""></p></li>
<li><p>생성할 <strong>app generator</strong> 모듈의 <strong>[base-name]</strong> 을 위와 같이 <strong>입력</strong> 후 설치를 완료하면, 입력한 <strong>[base-name]</strong> 을 기준으로 현재 위치에 <strong>app generator</strong> 모듈 폴더(<span style="color:#c11f1f">./generator-cmtech</span>)가 생성된다.</p>

<ul>
<li>[base-name]: <span style="color:#c11f1f">cmtech</span></li>
</ul>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_2.jpg" alt=""></p></li>
<li><p>생성된 <strong>app generator</strong> 모듈 폴더(<span style="color:#c11f1f">./generator-cmtech</span>) <strong>이름</strong>은 아래와 같은 형식으로 <strong>생성</strong>되며, <strong>Yeoman</strong> 은 이후 <code>yo [base-name]</code> 명령 실행 시 이 <strong>[base-name]</strong> 이 기준이된 <strong>app generator</strong> 모듈 폴더를 File system 상에서 찾아 실행하게될것이다.</p>

<ul>
<li>생성된 <strong>app generator</strong> 모듈 폴더 이름: generator-<span style="color:#c11f1f">[base-name]</span></li>
<li><strong>app generator</strong> 모듈 설치 명령: yo <span style="color:#c11f1f">[base-name]</span></li>
</ul></li>
<li><p>개발중인 <strong>app generator</strong> 모듈을 <strong>링크</strong>를 통해 설치한다.</p>

<ul>
<li>정확히 말하면 <strong>사용자 시스템</strong>의 <strong>global node module</strong> 위치에, 개발중인 <strong>app generator</strong> 모듈(<span style="color:#c11f1f">./generator-cmtech</span>) 폴더의 <strong>링크</strong>를 만들어, <u><strong>npm</strong> 모듈을 설치하는것과같은, 환경을 만들어주는것이다.</u></li>
<li><p>먼저 <strong>global node module</strong>(<span style="color:#c11f1f">/usr/local/lib/node_modules</span>) 위치로 이동하여, 생성된 <strong>app generator</strong> 모듈 폴더를 <strong>링크</strong> 한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global node module 위치로 이동한다.</span>
  <span class="nx">cd</span> <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">local</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">node_modules</span>

  <span class="c1">// app generator 모듈 폴더를 심볼릭 링크한다.</span>
  <span class="nx">sudo</span> <span class="nx">ln</span> <span class="o">-</span><span class="nx">s</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">sgjeon</span><span class="o">/</span><span class="nx">htdocs</span><span class="o">/</span><span class="nx">gitrepos</span><span class="o">/</span><span class="nx">generator</span><span class="o">-</span><span class="nx">cmtech</span> <span class="nx">generator</span><span class="o">-</span><span class="nx">cmtech</span>
</code></pre></div>
<p>그 다음 <strong>npm list</strong> 명령을 통해 <strong>app generator</strong> 모듈이 제대로 <strong>설치</strong>(<span style="color:#c11f1f">링크</span>)되었는지 확인해본다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_4.jpg" alt=""></p>

<p>확인되었다면, <code>yo [base-name]</code> 명령을 통해, <strong>app generator</strong> 모듈이 제대로 설치되는지 확인한다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_5.jpg" alt=""></p></li>
</ul></li>
</ul>

<h2 id="3-app-generator">3. app generator 개발 포인트</h2>

<ul>
<li><p><strong>package.json</strong> 파일 설정</p>

<ul>
<li><p>아래는 <strong>app generator 모듈</strong> 폴더안의 <strong>package.json</strong> 파일 내용이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;generator-cmtech&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;0.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;cmtech generator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;license&quot;</span><span class="o">:</span> <span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;main&quot;</span><span class="o">:</span> <span class="s2">&quot;app/index.js&quot;</span><span class="p">,</span>
    <span class="s2">&quot;repository&quot;</span><span class="o">:</span> <span class="s2">&quot;mohwa/generator-cmtech&quot;</span><span class="p">,</span>
    <span class="s2">&quot;author&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;mucha&quot;</span><span class="p">,</span>
    <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;https://github.com/mohwa&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="s2">&quot;mocha&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;files&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;generators&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;keywords&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;yeoman-generator&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;dependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;yeoman-generator&quot;</span><span class="o">:</span> <span class="s2">&quot;^0.19.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chalk&quot;</span><span class="o">:</span> <span class="s2">&quot;^1.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;yosay&quot;</span><span class="o">:</span> <span class="s2">&quot;^1.0.2&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;devDependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;mocha&quot;</span><span class="o">:</span> <span class="s2">&quot;*&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><strong>name</strong> property 는 반드시 <span style="color:#c11f1f">generator-</span> 라는 <strong>접두사</strong>를 가져야한다.</p>

<ul>
<li>예: <span style="color:#c11f1f">generator-</span>cmtech</li>
</ul></li>
<li><p><strong>Yeoman</strong> 에서 제공하는 <a href="http://yeoman.io/generators/">generator-page</a> 에 listed 되기 위해서는 <strong>keywords</strong> property 와 <strong>description</strong> property 를 반드시 서술해야한다.</p>

<ul>
<li><strong>keywords</strong> property 에는 예제와 같이 &quot;<strong>yeoman-generator</strong>&quot; 를 할당해준다.</li>
</ul></li>
</ul></li>
<li><p><strong>Folder tree</strong></p>

<ul>
<li><strong>Yeoman</strong> 은 아래와 같은 두 가지 <strong>폴더 구조</strong>를 제공하고있다.</li>
<li><p><span style="color:#c11f1f">./</span> 폴더 내부로 가용한 <strong>default generator</strong> 및 <strong>sub-generator</strong> 를 만들어내는 구조</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="err">├───</span><span class="kr">package</span><span class="p">.</span><span class="nx">json</span>
<span class="err">├───</span><span class="nx">app</span><span class="o">/</span>
<span class="err">│</span>   <span class="err">└───</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span>
<span class="err">└───</span><span class="nx">router</span><span class="o">/</span>
  <span class="err">└───</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">./generators</span> 폴더 내부로 가용한 <strong>default generator</strong> 및 <strong>sub-generator</strong> 를 만들어내는 구조(개인적으로 이 <strong>폴더 구조</strong>를 선호한다)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="err">├───</span><span class="kr">package</span><span class="p">.</span><span class="nx">json</span>
<span class="err">└───</span><span class="nx">generators</span><span class="o">/</span>
  <span class="err">├───</span><span class="nx">app</span><span class="o">/</span>
  <span class="err">│</span>   <span class="err">└───</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span>
  <span class="err">└───</span><span class="nx">router</span><span class="o">/</span>
    <span class="err">└───</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span>
</code></pre></div></li>
<li><p><strong>default generator</strong> 및 <strong>sub-generator</strong> 호출 방법</p>

<ul>
<li><p><strong>default generator</strong> 호출 방법</p>

<ul>
<li><code>yo <span style="color:#c11f1f">[base-name]</span></code> <strong>명령</strong>으로 실행하며, 이로인해 <strong>./generators/app/</strong> 디렉토리 안의 <span style="color:#c11f1f">index.js</span> 파일이 호출된다.</li>
<li>예: yo <span style="color:#c11f1f">cmtech</span></li>
</ul></li>
<li><p><strong>sub-generators</strong> 호출 방법</p>

<ul>
<li> <code>yo [base-name]:<span style="color:#c11f1f">[sub-command]</span></code> <strong>명령</strong>으로 실행하며, 이로인해 <strong>./generators/[sub-command]/</strong> 디렉토리 안의 <span style="color:#c11f1f">index.js</span> 파일이 호출된다.</li>
<li>예: yo cmtech:<span style="color:#c11f1f">router</span></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>base generator</strong> 확장하기</p>

<ul>
<li><p><span style="color:#c11f1f">yeoman-generator</span> <strong>모듈</strong>을 통해 <strong>base generator</strong> 를 생성할 수 있으며, 이것을 <strong>확장</strong>하여 자신만의 <strong>app generator</strong> 모듈 기능을 만들어낸다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// app/index.js 내부</span>

  <span class="c1">// base generator 를 생성한다.</span>
  <span class="kd">var</span> <span class="nx">generators</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yeoman-generator&#39;</span><span class="p">);</span>

  <span class="c1">// base generator 를 확장한다.</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

      <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

      <span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>

      <span class="c1">// This makes `appRootFolder` a required argument.</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">argument</span><span class="p">(</span><span class="s1">&#39;appRootDir&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">required</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>

      <span class="p">}</span>
  <span class="p">});</span>
</code></pre></div></li>
</ul></li>
<li><p><a href="http://blog.naver.com/aron01/60006767632">Overwriting</a>(기존 <strong>property</strong> 를 다시쓰는 행위) the constructor</p>

<ul>
<li>특정 <strong>generator</strong> 메서드들은 <strong>constructor function</strong> 내부에서만 호출해야한다. 만약 그렇지 않을경우, 해당 <strong>기능</strong>이 완벽히 수행되지 않을 수 있다.</li>
<li>예를들어, 사용자가 <strong>Command Line</strong> 을 통해 입력한 <strong>arguments</strong> 를 처리하는 <span style="color:#c11f1f">this.argument</span> 메서드 <strong>호출</strong> 시, <u>해당 코드가 호출되는 <strong>위치</strong>에 따라 다른 <strong>결과</strong>를 반환되게된다.</u></li>
<li><p>먼저 <strong>테스트</strong>위해 <code>yo cmtech --help</code> 명령을 실행한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// cmtech generator 를 --help 옵션과 함께 실행한다.</span>
<span class="nx">yo</span> <span class="nx">cmtech</span> <span class="o">--</span><span class="nx">help</span>
</code></pre></div></li>
<li><p>argument 메서드가 <strong>constructor function</strong> 내부에서 호출된 경우.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// base generator 를 확장한다.</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="nx">constructor</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>

    <span class="c1">// This makes `appRootFolder` a required argument.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">argument</span><span class="p">(</span><span class="s1">&#39;appRootDir&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">required</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>

    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><strong>Yeoman</strong> 이 <strong>arguments</strong> 에 대한 상세 <strong>도움말</strong>을 제공해준다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_6.jpg?1" alt=""></p>

<p>argument 메서드가 <strong>constructor function</strong> 외부에서 호출된 경우.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// base generator 를 확장한다.</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="nx">initializing</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">argument</span><span class="p">(</span><span class="s1">&#39;appRootDir&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">required</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><strong>arguments</strong> 에 대한 <strong>도움말</strong>이 제공되지 않는다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_7.jpg?1" alt=""></p></li>
</ul></li>
<li><p><strong>GENERATOR RUNTIME CONTEXT</strong></p>

<ul>
<li><p>The <strong>run loop</strong></p>

<ul>
<li><p><strong>Yeoman</strong> 은 <strong>run loop</strong> 라는 <strong>queue system</strong> 을 가지며, 이것은 실행하려는 <u>메서드 <strong>그룹</strong></u>에 대한 <strong>우선 순위</strong>를 제공해준다.</p>

<ul>
<li>또한 <strong>run loop</strong> 다루기위해 <a href="https://github.com/SBoudrias/grouped-queue">Grouped-queue</a> 라는 모듈을 사용하고있다.</li>
</ul></li>
<li><p>이 <strong>우선 순위</strong>는 <strong>Yeoman</strong> 이 제공하는 <u>특별한 프로토타입 <strong>메서드 이름</strong>(<span style="color:#c11f1f">priority name</span>)</u>으로만 사용된다.</p>

<ul>
<li><strong>Yeoman</strong> 이 제공하는 <span style="color:#c11f1f">priority name</span> 리스트는 아래와 같다.</li>
</ul>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_11.jpg?1" alt=""></p></li>
<li><p><span style="color:#c11f1f">priority name</span> 일 경우.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">yeoman</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yeoman-generator&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">chalk</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chalk&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">yosay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yosay&#39;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">yeoman</span><span class="p">.</span><span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">initializing</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call by init method 1&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">end</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call by end method 2&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></li>
<li><p>정의된 <strong>메서드</strong> 그룹이 전부 실행된다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_8.jpg?1" alt=""></p></li>
<li><p><span style="color:#c11f1f">priority name</span> 이 아닐경우.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">yeoman</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yeoman-generator&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">chalk</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chalk&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">yosay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yosay&#39;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">yeoman</span><span class="p">.</span><span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">custom_method</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call by init method 1&#39;</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">end</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call by end method 2&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>정의된 <strong>메서드</strong>가 실행되지 않는다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_9.jpg?1" alt=""></p>

<p>또한 <span style="color:#c11f1f">priority name</span> 이 아닐경우, 아래와 같이 <strong>Object</strong> 가 아닌 <strong>Function</strong> 타입으로 정의해야한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">yeoman</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yeoman-generator&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">chalk</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chalk&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">yosay</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yosay&#39;</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">yeoman</span><span class="p">.</span><span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">custom_method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call by custom_method method&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151002/yeoman_10.jpg?1" alt=""></p>

<p><a href="http://yeoman.io/authoring/running-context.html">http://yeoman.io/authoring/running-context.html</a></p></li>
</ul></li>
</ul></li>
<li><p><strong>Template</strong> 엔진 사용하기</p>

<ul>
<li><p><strong>Yeoman</strong> 은 <a href="http://ejs.co/">ejs template</a> 엔진을 사용하며, <a href="https://github.com/sboudrias/mem-fs-editor#copytplfrom-to-context-settings">copyTpl</a> 메서드와 같은 템플릿 관련 메서드들을 제공하고 있다.</p>

<ul>
<li><a href="http://yeoman.io/generator/actions_actions.html">http://yeoman.io/generator/actions_actions.html</a></li>
<li><p>아래 코드는 <strong>메서드</strong> 사용에 대한 간단한 <strong>예제</strong>이며, <strong>.html</strong> 파일외에, <strong>APP</strong> 을 구성하는 기반 파일인 <strong>_package.json</strong> 또는 <strong>_gruntfile.js</strong> 와 같은 파일에도 동일하게 적용할 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">generators</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">writing</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fs</span><span class="p">.</span><span class="nx">copyTpl</span><span class="p">(</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">templatePath</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">),</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">destinationPath</span><span class="p">(</span><span class="s1">&#39;public/index.html&#39;</span><span class="p">),</span>
      <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Templating with Yeoman&#39;</span> <span class="p">}</span>
    <span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></li>
<li><p>template 엔진을 통해 아래와 같이 <strong>출력</strong>된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Templating</span> <span class="kd">with</span> <span class="nx">Yeoman</span><span class="o">&lt;</span><span class="err">/title&gt;</span>
  <span class="o">&lt;</span><span class="err">/head&gt;</span>
<span class="o">&lt;</span><span class="err">/html&gt;</span>
</code></pre></div></li>
<li><p>추가적으로 <strong>의존성</strong>을 관리하는 파일인 <strong>_bower.json</strong> 파일에 적용된 내용이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;%</span> <span class="kd">var</span> <span class="nx">ngVer</span> <span class="o">=</span> <span class="s2">&quot;1.2.26&quot;</span> <span class="o">%&gt;</span>
<span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= env.appName %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= env.appName %&gt; package manager&quot;</span><span class="p">,</span>
  <span class="s2">&quot;homepage&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.cmt-korea.com/&quot;</span><span class="p">,</span>
  <span class="s2">&quot;author&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;sgjeon&quot;</span>
  <span class="p">},</span>

  <span class="s2">&quot;ignore&quot;</span><span class="o">:</span> <span class="p">[</span>
  <span class="s2">&quot;**/.*&quot;</span><span class="p">,</span>
  <span class="s2">&quot;node_modules&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bower_components&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;dependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="p">},</span>
  <span class="s2">&quot;devDependencies&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;angular&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-animate&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-cookies&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-route&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-resource&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-sanitize&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt;%= ngVer %&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;requirejs&quot;</span><span class="o">:</span> <span class="s2">&quot;2.1.14&quot;</span><span class="p">,</span>
  <span class="s2">&quot;jquery&quot;</span><span class="o">:</span> <span class="s2">&quot;2.1.1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;malihu-custom-scrollbar-plugin&quot;</span><span class="o">:</span> <span class="s2">&quot;3.0.8&quot;</span><span class="p">,</span>
  <span class="s2">&quot;jquery-ui&quot;</span><span class="o">:</span> <span class="s2">&quot;1.11.2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;json3&quot;</span><span class="o">:</span> <span class="s2">&quot;3.3.2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;linqjs&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;xml2json&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;purl&quot;</span><span class="o">:</span> <span class="s2">&quot;2.3.1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;jquery-mousewheel&quot;</span><span class="o">:</span> <span class="s2">&quot;3.0.6&quot;</span><span class="p">,</span>
  <span class="s2">&quot;socket.io-client&quot;</span><span class="o">:</span> <span class="s2">&quot;1.3.5&quot;</span><span class="p">,</span>
  <span class="s2">&quot;console.image&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;enquire&quot;</span><span class="o">:</span> <span class="s2">&quot;2.1.2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;angular-local-storage&quot;</span><span class="o">:</span> <span class="s2">&quot;0.1.5&quot;</span><span class="p">,</span>
  <span class="s2">&quot;matchMedia&quot;</span><span class="o">:</span> <span class="s2">&quot;0.2.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;jquery.browser&quot;</span><span class="o">:</span> <span class="s2">&quot;0.0.7&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>전역 <strong>configurations</strong> 파일 관리하기</p>

<ul>
<li><strong>Yeoman</strong> 은 숨김 파일인 <strong>.yo-rc.json</strong> 파일을 통해 전역 <strong>configurations</strong> 을 관리할 수 있으며, 또 그것을 관리하기 위한 <a href="http://yeoman.io/generator/Storage.html">Yeoman Storage API</a> 를 제공하고있다.</li>
<li><p>아래는 기본적인 <strong>.yo-rc.json</strong> 파일 구조이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="p">{</span>
    <span class="s2">&quot;generator-cmtech&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;key&quot;</span><span class="o">:</span> <span class="s2">&quot;value&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></li>
</ul></li>
</ul>

<h2 id="4">4. 정리하며</h2>

<ul>
<li><p>아래 URL 은 현재 개발중인 사이트(<strong>AngularJS</strong> 사용)의 <strong>app generator</strong> 초기 버전이며, <strong>설계</strong>시 참고할 수 있을 듯하여 공유드립니다.(현재는 테스트 버전입니다)</p>

<ul>
<li><a href="https://github.com/mohwa/generator-cmtech">generator-cmtech</a></li>
<li><a href="http://yeoman.io/generator/">Yeoman generator API documentation</a></li>
</ul></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/generator/2015/10/16/yo-generator/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/javascript/2015/10/16/prototype/">객체 지향 언어의 두 가지 줄기</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=javascript">javascript</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-16">
                Oct 16, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <h2 id="1">1. 정의</h2>

<ul>
<li><p><strong>객체 지향 언어</strong>는 크게 두 가지 줄기로 나눌수 있다.</p>

<ul>
<li><strong>클래스 기반 언어</strong>(C++, Java, C#, Ruby, Python 등)</li>
<li><p><a href="https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9C%ED%86%A0%ED%83%80%EC%9E%85_%EA%B8%B0%EB%B0%98_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D">프로토타입 기반 언어</a></p>

<ul>
<li>아래는 그나마 많이 알려진 <strong>프로토타입 기반언어</strong>를 나열해보았다.</li>
<li><a href="http://ko.wikipedia.org/wiki/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8">JavaScript</a>, <a href="http://ko.wikipedia.org/wiki/%EC%95%A1%EC%85%98%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8">ActionScript</a>, <a href="https://ko.wikipedia.org/wiki/J%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8">JScript</a></li>
</ul></li>
<li><p><a href="http://skyul.tistory.com/84">클래스 기반 &amp; 프로토타입 기반 객체 지향 언어</a></p></li>
</ul></li>
<li><p><strong>클래스 기반 언어</strong>와 <strong>프로토타입 기반언어</strong>의 차이</p>

<ul>
<li><p>클래스 기반 언어</p>

<ul>
<li><p><strong>클래스 기반 언어</strong>에서는, <span style="color:#c11f1f">객체의 형식이 정의된</span> <a href="https://msdn.microsoft.com/ko-kr/library/x9afc042.aspx">클래스</a>라는 <strong>개념</strong>을 가진다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 클래스를 선언한다.</span>
<span class="kr">public</span> <span class="kr">class</span> <span class="nx">Person</span>
<span class="p">{</span>
  <span class="c1">// Field</span>
  <span class="kr">public</span> <span class="nx">string</span> <span class="nx">name</span><span class="p">;</span>

  <span class="c1">// Constructor that takes no arguments.</span>
  <span class="kr">public</span> <span class="nx">Person</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Constructor that takes one argument.</span>
  <span class="kr">public</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">string</span> <span class="nx">nm</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="nx">nm</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Method</span>
  <span class="kr">public</span> <span class="k">void</span> <span class="nx">SetName</span><span class="p">(</span><span class="nx">string</span> <span class="nx">newName</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="nx">newName</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// person1 변수는 Person 클래스를 통해 생성된 객체를 참조하게된다.</span>
<span class="nx">Person</span> <span class="nx">person1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</code></pre></div></li>
<li><p><strong>클래스 기반 언어</strong>만의 <a href="https://msdn.microsoft.com/ko-kr/library/ms173149.aspx">상속</a> <strong>개념</strong>을 가진다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Employee: 상속 클래스</span>
<span class="c1">// Manager: 파생 클래스</span>
<span class="kr">public</span> <span class="kr">class</span> <span class="nx">Manager</span> <span class="o">:</span> <span class="nx">Employee</span>
<span class="p">{</span>
  <span class="c1">// Employee fields, properties, methods and events are inherited</span>
  <span class="c1">// New Manager fields, properties, methods and events go here...</span>
<span class="p">}</span>       
</code></pre></div></li>
<li><p>[번외] 그럼 <strong>클래스 기반 언어</strong>의 <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Class.html">클래스</a>는 어떻게 생성되었을까?</p>

<ul>
<li><p><a href="https://kldp.org/node/63651">아래 글은 &quot;skyul&quot; 님의 글을 발췌한 내용입니다</a></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="err">프로토타입</span> <span class="err">기반</span> <span class="nx">OO</span><span class="err">는</span> <span class="err">객체를</span> <span class="err">직접</span> <span class="err">이용하는데</span> <span class="err">비해</span><span class="p">,</span> <span class="err">클래스</span> <span class="err">기반의</span> <span class="nx">OO</span><span class="err">는</span> <span class="err">클래스라는</span> <span class="err">틀을</span> <span class="err">이용해서</span> <span class="err">객체를</span> <span class="err">생성하죠</span><span class="p">.</span>

<span class="err">자연스럽게</span> <span class="err">나오는</span> <span class="err">질문은</span> <span class="s2">&quot;그럼 클래스는 대체 어디서 나온 것인가?&quot;</span><span class="err">라는</span> <span class="err">거죠</span><span class="p">.</span>

<span class="err">대표적</span> <span class="err">클래스</span> <span class="err">기반</span> <span class="nx">OO</span><span class="err">인</span> <span class="nx">Java</span><span class="err">는</span> <span class="err">클래스도</span> <span class="err">객체로</span> <span class="err">봅니다</span><span class="p">.</span> <span class="err">그런데</span> <span class="err">클래스가</span> <span class="err">객체면</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스가</span> <span class="err">있어야</span> <span class="err">합니다</span><span class="p">.</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스도</span> <span class="err">객체이므로</span><span class="p">,</span> <span class="err">클래스를</span> <span class="err">찍어낸</span> <span class="err">클래스를</span> <span class="err">만드는</span> <span class="err">클래스도</span> <span class="err">있어야</span> <span class="err">합니다</span><span class="p">.</span> 

<span class="err">이렇게</span> <span class="err">무한히</span> <span class="err">반복</span> <span class="err">되기</span> <span class="err">때문에</span> <span class="s2">&quot;inifnite regress problem of classes&quot;</span><span class="err">라고</span> <span class="err">불리는</span> <span class="err">것이죠</span><span class="p">.</span>

<span class="nx">Java</span><span class="err">는</span> <span class="err">이</span> <span class="err">문제를</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">Class</span><span class="err">가</span> <span class="err">모든</span> <span class="err">클래스의</span> <span class="err">틀이라고</span> <span class="err">이야기하면서</span><span class="p">,</span> <span class="err">은근</span> <span class="err">슬쩍</span> <span class="err">넘어갔지만</span> <span class="err">여기에</span> <span class="err">숨은</span> <span class="err">논리적인</span> <span class="err">문제를</span> <span class="err">확실히</span> <span class="err">못풀고</span> <span class="s2">&quot;태초에 Class가 있었다&quot;</span><span class="err">라는</span> <span class="err">해법이</span> <span class="err">나와버리는거죠</span><span class="p">.</span>

<span class="err">다른</span> <span class="err">접근</span> <span class="err">방법을</span> <span class="err">취한</span> <span class="err">언어가</span> <span class="err">있는지</span> <span class="err">모르겠지만</span><span class="p">,</span> <span class="err">대부분의</span> <span class="err">클래스</span> <span class="err">기반</span> <span class="err">언어는</span> <span class="err">클래스는</span> <span class="nx">second</span><span class="o">-</span><span class="nx">order</span> <span class="nx">citizen</span><span class="err">으로</span> <span class="err">특별히</span> <span class="err">취급해서</span> <span class="err">찍어낼</span> <span class="err">수</span> <span class="err">있는</span> <span class="err">틀은</span> <span class="err">원래</span> <span class="err">있었다라고</span> <span class="err">얘기하게</span> <span class="err">되는거죠</span><span class="p">.</span>

<span class="err">그</span> <span class="err">대상이</span> <span class="err">클래스라는</span> <span class="err">거만</span> <span class="err">제외하면</span> <span class="err">접근</span> <span class="err">방법은</span> <span class="err">프로토타입</span> <span class="err">방식과</span> <span class="err">크게</span> <span class="err">다르지</span> <span class="err">않은</span> <span class="err">거고요</span><span class="p">.</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>프로토타입 기반 언어</p>

<ul>
<li><p><strong>프로토타입 기반 언어</strong>에서는 <a href="https://msdn.microsoft.com/ko-kr/library/x9afc042.aspx">클래스</a>라는 <strong>개념</strong>이 존재하지 않으며, 여러 종류의 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects">Built-in 객체</a>들이 시스템상에 존재하게된다. 또한 <strong>클래스 기반언어</strong>의 <a href="https://msdn.microsoft.com/ko-kr/library/ms173149.aspx">상속</a> 개념과 달리, <span style="color:#c11f1f">객체 원형</span>의 <span style="color:#c11f1f">위임</span> 과정을 통해 <strong>상속</strong> 과정이 구현된다.</p>

<ul>
<li><p><strong>프로토타입 기반 언어</strong>는 <a href="https://msdn.microsoft.com/ko-kr/library/x9afc042.aspx">클래스</a>가 존재하지 않는다.</p>

<ul>
<li>함수 객체는 클래스가 아닌 <strong>First-Class Objects</strong>이다.<p></li>
<li>선언된 함수 객체는, <strong>프로토타입 기반 언어</strong>의 특징인, <strong>위임</strong> 과정을 통해 만들어진 객체의 <span style="color:#c11f1f">원형</span>을 참조하고있다.</li>
<li><p>즉, JS <strong>함수</strong>는 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions"></a> 생성자 함수 객체의 <span style="color:#c11f1f">원형</span>(Function.prototype)을 <strong>참조</strong>하는 또 다른 <strong>함수 객체</strong>일뿐이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
<span class="p">}</span>

<span class="c1">// 선언된 A 함수 객체의 데이터 타입은 function 타입을 반환한다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">A</span><span class="p">);</span> <span class="c1">// function</span>

<span class="c1">// 선언된 A 함수 객체의 생성자 함수는 Function 생성자 함수 객체를 가리키고있다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">constructor</span><span class="p">);</span> <span class="c1">// Function</span>

<span class="c1">// 선언된 A 함수 객체의 생성자 함수 객체</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nb">Function</span><span class="p">);</span> <span class="c1">// Function</span>

<span class="c1">// 선언된 A 함수 객체는 위임 과정을 통해, 자신을 만든 생성자 함수(Function) 객체의 원형(Function.prototype)을 참조하고 있다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">);</span>

<span class="c1">// 선언된 A 함수 객체로 위임된 원형과 Function 생성자 함수 객체의 원형 비교(동일하다)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_2.png" alt="">       </p></li>
</ul></li>
</ul></li>
<li><p>JS <strong>Built-in 객체</strong> 중 하나인 <strong>Array</strong> 객체</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span> <span class="s2">&quot;Banana&quot;</span><span class="p">];</span>

<span class="c1">// 배열의 길이를 반환한다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fruits</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 2</span>
</code></pre></div></li>
<li><p>객체 원형 및 <strong>위임</strong> 과정</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// Object 생성자 함수 객체로 새로운 객체를 생성한다.</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span>

  <span class="c1">// 생성된 새로운 객체</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>

  <span class="c1">// 새로운 객체로 위임된 Object 생성자 함수 객체의 원형</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">);</span>

  <span class="c1">// Object 생성자 함수 객체의 원형</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>

  <span class="c1">// 새로운 객체로 위임된 원형과 Object 생성자 함수 객체의 원형 비교(동일하다)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>

  <span class="c1">// 위임 과정을 통해 toString 메서드를 사용할 수 있다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">);</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_1.png" alt="">     </p></li>
</ul></li>
</ul></li>
<li><p><strong>클래스 기반 언어</strong>는 보통 <a href="http://ko.wikipedia.org/wiki/%EC%9E%90%EB%A3%8C%ED%98%95_%EC%B2%B4%EA%B3%84#.EC.A0.95.EC.A0.81_.EC.A0.95.ED.98.95">정적 언어</a>를 말하며, JS 와 같은 <a href="http://ko.wikipedia.org/wiki/%EC%9E%90%EB%A3%8C%ED%98%95_%EC%B2%B4%EA%B3%84#.EB.8F.99.EC.A0.81_.EC.A0.95.ED.98.95">동적 언어</a>는 <span style="color:#c11f1f">컴파일 시점</span>이 아닌 <span style="color:#c11f1f">런타임 시점</span>에서 <span style="color:#6298c1">정적 언어</span>가 다루는 특정 일(<a href="http://ko.wikipedia.org/wiki/%EC%9E%90%EB%A3%8C%ED%98%95_%EC%B2%B4%EA%B3%84#.EC.9E.90.EB.A3.8C.ED.98.95_.EA.B2.80.EC.82.AC">자료형 검사</a>, <a href="https://ko.wikipedia.org/wiki/%ED%95%A8%EC%88%98_%EC%98%A4%EB%B2%84%EB%A1%9C%EB%93%9C">함수 오버로드</a>, 동적 디스패치 등)들을 수행하게된다.</p>

<ul>
<li><p>정적/<a href="http://ko.wikipedia.org/wiki/%EB%8F%99%EC%A0%81_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%96%B8%EC%96%B4">동적</a> 언어란?</p>

<ul>
<li>정적언어<p>

<ul>
<li><strong>컴파일 시점</strong>에서 자료형 검사가 이루어진다.<p></li>
<li><strong>컴파일 시점</strong>의 자료형 검사로 인해 <strong>런타임 시점</strong>에서는 자료형에 대한 많은 오류를 줄일 수 있다.(단 컴파일 시점에서 결정될 수 있는 자료형 정보만이 평가(검사)된다)<p></li>
<li><strong>컴파일 시점</strong>에서의 자료형 검사를 반복할 필요가 없기때문에, 전체 <strong>프로그램 실행 시간</strong>이 줄어든다.<p></li>
</ul></li>
<li><p>동적언어</p>

<ul>
<li><strong>런타임 시점</strong>에서 자료형 검사가 이루어진다.<p></li>
<li><strong>런타임 시점</strong>의 자료형 검사로 인해 자료형에 대한 <strong>런타임 오류</strong>가 발생할 수 있다.(빈도수가 생각보다 많을수있다)<p></li>
<li>모든 <strong>런타임 객체</strong>가 자료형에 대한 정보를 가지고 있으며, 이를 통해 <a href="https://ko.wikipedia.org/wiki/%ED%95%A8%EC%88%98_%EC%98%A4%EB%B2%84%EB%A1%9C%EB%93%9C">함수 오버로드</a>, <span style="color:#6298c1">동적 디스패치</span> 등을 수행할 수 있다.(<a href="https://ko.wikipedia.org/wiki/%EB%8F%99%EC%A0%81_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%96%B8%EC%96%B4">동적 언어</a>가 가지는 유연성)<p></li>
<li>변수는 모든 자료형을 가질 수 있다.<p></li>
<li><strong>JS 동적 타이핑</strong><p>

<ul>
<li><em>자바스크립트는 느슨한 타입 (loosely typed) 언어, 혹은 동적 (dynamic) 언어이다. 그 말은, 변수의 타입을 미리 선언할 필요가 없다는 뜻이다. 타입은 프로그램이 처리되는 과정에서 자동으로 파악될 것이다. 또한 그 말은 같은 변수에 여러 타입의 값을 넣을 수 있다는 뜻이다.</em><p></li>
</ul></li>
<li><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Data_structures">자바스크립트의 자료형</a><p></li>
<li><a href="http://pyrasis.com/book/GoForTheReallyImpatient/Unit01">Go 언어란? 정적 타입과 동적 타입에 대한 이야기</a></li>
<li><p><strong>런타임 시점</strong>에서 자료형 검사가 이루어진다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="c1">// 원시 타입인 string 타입을 할당한다.</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span><span class="p">;</span>

  <span class="c1">// 원시 타입인 number 타입을 할당한다.</span>
  <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// object 타입을 할당한다.</span>
  <span class="nx">x</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// Object</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">x</span><span class="p">);</span> <span class="c1">// object</span>
</code></pre></div></li>
<li><p><strong>런타임 시점</strong>의 자료형 검사로 인해 자료형에 대한 <strong>런타임 오류</strong>가 발생할 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">num</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c1">// runtime error</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span> <span class="c1">// num.toFixed is not a function</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p>모든 <strong>런타임 객체</strong>가 자료형에 대한 정보를 가지고 있으며, 이를 통해 <a href="https://ko.wikipedia.org/wiki/%ED%95%A8%EC%88%98_%EC%98%A4%EB%B2%84%EB%A1%9C%EB%93%9C">함수 오버로드</a>, <span style="color:#6298c1">동적 디스패치</span> 등을 수행할 수 있다.</p>

<ul>
<li>JS 는 기본적으로 <strong>함수 오버로드</strong>를 지원하지 않으며, 아래와 같은 방법으로 구현 가능하다.<p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 함수 오버로드 구현</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 1</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">2</span><span class="p">){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// 2</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">A</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="nx">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// 2</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h2 id="2">2. 프로토타입 언어에서 객체를 생성하는 두 가지 방법</h2>

<ul>
<li><p>무에서 <strong>객체</strong>를 생성하는 방법(<span style="color:#c11f1f">원형</span> 객체가 없는 상태에서 객체를 생성하는 방법)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// 원형 객체가 없는 상태에서 객체를 생성하는 방법(일부 브라우저를 통해 아래와 같은 무형 객체를 구현할 수 있다)</span>
    <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">instance</span><span class="p">);</span> <span class="c1">// Object</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">instance</span><span class="p">);</span> <span class="c1">// object</span>
</code></pre></div>
<p><img src="https://www.dropbox.com/s/ucpd5x23mdd1581/44.jpg?dl=1" alt=""></p></li>
<li><p>유에서 객체를 생성하는 방법(<span style="color:#c11f1f">원형</span> 객체가 존재하는 상태에서 객체를 생성하는 방법)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// 원형 객체가 존재하는 상태에서 객체를 생성하는 방법(일반적인 위임 과정을 거친 객체)</span>
    <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">instance</span><span class="p">);</span> <span class="c1">// Object</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">instance</span><span class="p">);</span> <span class="c1">// object</span>
</code></pre></div>
<p><img src="https://www.dropbox.com/s/8eeliasbb29qatz/45.jpg?dl=1" alt=""></p></li>
<li><p>보통 <strong>프로토타입 기반 언어</strong>에는 <strong>Object 객체</strong>(Master Object)가 존재하며, 이 객체의 <span style="color:#c11f1f">원형</span>에는 모든 <strong>객체</strong>가 공통적으로 필요한 <span style="color:#c11f1f">특징</span>(속성, 메서드)들이 <strong>정의</strong>되어있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">);</span> <span class="c1">// Object.prototype</span>

<span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span>
<span class="c1">// 나를 만든 생성자 함수 객체의 원형</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">);</span> <span class="c1">// Object.prototype</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// Object.prototype</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_3.png" alt="">       </p></li>
</ul>

<h2 id="3">3. 위임 과정에 대해</h2>

<ul>
<li><p>JS는 <strong>프로토타입 기반 언어</strong>의 특징인 <strong>위임</strong> 과정을 따른다.</p></li>
<li><p>모든 <strong>위임</strong> 과정은 <a href="http://ko.wikipedia.org/wiki/%EB%9F%B0%ED%83%80%EC%9E%84">런타임</a> 시점에서 이루어진다.</p></li>
<li><p><strong>위임</strong>이란 객체들간의 <span style="color:#c11f1f">원형 복제 과정</span>을 말한다.</p></li>
<li><p><strong>위임</strong>된 객체 <span style="color:#c11f1f">원형</span>은 값(value)이 아닌 <span style="color:#c11f1f">참조 값</span>(reference of value)을 갖는다.</p></li>
<li><p><strong>위임</strong>된 객체 <span style="color:#c11f1f">원형</span>은 해당 객체의 특징(속성, 메서드)들을 <strong>공유</strong>하기위해 사용된다.</p>

<ul>
<li><p>A 함수 객체에 대한 <strong>위임</strong> 결과.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span>
</code></pre></div></li>
<li><p><strong>A</strong>: 선언된 A 함수 객체</p></li>
<li><p><strong>A.prototype</strong>: 나를 통해 생성될 객체의 <span style="color:#c11f1f">원형</span></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">===</span> <span class="k">new</span> <span class="nx">A</span><span class="p">().</span><span class="nx">__proto__</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><p><strong>A.__proto__</strong>: 나를 만든 생성자 함수 객체의 <span style="color:#c11f1f">원형</span></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><p><strong>A.constructor</strong>: 나를 만든 생성자 함수 객체</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_4.png" alt="">     </p></li>
<li><p>objA 객체에 대한 <strong>위임</strong> 결과.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

<span class="p">}</span>

<span class="c1">// A 생성자 함수 객체를 통해 새로운 객체를 생성한다.</span>
<span class="kd">var</span> <span class="nx">objA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">objA</span><span class="p">);</span>
</code></pre></div></li>
<li><p><strong>objA</strong>: 생성된 objA 객체</p></li>
<li><p><strong>objA.__proto__</strong>: 나를 만든 생성자 함수 객체의 원형</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">objA</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">===</span> <span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><p><strong>A.constructor</strong>: 나를 만든 생성자 함수 객체</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">objA</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nx">A</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_5.png" alt="">       </p></li>
</ul></li>
<li><p><strong>위임</strong>받은 자식 객체는 부모 객체의 <span style="color:#c11f1f">원형</span>을 참조하고 있기 때문에, 자식 객체로 부터 부모 객체의 <span style="color:#c11f1f">원형</span>이 변조될 수 있다.(이로인해 아주 위험한 상황이 연출될 수 있다)</p>

<ul>
<li>부모 객체: A 생성자 함수 객체</li>
<li><p>자식 객체: objA 변수가 참조하는 객체(new A)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 객체를 선언한다.</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

<span class="p">}</span>

<span class="kd">var</span> <span class="nx">objA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">;</span>

<span class="c1">// 자식 객체를 통해 부모 객체의 원형(A.prototype)을 변조한다.</span>
<span class="c1">// objA.__proto__ === A.prototype</span>
<span class="nx">objA</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">getConstructor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getConstructor</span><span class="p">());</span> <span class="c1">// A 생성자 함수 객체</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_6.png" alt="">       </p></li>
</ul></li>
<li><p><strong>위임</strong> 받은 자식 객체는 원하는 <strong>특징</strong>(속성, 메서드)에 도달하기위해, 각 <strong>객체</strong>들이 가진 <span style="color:#c11f1f">원형</span>을 연속적으로 따라가 찾아내게된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// parent 객체는 id 속성 값을 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;parentId&#39;</span>
<span class="p">};</span>

<span class="c1">// child1 객체는 name 속성 값을 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;child1Name&#39;</span>
<span class="p">};</span>

<span class="c1">// child2 객체는 각 속성 값을 반환받는 get 접근자 메서드를 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">getId</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">getName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// parent 객체의 모든 특징(속성, 메서드)들을 child1 객체 원형으로 위임한다.</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
<span class="c1">// child1 객체의 모든 특징(속성, 메서드)들을 child2 객체 원형으로 위임한다.</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">child1</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">child2</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getId</span><span class="p">());</span> <span class="c1">// parentId</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span> <span class="c1">// child1Name</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_7.png" alt="">       </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// parent 객체는 id 속성 값을 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;parentId&#39;</span>
<span class="p">};</span>

<span class="c1">// child1 객체는 name 속성 값을 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;child1Name&#39;</span>
<span class="p">};</span>

<span class="c1">// child2 객체는 각 속성 값(id, name)과 그것들을 반환하는 get 접근자 메서드를 가지고 있다.</span>
<span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;child2Id&#39;</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;child2Name&#39;</span><span class="p">,</span>
    <span class="nx">getId</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">getName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// parent 객체의 모든 특징(속성, 메서드)들을 child1 객체 원형으로 위임한다.</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
<span class="c1">// child1 객체의 모든 특징(속성, 메서드)들을 child2 객체 원형으로 위임한다.</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">child1</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">child2</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getId</span><span class="p">());</span> <span class="c1">// child2Id</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span> <span class="c1">// child2Name</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151012/prototype_8.png" alt="">       </p></li>
<li><p>또한, <strong>프로토타입</strong> 검색 범위는 동적으로 변경될 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="p">{};</span>

<span class="kd">function</span> <span class="nx">extend</span><span class="p">(){</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">y</span><span class="o">:</span> <span class="p">{},</span>
        <span class="nx">z</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// 런타임 시점에서 객체가 확장된다.</span>
<span class="nx">extend</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">instance</span><span class="p">);</span>
</code></pre></div>
<p><img src="https://www.dropbox.com/s/1f9j861jn09w3sp/11.jpg?dl=1" alt=""></p></li>
</ul>

<h2 id="4">4. 연쇄 과정에 대해</h2>

<ul>
<li><p><strong>순수 프로토타입</strong>은 <strong>연쇄적 프로토타입</strong>이라고도 한다.</p></li>
<li><p><strong>연쇄</strong>란 객체들간의 <span style="color:#c11f1f">원형 복제 과정</span>을 말한다.</p></li>
<li><p><strong>연쇄</strong>된 객체 원형은 <span style="color:#c11f1f">참조 값</span>(reference of value)이 아닌 <strong>원본</strong>으로부터 <span style="color:#c11f1f">복제된</span> 객체 값(value)을 갖는다.</p></li>
<li><p><strong>연쇄</strong>된 자식 객체는 원본 객체로부터 <span style="color:#c11f1f">복제된 원형</span>을 참조하기 때문에, 자식 객체를 통해 원본 객체의 특징들이 <strong>변조</strong>될 수 없다.</p></li>
<li><p><strong>연쇄</strong>된 자식 객체는 원하는 <strong>특징</strong>(속성, 메서드)에 도달하기위해, 각 <strong>객체</strong>들이 가진 <span style="color:#c11f1f">원형</span>을 연속적으로 따라가 찾아내게된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 원본 객체</span>
<span class="kd">var</span> <span class="nx">instance1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;yanione&#39;</span>
<span class="p">};</span>

<span class="c1">// 자식 객체</span>
<span class="kd">var</span> <span class="nx">instance2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;mohwa&#39;</span>
<span class="p">};</span>

<span class="c1">// 클론 함수</span>
<span class="kd">function</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">!==</span> <span class="nb">Object</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">n</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">){</span>
        <span class="nx">clone</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">clone</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// 원본 객체를 복제한다.</span>
<span class="kd">var</span> <span class="nx">cloneInstance</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">instance1</span><span class="p">);</span>

<span class="c1">// 복제된 원본 객체를 자식 객체의 원형으로 연쇄한다.</span>
<span class="nx">instance2</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">cloneInstance</span><span class="p">;</span>

<span class="c1">// 자식 객체가 연쇄받은 원본 객체의 속성 값을 변경한다.</span>
<span class="nx">instance2</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;mohwa&#39;</span><span class="p">;</span>

<span class="c1">// 이전 위임 과정과 달리 자식 객체로 인해 원본 객체의 원형이 변조되지 않는다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">instance1</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span> <span class="c1">// yanione</span>
</code></pre></div></li>
<li><p>연쇄 방식의 프로토타입 검색 범위는 정적(연쇄 시점에 의해)으로 고정된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 원본 객체</span>
<span class="kd">var</span> <span class="nx">instance1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;yanione&#39;</span>
<span class="p">};</span>

<span class="c1">// 자식 객체</span>
<span class="kd">var</span> <span class="nx">instance2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;mohwa&#39;</span>
<span class="p">};</span>

<span class="c1">// 클론 함수</span>
<span class="kd">function</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">!==</span> <span class="nb">Object</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">n</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">){</span>
        <span class="nx">clone</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nx">clone</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// 원본 객체를 복제한다.</span>
<span class="kd">var</span> <span class="nx">cloneInstance</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">instance1</span><span class="p">);</span>

<span class="c1">// 복제된 원본 객체를 자식 객체의 원형으로 연쇄한다.</span>
<span class="nx">instance2</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">cloneInstance</span><span class="p">;</span>

<span class="c1">// 원본 객체를 동적으로 확장시킨다.</span>
<span class="nx">instance1</span><span class="p">.</span><span class="nx">getId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 자식 객체는 연쇄 시점의 복제된 원본 객체의 원형을 참조하고 있기때문에, 동적으로 확장된 원본 객체의 특성을 갖지 못한다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">instance2</span><span class="p">.</span><span class="nx">getId</span><span class="p">);</span> <span class="c1">// undefined</span>
</code></pre></div></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/javascript/2015/10/16/prototype/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/designpattern/2015/10/16/objectpool-inJS/">ObjectPool in JS</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=designpattern">designpattern</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-16">
                Oct 16, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <h2 id="1">1. 정의</h2>

<ul>
<li><p>생성된 <strong>객체</strong>들을 별도의 <strong>Pool</strong> 안에 저장 후 <span style="color:#c11f1f">재사용</span> 하는 방법으로, 불필요한 객체 <strong>생성</strong> 및 <strong>반환</strong>(<strong>GC</strong>에 의한)을 <span style="color:#c11f1f">최소화</span>하는 <u><strong>디자인 패턴</strong></u>중 하나 이다.</p>

<ul>
<li><strong>객체</strong>  <span style="color:#c11f1f">재사용</span>을 위해, 생성된 <strong>객체</strong>를 <strong>Pool</strong> 안에 저장시켜 놓는다.</li>
<li><p>새로운 <strong>객체</strong>가 필요할때는, <u>무조건 새로 <span style="color:#c11f1f">생성</span></u>하는것이 아니라, <strong>Pool</strong> 안에 <span style="color:#c11f1f">반환</span>된 <strong>객체</strong>가 존재한다면, <u>그 중 하나를 <span style="color:#c11f1f">재사용</span> 한다.</u></p>

<ul>
<li><em>객체 <span style="color:#c11f1f">재사용</span>으로 Heap 메모리 사용을 <span style="color:#c11f1f">최소화</span>한다.</em></li>
</ul></li>
<li><p>사용(객체)이 끝난 후에는 <u>다시 <strong>Pool</strong> 안에 <span style="color:#c11f1f">반환</span>시킨다.</u></p></li>
</ul></li>
</ul>

<h2 id="2">2. 특징</h2>

<ul>
<li><p>정해진 <strong>범위</strong>내에서 개발자가 직접 <u><strong>Heap 메모리</strong>를 관리(객체 <span style="color:#c11f1f">생성</span> 및 <span style="color:#c11f1f">반환</span>)</u>할 수 있다.</p>

<ul>
<li><p><u><strong>객체 생성 비용</strong></u>을 줄일 수 있다.(Heap 메모리 사용을 줄일 수 있다)</p>

<ul>
<li><em>당연한 말이겠지만, 생성되는 객체 <span style="color:#c11f1f">크기</span> 및 그 <span style="color:#c11f1f">수</span>에 따라, <u>더 많은 비용을 줄일 수도 있다.</u></em></li>
</ul></li>
<li><p><strong>GC</strong> 를 통해 일어나는, <u>메모리 <span style="color:#c11f1f">반환</span>(반환 시 일어나는 일련의 작업들)) <strong>비용</strong>을 줄일 수 있다.</u></p>

<ul>
<li>보통 이 과정(메모리 반환 과정)을 처리하는 동안에는, <strong>프로그램 실행</strong> 이 중단된다.</li>
<li>또한, 이 과정은 <u>프로그램 실행 중 <span style="color:#c11f1f">임의의 시간</span>에, <span style="color:#c11f1f">임의의 시간동안</span> 언제라도 일어날 수 있다.</u></li>
<li>개발자는 이 <strong>과정</strong>을 <u><span style="color:#c11f1f">제어</span>할 수 없다.</u></li>
</ul>

<p><a href="http://www.html5rocks.com/ko/tutorials/speed/static-mem-pools/">Static Memory Javascript with Object Pools</a></p></li>
</ul></li>
<li><p><span style="color:#c11f1f">재사용</span>되는 <strong>객체</strong>는 <u>모두 <strong>동일한 타입</strong>을 갖는다.</u></p></li>
</ul>

<h2 id="3-js-objetpool">3. JS 로 동적 ObjetPool 구현해보기</h2>

<iframe height='540' scrolling='no' src='http://codepen.io/yanione/embed/jPdzWB/?height=540&theme-id=0&default-tab=result' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='http://codepen.io/yanione/pen/jPdzWB/'>jPdzWB</a> by mohwa (<a href='http://codepen.io/yanione'>@yanione</a>) on <a href='http://codepen.io'>CodePen</a>.
</iframe>

<ul>
<li>일반적인 동적 <strong>Objet Pool</strong> 기능을 만드는 방법은 위 코드와 같이 크게 어렵지 않다.(물론 지원하는 기능의 범위에 따라, 구현 수준은 크게 달라질 수 있다)</li>
</ul>

<h2 id="4-objectpool">4. ObjectPool 적용 테스트</h2>

<ul>
<li><p>Click 버튼을 <span style="color:#c11f1f">10</span>번 누른 후 <strong>Profiles(in Chrome Tool) 패널</strong>을 통해, <strong>Heap Memory</strong> 를 체크하면 <span style="color:#c11f1f">적용</span> <strong>유/무</strong>에 따른 결과를 얻을 수 있다.</p>

<ul>
<li><p><strong>Object Pool</strong> 적용 전</p>

<ul>
<li><p><span style="color:#c11f1f">Ball</span> 생성자 함수를 통해 객체를 <strong>300</strong>개 할당했다.</p>

<ul>
<li>30 * 10 = 300(무조건 새로운 객체를 Heap 메모리에 할당했다)</li>
</ul></li>
</ul>

<p><img src="/blog/assets/images/posts/ballHeap.jpg" alt=""></p></li>
<li><p><strong>Object Pool</strong> 적용 후</p>

<ul>
<li><p><span style="color:#c11f1f">$F</span> 생성자 함수를 통해 <strong>93</strong>개의 객체를 할당했다.</p>

<ul>
<li><span style="color:#c11f1f">$F</span>: <strong>Object Pool</strong> 라이브러리상에서 만든 생성자 함수.</li>
<li>적용 후에는 총 <strong>93</strong>개의 객체를 <span style="color:#c11f1f">할당</span>했으며, <strong>207</strong>개의 객체를 <span style="color:#c11f1f">재사용</span>하였다.</li>
</ul></li>
</ul>

<p><img src="/blog/assets/images/posts/ballHeap2.jpg" alt=""></p></li>
</ul></li>
</ul>

<h2 id="5">5. 정리하며</h2>

<ul>
<li><p>즉 지나친 객체 <span style="color:#c11f1f">생성</span> 및 <span style="color`:#c11f1f">반환</span>을 <strong>최소화</strong> 하는것이, <strong>어플리케이션</strong>상에 <span style="color:#c11f1f">메모리 변동</span>을 줄이는 방법이며, 이로인해 사용자 경험까지 최적화할 수 있다.</p></li>
<li><p>일반적인 <strong>웹</strong>상에서는 적용할 일이 거의 없어보이지만, <strong>게임 어플리케이션</strong>이라면, 적용 범위가 꽤 많을 듯 하다.</p></li>
</ul>

<h2 id="6-url">6. 참고 URL</h2>

<ul>
<li><p><a href="http://ufx.kr/blog/591">액션스크립트의 객체 재사용을 위한 오브젝트 풀(Object Pool)</a></p></li>
<li><p><a href="http://www.html5rocks.com/ko/tutorials/speed/static-mem-pools/">Static Memory Javascript with Object Pools</a></p></li>
<li><p><a href="http://beej.us/blog/data/object-pool/">Object Pools</a></p></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/designpattern/2015/10/16/objectpool-inJS/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/javascript/2015/10/15/function-inJS/">Function in JS</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=javascript">javascript</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-15">
                Oct 15, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <ul>
<li><p>JS 의 다양한 함수 식</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// 함수 선언식의 경우, 해당 execution context 진입 시, VO 의 새로운 속성으로 추가되며, function object 로 초기화된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>

<span class="c1">// 함수 선언식(FD)</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>
<span class="p">};</span>

<span class="c1">// 함수 표현식의 경우, 해당 execution context 진입 시, VO 의 새로운 속성으로 추가되지않으며, </span>
<span class="c1">// 초기화된 undefined 는 B 변수 선언식에 의해 초기화된것이다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span> <span class="c1">// undefined</span>

<span class="c1">// 함수 표현식(FE)</span>
<span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>
<span class="p">};</span>

<span class="c1">// 즉시 실행 함수(IIFE)(함수 표현식 중 하나)</span>
<span class="p">(</span><span class="kd">function</span> <span class="nx">C</span><span class="p">(){</span>
    <span class="c1">// function execution context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// null ==&gt; global object</span>
<span class="p">})();</span>

<span class="c1">// 함수 표현식의 경우, 해당 execution context 진입 시, VO 의 새로운 속성으로 추가되지않으며, </span>
<span class="c1">// 즉시 실행 함수의 경우, 함수 실행이 끝난 후 바로 소멸된다</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// Uncaught ReferenceError: C is not defined</span>
</code></pre></div></li>
<li><p>함수 선언식(Function Declaration(<span style="color:#c11f1f">FD</span>))</p>

<ul>
<li><p>A 함수 선언</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// A 함수 선언</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
  <span class="c1">// function execution context</span>
<span class="p">};</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">FD</span> 는 함수 정의를 나타내는 문장으로 해석되며, <strong>수행결과</strong>가 존재하지 않는다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){}.</span><span class="nx">length</span> <span class="c1">// Uncaught SyntaxError: Unexpected token .</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">FD</span> 는 해당 Execution Context <strong>진입 시</strong>, <span style="color:#c11f1f">VO</span> 의 새로운 <strong>속성</strong>으로 추가되며, function object 로 <strong>초기화</strong> 된다.(이 현상을 보통 <strong>Hoisting</strong> 및 <strong>Compiler Lift</strong> 라 부른다)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="c1">// execution context 진입 시 function object 로 초기화된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// A function object</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
  <span class="p">};</span>
</code></pre></div></li>
<li><p>global execution context 내부 선언</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>
  <span class="p">};</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
<li><p>global or function execution context 내부 선언</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="c1">// global execution context 의 VO 속성으로 추가된다.</span>
  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// 내부 함수</span>
    <span class="c1">// function execution context 의 AO(VO) 속성으로 추가된다.</span>
    <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>
      <span class="c1">// function execution context                 </span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// function execution context 의 AO(VO) 속성으로 추가된다.</span>
        <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span>
      <span class="p">},</span>
      <span class="c1">// 함수 호출 시 생성되는 Scope Chain</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span>
        <span class="p">},</span>              
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// global execution context 의 VO 속성으로 추가된다.</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>              
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><p>함수 표현식(Function Expression(<span style="color:#c11f1f">FE</span>))</p>

<ul>
<li><span style="color:#c11f1f">FE</span> 는 기본적으로 <strong>표현식 위치</strong>에만 정의할 수 있다.</li>
<li><p><span style="color:#c11f1f">FE</span> 는 해당 Execution Context 진입 시, <span style="color:#c11f1f">VO</span> 의 새로운 속성으로 추가되지않으며, <strong>초기화</strong>된 undefined 는 A 변수 선언식에 의해 <strong>초기화</strong>된것이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// 함수 표현식이 아닌, A 변수 선언식에 의해 undefined 로 초기화된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// undefined</span>

  <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>

  <span class="c1">// 실행 코드 처리 후 function object 가 할당된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">FE</span> 는 함수 데이터로 해석되며, <strong>수행 결과</strong>가 존재한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">     <span class="c1">// 괄호 연산자를 통한 함수 표현식</span>
    <span class="p">(</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){}).</span><span class="nx">length</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(){}).</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 0</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">FE</span> 는 <strong>선택적 이름</strong>을 가질 수 있다.</p>

<ul>
<li><span style="color:#c11f1f">익명 함수 표현 식</span>(<span style="color:#c11f1f">AFE</span>(Anonymous Function Expression))</li>
<li><p><span style="color:#c11f1f">기명 함수 표현 식</span>(<span style="color:#c11f1f">NFE</span>(Named Function Expression))</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 익명 함수 표현식</span>
<span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>

<span class="c1">// 기명 함수 표현식</span>
<span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_B</span><span class="p">(){};</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">NFE</span>의 함수 이름은 <span style="color:#c11f1f">VO</span> 속성으로 추가되지 않는다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 기명 함수 표현식</span>
<span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_A</span><span class="p">(){};</span> 

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_A</span><span class="p">);</span> <span class="c1">// undefined</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">NFE</span>의 함수 이름은 함수 내부에서만 접근 가능하다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_A</span><span class="p">(){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_A</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="p">};</span>

<span class="nx">A</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_A</span><span class="p">);</span> <span class="c1">// undefined</span>
</code></pre></div></li>
</ul></li>
<li><p>그룹화 연산자의 활용</p>

<ul>
<li><p>두 <span style="color:#c11f1f">FD</span> 와 그룹화 연산자의 사용은 동일하다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// JS 파서는 A 함수 선언식과 1 표현식을 감싸는 그룹화 연산자로 해석한다.</span>
    <span class="c1">// 즉 error 가 발생하지 않는다.</span>
    <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="p">}(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 1</span>

    <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="p">}</span>    

    <span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></li>
<li><p>즉시 실행 <strong>함수 표현식</strong>(Immediately-Invoked Function Expression(<span style="color:#c11f1f">IIFE</span>))</p>

<ul>
<li>즉시 실행 함수는 <span style="color:#c11f1f">FE</span> 중 하나이다.<p></li>
<li><strong>그룹화 연산자</strong>를 통해 파서가 <span style="color:#c11f1f">FE</span> 로 <strong>해석</strong>하도록 만들 수 있다.<p></li>
<li><p><strong>그룹화 연산자</strong>를 통해 생성된 함수는 <u>함수 실행이 끝난 후 <strong>바로 소멸</strong>된다.</u><p></p>

<ul>
<li><span style="color:#c11f1f">FE</span> 는 <span style="color:#c11f1f">VO</span> 의 속성으로 추가되지 않는다.<p></li>
<li>즉 <span style="color:#c11f1f">VO</span> 에 추가되지 않는다는 말은, <strong>메모리를 가용성</strong>이 좋다는 말과 같다.<p></li>
</ul></li>
<li><p>함수를 <strong>실행</strong> 후 바로 <strong>소멸</strong> 시키는 경우, 사용하면 좋다.<p></p></li>
<li><p>하지만 이 말은 <strong>생성된 함수</strong>의 <strong>재사용</strong>이 불가능 하다는 말과 같다.(잘못 설계하면, 코드 가독성이 떨어질 위험이 있다;;;)<p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// 즉시 실행 함수를 호출하는 두 가지 방법</span>
<span class="p">(</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

<span class="p">})(</span><span class="mi">1</span><span class="p">);</span>

<span class="p">(</span><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

<span class="p">}(</span><span class="mi">1</span><span class="p">));</span>
</code></pre></div></li>
<li><p>그 밖에 방법(<strong>표현식</strong>이 가능할 뿐 거의 사용되지는 않는다(특별한 경우가 아니라면, 사용하지 않는것이 좋다))</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="mi">1</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

  <span class="p">}(</span><span class="mi">1</span><span class="p">);</span>

  <span class="o">!</span><span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">y</span><span class="p">){</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
  <span class="p">}(</span><span class="mi">2</span><span class="p">);</span>         
</code></pre></div></li>
<li><p><span style="color:#c11f1f">IIFE</span> 응용</p>

<ul>
<li><p><span style="color:#6298c1">apply</span> 메서드를 통한 <span style="color:#6298c1">this</span> 값 초기화</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// global execution context</span>

    <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>

      <span class="c1">// function execution context</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// object Object</span>

    <span class="p">}).</span><span class="nx">apply</span><span class="p">({});</span>
</code></pre></div></li>
<li><p>JS Singleton 구현</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>

      <span class="c1">// 익명 함수 표현식 내부</span>
      <span class="c1">// function execution context</span>
      <span class="kd">var</span> <span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nx">$</span><span class="p">(){</span>

          <span class="c1">// $ 함수 선언식 내부</span>
          <span class="c1">// function execution context</span>

          <span class="c1">// 만약 instance 변수에 할당된 this 값이 있다면, 그 값을 반환한다.</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">instance</span><span class="p">)</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

          <span class="k">return</span> <span class="nx">instance</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">$</span><span class="p">;</span>

  <span class="p">}());</span>

  <span class="kd">var</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">$</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">$</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj1</span> <span class="o">===</span> <span class="nx">obj2</span><span class="p">);</span> <span class="c1">// ture</span>
</code></pre></div></li>
<li><p>JQuery Framework 구조생성</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>

        <span class="kd">function</span> <span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">init</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
        <span class="p">};</span>

        <span class="kd">function</span> <span class="nx">init</span><span class="p">(</span><span class="nx">selector</span><span class="p">){</span>

            <span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">elems</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">elems</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>

                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">n</span> <span class="k">in</span> <span class="nx">elems</span><span class="p">)</span> <span class="p">{</span>

                    <span class="kd">var</span> <span class="nx">elem</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">elem</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span> <span class="k">this</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span> <span class="o">=</span> <span class="nx">elems</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>
                <span class="p">};</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">};</span>

        <span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

            <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">){</span>

                <span class="nx">idx</span> <span class="o">=</span> <span class="nx">idx</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

                <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="nx">idx</span><span class="p">]</span> <span class="o">||</span> <span class="kc">undefined</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>

        <span class="nx">$</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ajax get&#39;</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ajax post&#39;</span><span class="p">);</span>
        <span class="p">};</span>

        <span class="k">return</span> <span class="nx">$</span><span class="p">;</span>

    <span class="p">})();</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">));</span> <span class="c1">// object Object</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// title elem</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="c1">// title elem</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;meta&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// meta elem</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;meta&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="c1">// meta elem</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// undefined</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="c1">// undefined</span>

    <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span> <span class="c1">// ajax get</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">();</span> <span class="c1">// ajax post</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>그룹화 연산자를 사용하지 않는 <span style="color:#c11f1f">IIFE</span></p>

<ul>
<li><p><span style="color:#c11f1f">FE</span> 는 반드시 <span style="color:#c11f1f">FE</span> 위치에 있어야 한다.</p>

<ul>
<li><p><span style="color:#c11f1f">FE</span> 가 <span style="color:#c11f1f">FE</span> 위치에 있을 경우, 파서는 <strong>실행 코드 처리시</strong>, 이것이 실행 가능하다는 것을 알고 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
    <span class="p">}(</span><span class="mi">1</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">B</span> <span class="o">=</span> <span class="p">{</span>

      <span class="c1">// 상황에 따른 초기화 값을 할당할때 유용하게 사용할 수 있다.</span>
      <span class="nx">x</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">y</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">B</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/javascript/2015/10/15/function-inJS/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
      <li>
          <header class="post-header">
            <h1 itemprop="name" class="post-title">
              <a itemprop="url" class="post-link" href="/blog/javascript/2015/10/14/vo-inJS/">Variable Object in JS</a>
            </h1>
            <div class="tags cf">
              
                <a href="/blog/search/?category=javascript">javascript</a>&nbsp;
              
              <time itemprop="datePublished" datetime="2015-10-14">
                Oct 14, 2015
              </time>
            </div>
        </header>

        <article style="position: relative; width: 100%; height: 400px; overflow-y: hidden; margin-bottom: 15px;">
          <ul>
<li><p>Variable 와 Execution Context 는 서로 밀접하게 관련되어있다.</p></li>
<li><p>JS 는 오직 Function Execution Context 내에서만 <strong>Isolated scope(격리된 유효범위)</strong> 을 가질 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// global variable of the global Execution Context</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="c1">// function Execution Context</span>
  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// local variable of the function Execution Context</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

<span class="c1">// 유효범위 밖의 접근은 허용하지 않는다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// Uncaught ReferenceError: y is not defined</span>
</code></pre></div>
<p><img src="https://www.dropbox.com/s/ayn343c6ow0kxy7/85.jpg?dl=1" alt=""></p></li>
<li><p>즉 JS 는 <strong>클래스 기반 언어</strong>인 C or C++ 처럼, 블럭 내부에 <span style="color:#c11f1f">Isolated scope</span>(격리된 유효범위) 를 가질 수 없다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="k">if</span> <span class="p">(</span><span class="mi">1</span><span class="p">){</span>
    <span class="c1">// not isolated scope</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// not isolated scope</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></li>
<li><p>Data declaration(데이터 선언)</p>

<ul>
<li> <strong>Variable Object</strong>(<span style="color:#c11f1f">VO</span>) 는 선언된 데이터(Variable, Function)들이 저장되는 <span style="color:#c11f1f">Special Object</span> 이다.</li>
<li><p>즉 우리가 <strong>변수</strong>나 <strong>함수</strong>를 선언하는 것은, <span style="color:#c11f1f">VO</span> 에 새로운 <strong>속성</strong>을 추가하는것과 <strong>동일</strong>하다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function Execution Context</span>

  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>

<ul>
<li><span style="color:#c11f1f">VO</span> 는 해당 Execution Context 의 속성으로 표현될 수 있다.<p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="c1">// Execution Context 진입 시 x 변수는 undefined 로 초기화되며, </span>
          <span class="c1">// A 함수는 Function Object 로 초기화된다.</span>
          <span class="nx">x</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span> 
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">];</span>
</code></pre></div></li>
<li><p>선언된 데이터의 종류</p>

<ul>
<li><strong>변수</strong> 선언(VariableDeclaration(<span style="color:#c11f1f">VD</span>))<p></li>
<li><strong>함수</strong> 선언(FunctionDeclaration(<span style="color:#c11f1f">FD</span>))<p></li>
<li><p><strong>함수 매개변수</strong>들(Function Formal Parameters)<p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// global Execution Context</span>
    <span class="c1">// 변수 선언</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// 함수 선언</span>
    <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">y</span><span class="p">){</span>

      <span class="c1">// function Execution Context</span>

      <span class="c1">// 함수 매개변수</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// undefined</span>

    <span class="p">}</span>

    <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// function execution context 내부 VO 는 AO(활성화 객체)가 그 역활을 대신한다.</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="c1">// 전달 받은 함수 매개변수들</span>
          <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
            <span class="mi">0</span><span class="o">:</span> <span class="kc">undefined</span>
          <span class="p">}</span>
          <span class="nx">y</span><span class="o">:</span> <span class="kc">undefined</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="c1">// 변수 선언식에 의한 초기화</span>
          <span class="nx">x</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span> 
          <span class="c1">// 함수 선언식에 의한 초기화</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span> 
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p><span style="color:#c11f1f">VO</span> in Global Execution Context</p>

<ul>
<li>Global Execution Context 의 <span style="color:#c11f1f">VO</span> 는 <strong>전역 객체</strong>를 가리킨다.<p></li>
<li><span style="color:#c11f1f">VO</span> 는 Global Execution Context <strong>진입 전에</strong> 생성되며, 프로그램 종료 시 <strong>소멸</strong>된다.</li>
<li><p><span style="color:#c11f1f">VO</span> 는 <span style="color:#6298c1">this</span> 키워드를 통해 접근가능하다.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151014/context_1.png" alt=""></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div>
<p><img src="https://www.dropbox.com/s/giabb54eg1tppkt/87.jpg?dl=1" alt=""></p></li>
<li><p><strong>전역 객체</strong>는 <strong>프로그램 레벨</strong>의 어떤한 곳에서도 접근 가능하다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global Execution Context</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

<span class="c1">// eval Execution Context</span>
<span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;console.log(this)&#39;</span><span class="p">);</span> <span class="c1">// global object</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function Execution Context</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="p">}</span>

<span class="nx">A</span><span class="p">();</span> <span class="c1">// called function object</span>
</code></pre></div></li>
<li><p><strong>전역 객체</strong>는 초기화 시 <span style="color:#6298c1">Math</span>, <span style="color:#6298c1">String</span>, <span style="color:#6298c1">Date</span>, <span style="color:#6298c1">parseInt</span> 등의 기본 <strong>속성</strong>들을 가지며, <u>자기 자신을 <strong>참조</strong>하는 속성인 <span style="color:#c11f1f">window</span> 속성</u>을 갖는다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nb">Math</span><span class="p">);</span> <span class="c1">// Math object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nb">String</span><span class="p">);</span> <span class="c1">// String function object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nb">parseInt</span><span class="p">);</span> <span class="c1">// parseInt function object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// global object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">);</span> <span class="c1">// global object</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">);</span> <span class="c1">// true</span>
</code></pre></div></li>
<li><p><strong>전역 객체</strong> 접근 시 <strong>접두사</strong> 생략이 가능하다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// global Execution Context</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// 접두사가 생략되었다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div></li>
</ul></li>
<li><p><span style="color:#c11f1f">AO</span>(VO) in Function Execution Context</p>

<ul>
<li><p>Function Execution Context 내부 <span style="color:#c11f1f">VO</span> 는 <u><strong>직접적인 접근</strong>이 불가능하며</u>, 활성화 객체(<span style="color:#c11f1f">AO</span>)가 이 역활을 대신한다.</p>

<ul>
<li><p>Activation Object(<span style="color:#c11f1f">AO</span>)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">Execution</span> <span class="nx">Context</span> <span class="nx">VO</span> <span class="o">===</span> <span class="nx">AO</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151014/context_1.png" alt=""></p></li>
</ul></li>
<li><p><span style="color:#c11f1f">AO</span> 는 <strong>함수 호출</strong> 후 Function Execution Context 로 진입 시 <strong>생성</strong>되며, 함수 종료시 <strong>소멸</strong>된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// global Execution Context</span>

    <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">y</span><span class="p">){</span>

      <span class="c1">// function Execution Context</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// undefined</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="c1">// undefined</span>

    <span class="p">}</span>

    <span class="c1">// A 함수를 호출한다.</span>
    <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
      <span class="c1">// 함수 호출 시 function execution context 가 생성된다. </span>
      <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="c1">// 함수 매개변수들</span>
          <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
            <span class="mi">0</span><span class="o">:</span> <span class="kc">undefined</span>
          <span class="p">}</span>
          <span class="nx">y</span><span class="o">:</span> <span class="kc">undefined</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span> <span class="c1">// 함수 선언식을 통해 함수 객체로 초기화된다.</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">];</span>
</code></pre></div></li>
<li><p>arguments 객체 프로퍼티</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// arguments object</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>

    <span class="c1">// 선언된 매개변수의 수</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 3</span>

    <span class="c1">// 실제 전달된 매개변수의 수</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 2</span>

    <span class="c1">// 함수 자신에 대한 참조</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span> <span class="o">===</span> <span class="nx">A</span><span class="p">);</span> <span class="c1">// true</span>

    <span class="c1">// 전달된 매개변수와 arguments object 속성은 서로 공유된다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// true</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 10</span>

    <span class="c1">// arguments object 속성을 변경한다.</span>
    <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 20</span>

    <span class="nx">x</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// 30</span>

    <span class="c1">// 하지만 함수 호출 시 전달되지 않았던, 매개변수 z 속성은 공유되지 않는다.</span>
    <span class="nx">z</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span> <span class="c1">// undefined</span>

    <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">z</span><span class="p">);</span> <span class="c1">// 40</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span> <span class="c1">// call function object</span>
</code></pre></div></li>
</ul></li>
<li><p>Execution Context <strong>진입</strong> 및 <strong>실행 코드 처리</strong> 과정</p>

<ul>
<li><p>Execution Context 안의 <strong>코드 실행</strong>은 두 가지 <u>기본적인 <strong>단계</strong></u>로 나뉜다.</p>

<ul>
<li>Execution Context <strong>진입 과정</strong><p></li>
<li>Execution Context 진입 후 <strong>실행 코드 처리</strong> 과정</li>
</ul></li>
<li><p>Execution Context <strong>진입 과정</strong></p>

<ul>
<li><p>Execution Context 진입 시(<strong>실행 코드가 처리</strong> 전) <span style="color:#c11f1f">VO</span> 의 새로운 <strong>속성</strong>들이 추가된다.</p>

<ul>
<li><p>변수 선언(VariableDeclaration(<span style="color:#c11f1f">VD</span>))</p>

<ul>
<li><p><strong>undefined</strong> 로 <strong>초기화</strong>되는 <span style="color:#c11f1f">VO</span> 의 새로운 <strong>속성</strong>이 추가된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// Execution Context 진입 시점</span>
  <span class="c1">// undefined 로 초기화된다</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// undefined</span>

  <span class="c1">// 변수 선언</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// 실행 코드 처리 후</span>
  <span class="c1">// 값이 할당된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1 </span>
</code></pre></div></li>
<li><p>Execution Context 진입 시 <span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="kc">undefined</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">];</span>
</code></pre></div></li>
<li><p>동일한 이름의 <strong>변수 선언</strong>이 이미 존재할 경우 그 아래의 <strong>함수 선언</strong>은 <strong>무시</strong>된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// 이 경우 x 는 undefined 가 아닌, function object 로 초기화된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// x function object</span>

  <span class="c1">// 변수 선언</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// 동일한 이름으로 함수 선언을 한다.</span>
  <span class="kd">function</span> <span class="nx">x</span><span class="p">(){</span>
  <span class="p">};</span>

  <span class="c1">// 동일한 이름의 함수 선언은 무시된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
</code></pre></div>
<p><img src="http://mohwa.github.io/blog/assets/images/posts/20151014/context_2.png" alt=""></p></li>
</ul></li>
<li><p>함수 선언(FunctionDeclaration(<span style="color:#c11f1f">FD</span>))</p>

<ul>
<li><p><strong>함수 객체</strong>로 <strong>초기화</strong>되는 <span style="color:#c11f1f">VO</span> 의 새로운 <strong>속성</strong>이 추가된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global Execution Context</span>

<span class="c1">// Execution Context 진입 시 function object 로 초기화된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// function object</span>

<span class="c1">// 함수 선언식</span>
<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="c1">// function Execution Context</span>
<span class="p">}</span>
</code></pre></div></li>
<li><p>Execution Context 진입 시 <span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
  <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span><span class="o">&gt;</span> <span class="c1">// 함수 선언식을 통한 함수는 function object 로 초기화된다.</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>함수 매개변수들(Function Formal parameters)</p>

<ul>
<li><p>전달된 <strong>매개변수 값</strong>을 갖는 <span style="color:#c11f1f">VO</span> 의 새로운 속성이 추가된다. 단 값이 <u>전달되지 않았을경우</u>, <strong>undefined</strong> 로 <strong>초기화</strong>된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// 함수 선언식</span>
  <span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">){</span>

    <span class="c1">// function Execution Context</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// 1</span>
    <span class="c1">// 값이 전달되지 않은 매개변수는 undefined 로 초기화된다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="c1">// undefined</span>
  <span class="p">}</span>

  <span class="c1">// A 함수를 호출한다.</span>
  <span class="nx">A</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> 
</code></pre></div><div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// function parameters</span>
        <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
          <span class="mi">0</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="mi">1</span><span class="o">:</span> <span class="kc">undefined</span>
        <span class="p">}</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">y</span><span class="o">:</span> <span class="kc">undefined</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>Execution Context 진입 후 <strong>실행 코드 처리 과정</strong></p>

<ul>
<li><p>Execution Context 진입 시점에서 초기화된 <span style="color:#c11f1f">VO</span> 속성은 <strong>실행 코드 처리 후</strong> 할당된 값을 가지게 된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// Execution Context 진입 시점: undefined 로 초기화된다.</span>
  <span class="c1">// 실행 코드 처리 후: 1 이 할당된다.</span>

  <span class="c1">// 변수 선언</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></li>
<li><p><strong>실행 코드 처리 후</strong> <span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p><span style="color:#c11f1f">VO</span> in Eval Execution Context</p>

<ul>
<li><p><span style="color:#6298c1">eval</span> 함수에서는 <span style="color:#c11f1f">Calling Context</span> 라는 <strong>개념</strong>이 존재하며, 이것은 <u><span style="color:#6298c1">eval</span> 함수가 <strong>호출</strong>된 Execution Context 를 가리킨다.</u><p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// eval 함수가 global execution context 내부에서 호출되었다.</span>
  <span class="c1">// 즉 calling context 는 global execution context 를 가리킨다.</span>
  <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;var x = 1;&#39;</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

     <span class="c1">// function execution context</span>

     <span class="c1">// eval 함수가 function execution context 내부에서 호출되었다.</span>
     <span class="c1">// 즉 calling context 는 function execution context 를 가리킨다.</span>
     <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;var y = 2;&#39;</span><span class="p">);</span>

     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#6298c1">eval</span>  함수를 통해, 선언된 <strong>변수</strong>, <strong>함수</strong>는 Calling Context 내부 <span style="color:#c11f1f">VO</span> 에 영향을 준다.(즉 Calling Context 내부 <span style="color:#c11f1f">VO</span> 의 속성으로 할당된다)<p></p></li>
<li><p><span style="color:#6298c1">eval</span> 함수로 전달된 <strong>실행 코드</strong>는 생성된 Eval Execution Context 내부에서 처리된다.<p> </p></li>
<li><p>해당 <span style="color:#c11f1f">VO</span> 는 Eval Execution Context 진입 시 <strong>생성</strong>되며, <span style="color:#6298c1">eval</span> 함수 종료 시 <strong>소멸</strong>된다.</p>

<ul>
<li><p>Global Execution Context 에서의 <span style="color:#6298c1">eval</span> 함수</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global Execution Context</span>

  <span class="c1">// calling context 는 global execution context 를 가리킨다.</span>

  <span class="c1">// eval 함수를 통해 생성된 x 속성은 해당 calling context 내부 VO 에 영향을 준다.</span>
  <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;var x = 1&#39;</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1        </span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">evalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">}</span> 
    <span class="p">},</span>                
    <span class="nx">callingContext</span><span class="o">:</span> <span class="nx">globalExecutionContext</span><span class="p">,</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// eval 함수로 전달된 실행 코드로 인해, calling context 내부 VO 가 영향받는다.</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
<li><p>Function Execution Context 에서의 <span style="color:#6298c1">eval</span> 함수</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">()</span> <span class="p">{</span>

      <span class="c1">// function execution context</span>

      <span class="c1">// calling context === function execution context</span>

      <span class="c1">// x 지역 변수르 선언한다.</span>
      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

      <span class="c1">// eval 함수를 통해, 변수를 선언한다.</span>
      <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;var y = 2;&#39;</span><span class="p">);</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

      <span class="c1">// y 속성은 calling context 내부 VO 에 영향을 준다.</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>      
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">evalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">}</span>              
    <span class="p">},</span>                
    <span class="c1">// 호출 문맥</span>
    <span class="nx">callingContext</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">,</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>            
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="c1">// eval 함수로 전달된 실행 코드로 인해, calling context 내부 VO 가 영향받는다.</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><p>단 <strong>ES5</strong> <span style="color:#c11f1f">strict-mode</span> 에서의 <span style="color:#6298c1">eval</span> 함수는 Calling Context 내부 <span style="color:#c11f1f">VO</span> 에 영향을 주지 않으며, 코드를 <strong>지역 샌드박스</strong>(local sandbox)에서 평가하게된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

  <span class="c1">// global Execution Context</span>

  <span class="c1">// calling context 는 global Execution Context 를 가리킨다.</span>

  <span class="c1">// x 변수를 선언한다.</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// eval 함수를 통해, 선언된 변수는 해당 calling context 에 영향을 주지않으며, local sandbox 안에서 평가하게된다.</span>
  <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;var y = 2;&#39;</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>

  <span class="c1">// calling context 내부 VO 에 영향을 주지 않는다.</span>
  <span class="c1">// local sandbox 외부에서 y 속성을 접근할 수 없다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// Uncaught ReferenceError: y is not defined</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">// local sand box</span>
    <span class="nx">evalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="c1">// 호출 문맥</span>
    <span class="nx">callingContext</span><span class="o">:</span> <span class="nx">globalExecutionContext</span><span class="p">,</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// y 속성이 추가되지 않았다(즉 해당 calling context 내부 VO 에 영향을 주지 않는다)</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div>
<h2 id="url">참고 URL</h2></li>
</ul></li>
<li><p><a href="http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/">ECMA-262-3 IN DETAIL. CHAPTER 2. VARIABLE OBJECT</a></p></li>
<li><p><a href="http://huns.me/development/189">ECMA-262-3 IN DETAIL. CHAPTER 2. VARIABLE OBJECT 번역 글</a></p></li>
<li><p><a href="http://www.nextree.co.kr/p4150/">Javascript : 함수(function) 다시 보기</a></p></li>
<li><p><a href="http://javascriptweblog.wordpress.com/2010/08/09/variables-vs-properties-in-javascript/">Variables vs. Properties in JavaScript</a></p></li>
<li><p><a href="https://gist.github.com/Integralist/1525419">JavaScript Execution</a></p></li>
<li><p><a href="https://msdn.microsoft.com/ko-kr/library/br230269(v=vs.94).aspx">Strict 모드</a>  </p></li>
</ul>

        </article>
        <p style="text-align: right"><a href="/blog/javascript/2015/10/14/vo-inJS/">Read more</a></p>
        <hr style="margin-bottom:30px; border:0; border-bottom: 1px dotted #ccc;" />
    </li>
  
  </ul>
</section>
<section class="pagination">
  <!-- Pagination links -->
  <ul class="pagination clearfix">
    
    
    <li><a href="/blog/">Prev</a></li>
    
    
    
    <li><a href="/blog/">1</a></li>
    
    
    
    <li><span class="active">2</span></li>
    
    
    
    <li><a href="/blog/page3">3</a></li>
    
    
    
    <li><a href="/blog/page3">Next</a></li>
    
</ul>

</section>

      <div class="separator"></div>
    </div>
  </div>
  <footer>
    <section>
  <ul class="links">
      <li><a href="https://twitter.com/yanione" title="follow me" target="_blank"><i class="icon-twitter"></i></a></li>
      <li><a href="https://github.com/mohwa" title="github page" target="_blank"><i class="icon-github"></i></a></li>
  </ul>
<section>

  </footer>
  <script>
    <!-- Google Analytics -->
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-30470280-2', 'auto');
    ga('send', 'pageview');

    // include jekyll full text search
    // https://github.com/christian-fei/Simple-Jekyll-Search
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('results-container'),
      json: '/blog/search.json',
      searchResultTemplate: '<li><a href="{href}">{title}</a>&nbsp;&nbsp;&nbsp;{date}</li>',
      noResultsText: 'No results found'
    });

  </script>
  <script src="http://b.readtrend.com/j/s.js"></script>
</body>
</html>
