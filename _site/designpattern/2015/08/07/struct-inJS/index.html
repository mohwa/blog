<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!-- viewport 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- keyword 설정 -->
    <meta name="keywords" content="designpattern">
    <!-- description 설정 -->
    <meta name="description" content="JavaScript 를 활용한 구조체 구현" />

    <!-- open graph 설정 -->
    <meta property="og:type" content="mohwa blog">
    <meta property="og:title" content="Struct in JS">
    <meta property="og:description" content="JavaScript 를 활용한 구조체 구현">
    <!--<meta property="og:image" content="http://mysite.com/myimage.jpg">-->
    <meta property="og:url" content="/blog">

    <meta name="copyright" content="by mohwa" />

    <!--<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />-->

    <!-- google search console 설정 -->
    <link rel="alternate" hreflang="ko" href="http://mohwa.github.io" />
    <link rel="alternate" hreflang="ko" href="https://mohwa.github.io" />

    <link rel="stylesheet" href="/blog/assets/css/site.css" />
    <link rel="stylesheet" href="/blog/bower_components/highlightjs/styles/darkula.css">

    <script src="/blog/bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/highlightjs/highlight.pack.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/purl/purl.js" type="text/javascript"></script>
    <!-- Script pointing to jekyll-search.js -->
    <script src="/blog/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>

    <title>Struct in JS</title>

    <script type="text/javascript">

        // code highlight 적용
        // https://highlightjs.org/static/demo/
        $(document).ready(function() {
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
    </script>
</head>

<body>

  <div class="top-bar"></div>

  <div class="container">
    <div class="site">
      <header>
        <nav>
    <span style="float:left;">
        <a class="" href="/blog/">Home</a>
        <!--<a class="" href="/archive/">전체글</a>-->
        <!--<a class="" href="//github.com/nolboo/nolboo.github.io/wiki">번역글 위키</a>-->
    </span>
    <span style="float:right;">
        <div id="search-container" class="search-container">
            <input type="text" id="search-input" class="search-input" placeholder="search...">
        </div>
    </span>
</nav>

        <div class="pull-right right logo">
          <div class="name"></div>
          <!--<a href="/feed.xml"><img class="avatar" src="/images/rss.jpg" alt="RSS" /></a>-->
        </div>
      </header>
      <div class="separator"></div>
      <ul id="results-container" class="results-container"></ul>
      <article>
  <h1>
    Struct in JS
  </h1>
  <div class="center">
    <p class="meta">07 Aug 2015</p>
  </div>



  <div class="post">
  <h2 id="1">1. 정의</h2>

<ul>
<li><p>C 와 C++(또는 C# 등) 에서 <strong>구조화 된 데이터</strong>를 처리할 때, <strong>Struct</strong> 를 사용하는데 이를 <a href="https://ko.wikipedia.org/wiki/Struct">구조체</a>라 부른다.</p>

<ul>
<li><p>최초의 <strong>구조체</strong>는 C 언어에서 다양한 <strong>자료구조</strong>를 하나의 <strong>집합</strong>으로 만들어 <strong>관리</strong>하기위해 만들어졌다.</p>

<ul>
<li>구조체는 하나 이상의 <strong>자료구조</strong>를 가진 또 하나의 <strong>데이터 타입</strong>을 정의한다.</li>
</ul></li>
<li><p>이 글은 <strong>구조체</strong>를 다루는 여러 언어 중 <code>[C# 구조체]</code> 를 기준으로 하고있다.</p></li>
</ul>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/struct_diagram.jpg?2" alt="">
- 코드화</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">public</span> <span class="nx">struct</span> <span class="nx">Song</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="kr">int</span> <span class="nx">lengthInSeconds</span><span class="p">,</span> <span class="nx">yearRecorded</span><span class="p">;</span>

    <span class="c1">// 생성자</span>
    <span class="kr">public</span> <span class="nx">Song</span><span class="p">(</span><span class="kr">int</span> <span class="nx">p1</span><span class="p">,</span> <span class="kr">int</span> <span class="nx">p2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">lengthInSeconds</span> <span class="o">=</span> <span class="nx">p1</span><span class="p">;</span>
        <span class="nx">yearRecorded</span> <span class="o">=</span> <span class="nx">p2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">TestSong</span>
<span class="p">{</span>
    <span class="kr">static</span> <span class="k">void</span> <span class="nx">Main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Initialize:</span>
        <span class="c1">// 생성된 객체는 Stack 메모리에 객체가 할당된다.</span>
        <span class="nx">Song</span> <span class="nx">song1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Song</span><span class="p">(</span><span class="mi">213</span><span class="p">,</span> <span class="mi">1994</span><span class="p">);</span>
        <span class="nx">Song</span> <span class="nx">song2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Song</span><span class="p">(</span><span class="mi">248</span><span class="p">,</span> <span class="mi">1988</span><span class="p">);</span>

        <span class="c1">// Display results:</span>
        <span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;lengthInSeconds = {0}, yearRecorded = {1}&quot;</span><span class="p">,</span> <span class="nx">song1</span><span class="p">.</span><span class="nx">lengthInSeconds</span><span class="p">,</span> <span class="nx">song1</span><span class="p">.</span><span class="nx">yearRecorded</span><span class="p">);</span>

        <span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;lengthInSeconds = {0}, yearRecorded = {1}&quot;</span><span class="p">,</span> <span class="nx">song2</span><span class="p">.</span><span class="nx">lengthInSeconds</span><span class="p">,</span> <span class="nx">song2</span><span class="p">.</span><span class="nx">yearRecorded</span><span class="p">);</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* Output:</span>
<span class="cm">    lengthInSeconds = 213, yearRecorded = 1994</span>
<span class="cm">    lengthInSeconds = 248, yearRecorded = 1988</span>
<span class="cm">*/</span>
</code></pre></div>
<ul>
<li><p><strong>구조체</strong>는 <strong>Class</strong> 와 같이 여러 특성(생성자, 상수, 필드, 메서드, 속성, 인덱서, 연산자, 이벤트 등)들을 <strong>그룹화</strong> 하는데 사용된다.</p>

<ul>
<li><strong>구조체</strong>와 <strong>클래스</strong>는 매우 비슷한 <strong>구조</strong>를 가지고 있으며, <u><strong>사용 방법</strong> 및 <strong>적용 이유</strong></u>가 유사하다.</li>
</ul></li>
</ul></li>
</ul>

<h2 id="2-c">2. C# 구조체의 특징</h2>

<ul>
<li><p><code>값 타입</code>이다.</p>

<ul>
<li><a href="https://msdn.microsoft.com/ko-kr/library/4d43ts61(v=vs.90).aspx">값 형식 및 참조 형식</a></li>
<li><p>[Six important .NET concepts: Stack, heap, value types, reference types, boxing, and unboxing]</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/memoryDiagram.jpg?2" alt=""></p>

<ul>
<li><a href="http://www.codeproject.com/Articles/76153/Six-important-NET-concepts-Stack-">http://www.codeproject.com/Articles/76153/Six-important-NET-concepts-Stack-</a></li>
</ul></li>
</ul></li>
<li><p>생성된 객체는 <strong>Stack</strong> 메모리에 할당된다.</p></li>
<li><p><strong>구조체</strong>는 보통 <u>작은 데이터</u>를 다루는데 <strong>적합</strong>하다.</p>

<ul>
<li><p>하지만 <strong>이것</strong>을 <strong>클래스</strong>로 <span style="color:#c11f1f">표현할 수 없는 것</span>은 아니다.(그냥 작은 Class를 만들면 그만이다;;)</p>

<ul>
<li><em>그럼에도 불구하고 <code>구조체</code>를 써야하는 이유는 <u>분명 존재</u>할 것이다.</em></li>
</ul></li>
</ul></li>
<li><p><strong>new</strong> 연산자를 사용하지 않고도 <strong>인스턴스화</strong>할 수 있다.</p>

<ul>
<li>하지만 <u><strong>생성자</strong>를 호출하지 않으므로</u>, 선언된 맴버를 따로 <strong>초기화</strong> 해야하는 <span style="color:#c11f1f">불편함</span>이 존재한다.</li>
</ul>
<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="k">public</span> <span class="k">struct</span> <span class="nc">Song</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">lengthInSeconds</span><span class="p">,</span> <span class="n">yearRecorded</span><span class="p">;</span>

    <span class="c1">// 생성자</span>
    <span class="k">public</span> <span class="nf">Song</span><span class="p">(</span><span class="kt">int</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">lengthInSeconds</span> <span class="p">=</span> <span class="n">p1</span><span class="p">;</span>
        <span class="n">yearRecorded</span> <span class="p">=</span> <span class="n">p2</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">TestSongNoNew</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// new 연산자 없이 인스턴스를 생성한다.</span>
        <span class="c1">// Stack 메모리에 객체가 할당된다.</span>
        <span class="c1">// 생성자를 호출하지 않는다.</span>
        <span class="n">Song</span> <span class="n">song1</span><span class="p">;</span>

        <span class="c1">// 속성 초기화</span>
        <span class="n">song1</span><span class="p">.</span><span class="n">lengthInSeconds</span> <span class="p">=</span> <span class="m">213</span><span class="p">;</span>
        <span class="n">song1</span><span class="p">.</span><span class="n">yearRecorded</span> <span class="p">=</span> <span class="m">1994</span><span class="p">;</span>

        <span class="c1">// Display results:</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;lengthInSeconds = {0}, yearRecorded = {1}&quot;</span><span class="p">,</span> <span class="n">song1</span><span class="p">.</span><span class="n">lengthInSeconds</span><span class="p">,</span> <span class="n">song1</span><span class="p">.</span><span class="n">yearRecorded</span><span class="p">);</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* Output:</span>
<span class="cm">    lengthInSeconds = 213, yearRecorded = 1994</span>
<span class="cm">*/</span>
</code></pre></div></li>
<li><p><strong>구조체</strong>는 <strong>구조체</strong> 또는 <strong>클래스</strong>에서 <u>상속될 수 없으며</u>, 클래스의 기본 클래스가 될 수 없다.</p>

<ul>
<li><strong>클래스</strong>와 달리, 상속 구조를 구현할 수 없다.</li>
</ul></li>
<li><p><strong>클래스</strong>와 같이 <u><strong>인터페이스</strong>를 구현할 수 있다.</u></p></li>
<li><p>구조체는 <strong>Stack</strong> 영역에 할당되는 <strong><span style="color:#c11f1f">값 타입</span></strong>이고, 클래스는 <strong>Heap</strong> 영역에 할당되는 <strong><span style="color:#c11f1f">참조 타입</span></strong>이다.</p>

<ul>
<li><p><strong>Stack</strong> 영역(<span style="color:#c11f1f">정적 할당</span>)이란?</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/struct_stack.jpg" alt=""></p></li>
<li><p><strong>Stack</strong> 영역은 <strong>컴파일 시점</strong>에서 크기가 <strong>결정</strong>되는 요소들이 저장되는 <strong>메모리 영역</strong>이다.</p>

<ul>
<li>함수 내부 <strong>지역 변수</strong> 와 <strong>매개 변수</strong>는 <strong>Stack</strong> 영역에 할당되며, 함수 종료 시 <strong>소멸</strong>된다.</li>
</ul></li>
<li><p><strong>Stack</strong> 영역은 <strong>LIFO</strong>(Last In First out)라는 <strong>자료구조</strong> 가진다.</p>

<ul>
<li><p><em>즉 마지막에 넣은(Push) 데이터가 <code>가장 먼저</code> 나가는것을(Pop) 의미한다.</em></p>

<ul>
<li><p>Stack Push 순서:</p>

<ul>
<li>A &gt; B &gt; C &gt; D &gt; E</li>
</ul></li>
<li><p>Stack Pop 순서:</p>

<ul>
<li>E &gt; D &gt; C &gt; B &gt; A</li>
</ul></li>
</ul></li>
<li><p>그럼 <strong>JS Stack</strong> 은?</p>

<ul>
<li><p>JS 는 <a href="https://ko.wikipedia.org/wiki/%EB%8F%99%EC%A0%81_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%EC%96%B8%EC%96%B4"><strong>동적 언어</strong></a> 이므로 <strong>컴파일 시점</strong>이 아닌 <strong>런타임 시점</strong>에서 메모리가 <strong>할당</strong>(allocation)된다.</p>

<ul>
<li>C, C++, C#(<strong>정적 언어</strong>)</li>
</ul></li>
<li><p>JS <strong>원시 타입</strong>(string, number, boolean, undefined, null)은 <strong>고정된 크기</strong>를 가지며, <strong>Stack</strong> 메모리 영역에 할당된다.</p></li>
<li><p>JS 의 모든 <strong>실행 컨텍스트</strong>는 <span style="color:#c11f1f">ECStack</span>(일종의 <a href="https://ko.wikipedia.org/wiki/%EC%BD%9C_%EC%8A%A4%ED%83%9D">Call Stack</a>) 내부로 할당된다.</p>

<ul>
<li><p>아래와 같은 방법으로 <code>ECStack Count</code> 를 셀 수 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">getStackCount</span><span class="p">(){</span>

    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">try</span><span class="p">{</span>
        <span class="p">(</span><span class="kd">function</span> <span class="nx">_stack</span><span class="p">(){</span>

            <span class="o">++</span><span class="nx">i</span> <span class="o">&amp;&amp;</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">callee</span><span class="p">();</span>
        <span class="p">})();</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// get call stack count</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;call stack count: &#39;</span> <span class="o">+</span> <span class="nx">getStackCount</span><span class="p">());</span>

<span class="cm">/* output</span>

<span class="cm"> Maximum call stack size exceeded</span>

<span class="cm"> // 15,745 번 함수 호출 후 Stack overflow 가 발생했다.</span>
<span class="cm"> call stack count: 15745</span>

<span class="cm"> */</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Heap</strong> 영역(<span style="color:#c11f1f">동적 할당</span>)이란?</p>

<ul>
<li><p><strong>Heap</strong> 영역은 <strong>런타임 시점</strong>에서 크기가 <strong>결정</strong>되는 요소들이 저장되는 <strong>메모리 영역</strong>이다.</p>

<ul>
<li>Object 또는 Array Data Type 등을 가진다.</li>
</ul></li>
<li><p><strong>Heap</strong> 영역은 <strong>런타임 시점</strong>에서 메모리를 <u><strong>가변적</strong>으로 <strong>동적</strong> <span style="color:#c11f1f">할당</span> 및 <span style="color:#c11f1f">반환</span>(GC를 통해) 시키는 구조</u>를 가진다.</p></li>
<li><p><strong>GC</strong>는 <strong>할당</strong>된 <strong>Heap</strong> 메모리 영역의 <span style="color:#c11f1f">반환</span>(de-allocated(수거))을 담당한다.</p>

<ul>
<li><p><strong>GC</strong>(Garbage Collection)란?</p>

<ul>
<li><strong>자동 메모리 관리</strong>의 한 형태이며, 프로세스 수행 중, 더 이상 필요가 없어진 <strong>객체</strong>가 점유하는 <u>메모리에 대해 <span style="color:#c11f1f">반환</span> 작업을 수행</u>한다.</li>
<li>프로그래머가 직접 메모리를 <span style="color:#c11f1f">반환</span>할 수는 없다.(반드시 <code>GC</code>를 통해 반환된다)</li>
<li><p>단 GC에게 메모리 <u><strong>반환</strong> 조건</u>을 만들어 줄 수는 있다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>

<span class="c1">// GC에게 메모리 반환 조건을 만들어 준다.</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>JS <strong>Heap</strong> 메모리 영역 테스트 해보기!!</p>

<ul>
<li><p>V8 <strong>Handle scope</strong> Diagram</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/handleV8.jpg" alt=""></p></li>
<li><p>아래 코드는 <strong>Heap</strong> 메모리 영역에 <strong>객체</strong>를 <span style="color:#c11f1f">할당</span>하는 예제이다.</p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// 전역 실행 컨텍스트에서 함수 객체를 하나 선언한다.</span>

<span class="c1">// 선언된 함수 객체는 Heap 메모리 영역에 할당된다.</span>
<span class="kd">function</span> <span class="nx">globalA</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">init</span><span class="p">(){</span>

    <span class="c1">// _global 전역 변수에 생성된 인스턴스를 할당한다.</span>
    <span class="c1">// 이때 전역 변수(참조 변수)는 Heap 메모리 영역에 할당된 객체를 참조하게된다.</span>

    <span class="nx">_global</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">globalA</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">init</span><span class="p">();</span>
</code></pre></div>
<ul>
<li><p><strong>전역 실행 컨텍스트</strong>에서 선언된 <strong>globalA</strong> 함수 객체의 <strong>Heap</strong> 메모리 영역.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/heapSnapShot0.jpg" alt=""></p></li>
<li><p><strong>_global</strong> 전역 변수가 참조하는 <strong>객체</strong>의 <strong>Heap</strong> 메모리 영역.</p>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/heapSnapShot1.jpg" alt=""></p></li>
<li><p><span style="color:#c11f1f">Chrome Inspector</span>를 통해 할당된 <strong>Heap 메모리 영역</strong>을 살펴볼 수 있다.</p>

<ul>
<li><a href="http://stackoverflow.com/questions/20697298/understanding-chrome-heap-profile">understanding chrome heap profile</a></li>
</ul></li>
<li><p>만약 함수 <strong>지역 변수</strong>에 <strong>객체</strong>를 할당했다면, 그 객체(<strong>Heap</strong> 영역)의 메모리 <strong><span style="color:#c11f1f">반환</span></strong> <strong>시점</strong>은 언제일까?</p>

<ul>
<li><p><em>결론: <code>지역 변수</code>에 할당된 객체 메모리 <span style="color:#c11f1f">반환</span> 시점은 <u></em><em>함수 종료 시점</em><em></u>이 된다.</em></p>

<ul>
<li><p>테스트 1: <code>전역 변수</code>와 함수 <code>지역 변수</code>에 동일한 <code>객체</code>를 할당해본 후 <code>Profile</code> 을 통해 <code>Heap</code> 영역을 관찰해본다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// 전역 실행 컨텍스트에서 함수 객체를 하나 선언한다.</span>

<span class="c1">// 선언된 함수 객체는 Heap 메모리 영역에 할당된다.</span>
<span class="kd">function</span> <span class="nx">globalA</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">init</span><span class="p">(){</span>

    <span class="c1">// _district 지역 변수에 생성된 인스턴스를 할당한다.</span>
    <span class="c1">// 이때 지역 변수(참조 변수)는 Heap 메모리 영역에 할당된 객체를 참조하게된다.</span>

    <span class="c1">// 단 지역 변수에 할당된 객체의 &quot;메모리 반환 시점&quot;은, 함수 종료 시점(함수 실행 컨텍스트 종료 시점)이 된다.</span>

    <span class="kd">var</span> <span class="nx">_district</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">globalA</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">init</span><span class="p">();</span>
</code></pre></div></li>
<li><p><code>지역 변수</code>에 할당된 <code>객체</code>는 <code>Heap</code> 메모리 영역에서 <span style="color:#c11f1f">반환</span>되어 보이지 않는다.</p></li>
</ul>

<p><img src="http://mohwa.github.io/blog/assets/images/posts/heapSnapShot2.jpg" alt=""></p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h2 id="3-js-struct">3. JS 로 Struct 구현해보기</h2>

<ul>
<li><p>위에서 나열한 <strong>구조체</strong>의 <strong>특징</strong> 중 <strong>클래스</strong>와 <strong>본질</strong>적으로 다른 부분인, <u><strong>데이터 생성</strong></u>에 대한 부분을 JS 를 통해 구현해 보았다.</p>

<ul>
<li>구조체: <strong>값</strong> 타입(<strong>Stack</strong> 메모리 영역에 할당되며, 값이 <span style="color:#c11f1f">복사</span>되어 할당된다)</li>
<li>클래스: <strong>참조</strong> 타입(<strong>Heap</strong> 메모리 영역에 할당되며, <span style="color:#c11f1f">참조</span> 값이 할당된다)</li>
</ul></li>
<li><p><code>구조체</code>의 특징 중 극히 일부를 구현한것이며, 타 언어에서 구현된 구조체라 할 수는 없다.</p></li>
</ul>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">Struct</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">||</span>
        <span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span> <span class="o">||</span>
        <span class="k">typeof</span> <span class="nx">val</span> <span class="o">===</span> <span class="s1">&#39;boolean&#39;</span> <span class="o">||</span>
        <span class="nx">val</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span>
        <span class="nx">val</span> <span class="o">===</span> <span class="kc">undefined</span>
    <span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;primitive type value: &#39;</span> <span class="o">+</span> <span class="nx">val</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">_copy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>

        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">constructor</span> <span class="o">=</span> <span class="nx">val</span><span class="p">.</span><span class="nx">constructor</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Function</span><span class="p">){</span>

            <span class="c1">// 함수(상황에 따라 생성자 함수가 될 수도 있다) 객체 내부 this 값을 apply 함수를 통해 초기화 시키고, 그 결과를 반환하는 함수를 생성한다.</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">$F</span><span class="p">(){</span>

                <span class="c1">// this === global or $F of instance object</span>
                <span class="k">return</span> <span class="nx">val</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="p">};</span>

            <span class="c1">// 전달된 함수 객체의 prototype(객체 원형)을 할당한다.</span>
            <span class="nx">ret</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">val</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">String</span> <span class="o">||</span> <span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Number</span> <span class="o">||</span> <span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Boolean</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">constructor</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Date</span><span class="p">){</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">constructor</span><span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">getTime</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Object</span> <span class="o">||</span> <span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Array</span><span class="p">){</span>

            <span class="nx">ret</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">constructor</span><span class="p">();</span>

            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">n</span> <span class="k">in</span> <span class="nx">val</span><span class="p">){</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">n</span><span class="p">)){</span>
                    <span class="nx">ret</span><span class="p">[</span><span class="nx">n</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">[</span><span class="nx">n</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>

    <span class="p">}(</span><span class="nx">val</span><span class="p">)</span> <span class="o">||</span> <span class="nx">val</span><span class="p">;</span>


    <span class="k">return</span> <span class="nx">_copy</span><span class="p">;</span>
<span class="p">}</span>

    <span class="c1">// 5 가지의 원시 타입 값 할당</span>
<span class="nx">Struct</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span> <span class="c1">// test</span>
<span class="nx">Struct</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="nx">Struct</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// true</span>
<span class="nx">Struct</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span> <span class="c1">// undefined</span>
<span class="nx">Struct</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span> <span class="c1">// null</span>

<span class="cm">/*</span>
<span class="cm">    모든 경우(모든 타입)에 전달된 원본 값(객체)이 아닌 복사 된 값을 반환한다.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm"> 함수 객체 선언</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">$$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">$$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">_$$</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">_$$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// 나를통해 생성될 객체 원형에 새로운 객체를 할당한다.</span>
    <span class="nx">_$$</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">getX</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">$$</span><span class="p">.</span><span class="nx">staticMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>

    <span class="k">return</span> <span class="nx">$$</span><span class="p">;</span>
<span class="p">}();</span>

<span class="cm">/*</span>
<span class="cm"> 다른 유형의 함수 객체 선언</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">Plus</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">){</span>

    <span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">return</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">originalFn</span> <span class="o">=</span> <span class="nx">$$</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">structFn</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="nx">$$</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">originalFn</span><span class="p">);</span> <span class="c1">// function</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structFn</span><span class="p">);</span> <span class="c1">// function</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">originalFn</span><span class="p">());</span> <span class="c1">// object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structFn</span><span class="p">());</span> <span class="c1">// object</span>

<span class="kd">var</span> <span class="nx">originalFn1</span> <span class="o">=</span> <span class="nx">Plus</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">structFn1</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="nx">Plus</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">originalFn1</span><span class="p">);</span> <span class="c1">// function</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structFn1</span><span class="p">);</span> <span class="c1">// function</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">originalFn1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="c1">// 4</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structFn1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span> <span class="c1">// 5</span>

<span class="kd">var</span> <span class="nx">structStr</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">structNum</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="k">new</span> <span class="nb">Number</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structStr</span><span class="p">);</span> <span class="c1">// string object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structNum</span><span class="p">);</span> <span class="c1">// number object</span>

<span class="kd">var</span> <span class="nx">structObject</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">structArray</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structObject</span><span class="p">);</span> <span class="c1">// object</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structArray</span><span class="p">);</span> <span class="c1">// array</span>

<span class="kd">var</span> <span class="nx">structBoolean</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="k">new</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">false</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structBoolean</span><span class="p">);</span> <span class="c1">// boolean object</span>


<span class="kd">var</span> <span class="nx">structDate</span> <span class="o">=</span> <span class="nx">Struct</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">structDate</span><span class="p">);</span> <span class="c1">// date object</span>
</code></pre></div>
<h2 id="4">4. 정리하며</h2>

<ul>
<li><p>그럼 언제 사용하면될까?</p>

<ul>
<li><p>개인적인 생각으로는 이럴때가 아닌가 싶다?</p>

<ul>
<li><p>클래스로 만들기에는 너무 간단한 구조인 경우.</p>

<ul>
<li><p>사실 이 경우, 반드시 <strong>구조</strong> 만의 문제는 아닐 수 있다.</p>

<ul>
<li>만약 모든 경우에 <strong>클래스</strong>를 사용한다면, 위에서 언급한 봐와같이 <strong>객체</strong>는 <strong>Heap</strong> 영역에 <span style="color:#c11f1f">할당</span>될 것이며, 결국 <strong>GC</strong> 는 그 메모리 <strong>반환</strong>을 위해 쓸때 없는 리소스를 <strong>낭비</strong>하게 될 것이다.</li>
</ul></li>
</ul></li>
<li><p><strong>상속 구조</strong>를 만들 필요가 없는 경우.</p></li>
</ul></li>
<li><p>하지만, 이 두 가지 특징 모두 <strong><span style="color:#c11f1f">각 언어</span></strong>(C/C++/C# 등 구조체를 가진 모든 언어)가 가지는 <strong><span style="color:#c11f1f">특성</span></strong>에 따라 충분히 변할 수 있는 부분이므로 모든 언어에 <strong>적용</strong>된다고 말할 수는 없다.</p>

<ul>
<li><em>간단히 말해, 특정 <code>언어</code>가 <code>구조체</code>를 어떤 방식으로 <code>구현</code>하느냐에 따라, <code>사용 범위</code>도 크게 달라질 수 있다는 말과 같다.</em></li>
</ul></li>
</ul></li>
</ul>

<h2 id="5-url">5. 참고 URL</h2>

<ul>
<li><p><a href="https://msdn.microsoft.com/ko-kr/library/0taef578.aspx">C# 구조체 설명</a></p></li>
<li><p><a href="https://msdn.microsoft.com/ko-kr/library/0b0thckt.aspx">C# 클래스 설명</a></p></li>
<li><p><a href="http://stackoverflow.com/questions/13266616/primitive-value-vs-reference-value">primitive value vs reference value</a></p></li>
<li><p><a href="http://codingnuri.com/javascript-tutorial/javascript-primitive-types-and-reference-types.html">원시 타입과 참조 타입</a></p></li>
<li><p><a href="https://msdn.microsoft.com/ko-kr/library/4d43ts61(v=vs.90).aspx">값 형식 및 참조 형식(Visual C# Express)</a></p></li>
<li><p><a href="http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/">What is the Execution Context &amp; Stack in JavaScript?</a></p></li>
<li><p><a href="http://stackoverflow.com/questions/11148353/javascript-scope-and-execution-context">javascript-scope-and-execution-context</a>=</p></li>
<li><p><a href="http://dsnight.tistory.com/50">C언어의 메모리 구조</a></p></li>
<li><p><a href="http://egloos.zum.com/recipes/v/5057426">STACK, HEAP에 관한 소고</a></p></li>
<li><p><a href="https://kldp.org/node/44714">도대체 [구조체]가 [클래스]보다 좋은점이 뭔가요?</a></p>

<ul>
<li><em>개인적으로 이런 글을 좋아한다.(다양한 생각들을 들을 수 있으며, 그로인해 많은 <code>영감</code>을 얻기도 한다)</em></li>
</ul></li>
<li><p><a href="https://opentutorials.org/course/1720/9735">메모리 구조</a></p></li>
<li><p><a href="http://adibong.tistory.com/169">프로그램과 메모리 , 스택과 힙</a></p></li>
</ul>

  </div>
  <div data-count="10" id="recommend-article"></div>
</article>

<section class="post-footer">
  <div class="related-posts">
    <div class="related-posts-title"><h2>Related Posts</h2></div>
    <div class="related-posts-list">
      <ul>
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
          
          <!---->
        
      </ul>
    </div>
  </div>
</section>

<section class="comments">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'mohwa'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</section>



      <div class="separator"></div>
    </div>
  </div>
  <footer>
    <section>
  <ul class="links">
      <li><a href="https://twitter.com/yanione" title="follow me" target="_blank"><i class="icon-twitter"></i></a></li>
      <li><a href="https://github.com/mohwa" title="github page" target="_blank"><i class="icon-github"></i></a></li>
  </ul>
<section>

  </footer>
  <script>
    <!-- Google Analytics -->
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-30470280-2', 'auto');
    ga('send', 'pageview');

    // include jekyll full text search
    // https://github.com/christian-fei/Simple-Jekyll-Search
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('results-container'),
      json: '/blog/search.json',
      searchResultTemplate: '<li><a href="{href}">{title}</a>&nbsp;&nbsp;&nbsp;{date}</li>',
      noResultsText: 'No results found'
    });

  </script>
  <script src="http://b.readtrend.com/j/s.js"></script>
</body>
</html>
