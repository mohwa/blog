<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!-- viewport 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- keyword 설정 -->
    <meta name="keywords" content="javascript">
    <!-- description 설정 -->
    <meta name="description" content="JavaScript Scope Chain 그리고 Closure 대해 알아보기" />

    <!-- open graph 설정 -->
    <meta property="og:type" content="mohwa blog">
    <meta property="og:title" content="Scope Chain 그리고 Closure">
    <meta property="og:description" content="JavaScript Scope Chain 그리고 Closure 대해 알아보기">
    <!--<meta property="og:image" content="http://mysite.com/myimage.jpg">-->
    <meta property="og:url" content="/blog">

    <meta name="copyright" content="by mohwa" />

    <!--<link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />-->

    <!-- google search console 설정 -->
    <link rel="alternate" hreflang="ko" href="http://mohwa.github.io" />
    <link rel="alternate" hreflang="ko" href="https://mohwa.github.io" />

    <link rel="stylesheet" href="/blog/assets/css/site.css" />
    <link rel="stylesheet" href="/blog/bower_components/highlightjs/styles/darkula.css">

    <script src="/blog/bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/highlightjs/highlight.pack.min.js" type="text/javascript"></script>
    <script src="/blog/bower_components/purl/purl.js" type="text/javascript"></script>
    <!-- Script pointing to jekyll-search.js -->
    <script src="/blog/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>

    <title>Scope Chain 그리고 Closure</title>

    <script type="text/javascript">

        // code highlight 적용
        // https://highlightjs.org/static/demo/
        $(document).ready(function() {
            $('pre code').each(function(i, block) {
                hljs.highlightBlock(block);
            });
        });
    </script>
</head>

<body>

  <div class="top-bar"></div>

  <div class="container">
    <div class="site">
      <header>
        <nav>
    <span style="float:left;">
        <a class="" href="/blog/">Home</a>
        <!--<a class="" href="/archive/">전체글</a>-->
        <!--<a class="" href="//github.com/nolboo/nolboo.github.io/wiki">번역글 위키</a>-->
    </span>
    <span style="float:right;">
        <div id="search-container" class="search-container">
            <input type="text" id="search-input" class="search-input" placeholder="search...">
        </div>
    </span>
</nav>

        <div class="pull-right right logo">
          <div class="name"></div>
          <!--<a href="/feed.xml"><img class="avatar" src="/images/rss.jpg" alt="RSS" /></a>-->
        </div>
      </header>
      <div class="separator"></div>
      <ul id="results-container" class="results-container"></ul>
      <article>
  <h1>
    Scope Chain 그리고 Closure
  </h1>
  <div class="center">
    <p class="meta">11 Oct 2015</p>
  </div>



  <div class="post">
  <ul>
<li><p>Execution Context 와 <span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="c1">// global execution context</span>

    <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

      <span class="c1">// A 함수 선언식 내부</span>
      <span class="c1">// function execution context</span>
      <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// AO.x</span>

      <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

        <span class="c1">// B 함수 선언식 내부</span>
        <span class="c1">// active function execution context</span>
        <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// AO.y</span>
      <span class="p">}</span>

      <span class="nx">B</span><span class="p">();</span> <span class="c1">// AO.B() == null.B()</span>
    <span class="p">}</span>

    <span class="nx">A</span><span class="p">();</span> <span class="c1">// this.A();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">// B function execution context</span>
    <span class="o">&lt;</span><span class="nx">B</span><span class="o">&gt;</span> <span class="nx">activeFunctionExecutionContext</span><span class="o">:</span> <span class="p">{</span> 
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
        <span class="p">},</span>     
        <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">},</span>                         
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="c1">// A function execution context</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">},</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">]</span>          
    <span class="p">},</span>
    <span class="c1">// global execution context</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
<li><p>Global Execution Context 의 <strong>Scope Chain</strong></p>

<ul>
<li><p>Global Execution Context 내부에 생성되는 <strong>Scope Chain</strong> 은 globalExecutionContext.VO 만 <strong>포함</strong>한다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">globalExecutionContext</span><span class="o">:</span><span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">...</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>
    <span class="p">}</span>
</code></pre></div></li>
</ul></li>
<li><p><strong>함수 생명 주기</strong> 와 Function Execution Context 의 <strong>Scope Chain</strong></p>

<ul>
<li>함수 생명 주기는 <strong>함수 생성</strong>과 <strong>함수 호출</strong>로 나눌 수 있다.</li>
<li><p>함수 생성</p>

<ul>
<li><strong>함수 생성 시</strong> [[Scope]] property 가 <strong>생성</strong>된다.<p></li>
<li>[[Scope]] property 는 직접적인 접근이 불가능하며, <strong>초기화</strong>된 값은 변경되지 않는다.<p></li>
<li>[[Scope]] property 는 해당 Function Execution Context 상위에 있는 <u>모든 부모 계층의 <span style="color:#c11f1f">VO</span> 를 갖는다.</u><p></li>
<li><p>A 함수를 선언한다</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">함수 생성</span> 시 함수 객체 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">A</span><span class="o">:</span> <span class="p">{</span>
    <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
      <span class="c1">// A 함수는 [[Scope]] property 를 통해 global execution context 의 VO 를 갖는다.</span>
      <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
    <span class="p">];</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p>함수 내부에 또 다른 함수 생성</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="c1">// 변수 선언 VO.x</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>
    <span class="c1">// 변수 선언 AO.y</span>
    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

      <span class="c1">// function execution context</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p>각 함수 객체 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">A</span><span class="o">:</span> <span class="p">{</span>
      <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// A 함수는 global execution context 의 VO 를 갖는다.</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">];</span>
    <span class="p">}</span>

    <span class="nx">B</span><span class="o">:</span> <span class="p">{</span>
      <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// B 함수는 global execution context 의 VO 와 부모 함수인 A 함수의 AO(VO)를 갖는다.                    </span>
        <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">),</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">];</span>
    <span class="p">}</span>
</code></pre></div></li>
</ul></li>
<li><p>함수 호출</p>

<ul>
<li>함수 호출 시, Function Execution Context 내부에 <strong>Scope Chain</strong> 이 추가된다.<p></li>
<li><p><strong>Scope Chain</strong> 은 함수 [[Scope]] property 를 그대로 가져가 <strong>초기화</strong>되며, Function Execution Context 내부 <span style="color:#c11f1f">AO</span>(VO)는 <strong>Scope Chain</strong> 의 <u><strong>가장 앞</strong>에 추가된다.</u></p>

<p><img src="http://figures.oreilly.com/tagoreillycom20090601oreillybooks300541I_book_d1e1/figs/I_mediaobject7_d1e6895-web.png" alt="">      </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span> <span class="c1">// call A function object</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">// A function execution context</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// 함수 호출 시, 생성된 AO 는 Scope Chain 의 가장 앞(ScopeChain[0])에 추가되며, 식별자 검색 시 가장 먼저 검색된다.</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
        <span class="p">},</span>                  
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>                                
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>                  
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><p>식별자 해석 과정</p>

<ul>
<li><strong>식별자</strong> 검색 순서는 <u><strong>Scope Chain</strong> 의 가장 <strong>바닥</strong>(ScopeChain[0])에서부터</u>, <u>가장 <strong>상위</strong>(ScopeChain[scope.length]) 까지</u> 검색 후, 그 값을 반환한다.</li>
<li><p>즉, 이와같은 <strong>검색 매커니즘</strong>에 의해, 해당 <strong>함수</strong>가 가진 <span style="color:#c11f1f">AO</span>(VO) 의 속성을 가장 빠르게 <strong>접근</strong>할 수 있으며, Global Execution Context 내부 <span style="color:#c11f1f">VO</span> 의 속성에 <strong>접근</strong>하는것이 가장 느린것이다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="c1">// functionExecutionContext.scopeChain.globalExecutionContext.VO.x                </span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
    <span class="c1">// functionExecutionContext.scopeChain.AO.y</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>
        <span class="p">},</span>                  
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>                                
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>                  
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
<li><p>만약, 각 Execution Context 에 선언된 <strong>식별자 이름</strong>이 같은 경우, 위에서 언급한 <strong>Scope Chain</strong> 의 <strong>검색 순서</strong>로 해당 값이 정해지게 된다.</p></li>
<li><p>BFunctionExecutionContext.AO.y</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="c1">// function execution context</span>

  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

    <span class="c1">// active function execution context</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

    <span class="c1">// BFunctionExecutionContext.AO.y</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 3</span>
  <span class="p">}</span>

  <span class="nx">B</span><span class="p">();</span> <span class="c1">// AO.B() === null.B();</span>
<span class="p">}</span>

<span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p>AFunctionExecutionContext.AO.y</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

      <span class="c1">// active function execution context</span>

      <span class="c1">// B 함수에 선언된 y 변수를 삭제한다.</span>
      <span class="c1">// var y = 3;</span>
      <span class="c1">// AFunctionExecutionContext.AO.y</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
    <span class="p">}</span>

    <span class="nx">B</span><span class="p">();</span> <span class="c1">// AO.B() === null.B();</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p>globalExecutionContext.VO.y</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>
  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// A 함수에 선언된 y 변수를 삭제한다.</span>
    <span class="c1">// var y = 2;</span>

    <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

      <span class="c1">// active function execution context</span>
      <span class="c1">// B 함수에 선언된 y 변수를 삭제한다.</span>
      <span class="c1">// var y = 3;</span>

      <span class="c1">// globalExecutionContext.VO.y</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 1</span>
    <span class="p">}</span>

    <span class="nx">B</span><span class="p">();</span> <span class="c1">// AO.B() === null.B();</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>

  <span class="o">&lt;</span><span class="nx">B</span><span class="o">&gt;</span> <span class="nx">activeFunctionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">3</span>
    <span class="p">},</span>
    <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">3</span>
      <span class="p">},</span>                
      <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">},</span>                
      <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nx">B</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">},</span>                
      <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
      <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
    <span class="p">]</span>                
  <span class="p">}</span>
<span class="p">];</span>
</code></pre></div></li>
<li><p>또 다른 Scope Chain 예</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">var</span> <span class="nx">num2</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">){</span>

  <span class="c1">// function execution context</span>

  <span class="c1">// result 변수는 undefined 로 초기화된다.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span> <span class="c1">// undefined</span>

  <span class="c1">// functionExecution.AO.num1</span>
  <span class="c1">// functionExecution.AO.num2</span>
  <span class="k">return</span> <span class="nx">num1</span> <span class="o">+</span> <span class="nx">num2</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

<span class="c1">// 실행 코드 처리 후 result 변수에 15 가 할당된다.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span> <span class="c1">// 15</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">add</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
          <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
          <span class="mi">1</span><span class="o">:</span> <span class="mi">10</span>
        <span class="p">},</span>
        <span class="nx">num1</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="nx">num2</span><span class="o">:</span> <span class="mi">10</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
            <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="mi">1</span><span class="o">:</span> <span class="mi">10</span>
          <span class="p">},</span>
          <span class="nx">num1</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
          <span class="nx">num2</span><span class="o">:</span> <span class="mi">10</span>
        <span class="p">},</span>                  
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">result</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
          <span class="nx">add</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
          <span class="nx">num2</span><span class="o">:</span> <span class="mi">5</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">result</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>                  
        <span class="nx">add</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
        <span class="nx">num2</span><span class="o">:</span> <span class="mi">5</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>                  
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>JS 에서 말하는 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures">Closure</a>란? 별도의 <strong>개념</strong>이 아닌, <u><strong>Scope Chain 매커니즘</strong></u>에 의한 <strong>바인딩 환경</strong>을 말하는것이다.<p></p>

<ul>
<li><p>일반적인 Closure 환경</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

      <span class="c1">// function execution context;</span>

      <span class="c1">// 식별자 검색을 통해, 상위 계층의 VO 에 접근하여 결과를 반환한다.</span>
      <span class="c1">// AFunctionExecutionContext.scopeChain[1].VO.x</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p>하지만 Closure <strong>환경</strong>으로 인해, <strong>메모리 누수</strong>가 발생할 수 있다.</p>

<ul>
<li>makeAdder 함수 호출 시, 반환받은 add5 함수 [[Scope]] 속성에는, 모든 부모 계층의 <span style="color:#c11f1f">VO, AO(VO)</span> 가 <strong>영구적</strong>으로 포함된다.</li>
<li><p>즉 makeAdder 함수(상위 계층) 종료 시, 소멸되는 <span style="color:#c11f1f">AO(VO)</span> 가, 해당 [[Scope]] 속성 내부에 영구적으로 보관된다는 것이다.(<strong>메모리 누수의 원인</strong>)</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="kd">function</span> <span class="nx">makeAdder</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// function execution context</span>

    <span class="c1">// 반환되는 익명함수에는 Scope Chain 매커니즘에 의해 부모 계층의 모든 VO 가 포함되어있다.</span>
    <span class="c1">// 부모 계층의 AO(VO)({x: 5})</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// function execution context</span>
      <span class="c1">// Scope Chain 의 식별자 검색을 통해 부모 계층의 Vo.x 속성을 사용한다.</span>

      <span class="c1">// anonymousFunctionExecutionContext.scopeChain.makeAdderFunctionExecutionContext.AO.x</span>
      <span class="c1">// anonymousFunctionExecutionContext.scopeChain.AO.y</span>
      <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">add5</span> <span class="o">=</span> <span class="nx">makeAdder</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

  <span class="nx">print</span><span class="p">(</span><span class="nx">add5</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>  <span class="c1">// 7</span>
</code></pre></div></li>
<li><p>anonymousFunction(= add5) 함수 [[Scope]] 속성 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">anonymousFunction</span><span class="p">(</span><span class="o">=</span> <span class="nx">add5</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
  <span class="p">[[</span><span class="nx">Scope</span><span class="p">]]</span><span class="o">:</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">makeAdder</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span>                
      <span class="p">},</span>
      <span class="nx">x</span><span class="o">:</span> <span class="mi">5</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">makeAdder</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
      <span class="nx">add5</span><span class="o">:</span> <span class="kc">undefined</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></li>
<li><p>anonymousFunction(= add5) 함수 <strong>Scope Chain</strong> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"> <span class="nx">anonymousFunction</span><span class="p">(</span><span class="o">=</span> <span class="nx">add5</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">AO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">2</span>                
      <span class="p">},</span>
      <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span>                
    <span class="p">},</span>
    <span class="o">&lt;</span><span class="nx">makeAdder</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="p">.</span><span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="mi">0</span><span class="o">:</span> <span class="mi">5</span>                
      <span class="p">},</span>
      <span class="nx">x</span><span class="o">:</span> <span class="mi">5</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">makeAdder</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
      <span class="nx">add5</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></li>
</ul></li>
</ul></li>
<li><p>Eval Execution Context 의 <strong>Scope Chain</strong></p>

<ul>
<li>eval execution context 의 <strong>Scope Chain</strong> 은 calling context 의 <strong>Scope Chain</strong> 을 따라간다.</li>
<li><p>즉 <span style="color:#6298c1">eval</span> 함수가 포함된 execution context 의 <strong>Scope Chain</strong> 을 갖는다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="nx">evalExecutionContext</span><span class="p">.</span><span class="nx">Scope</span> <span class="o">===</span> <span class="nx">callingContext</span><span class="p">.</span><span class="nx">Scope</span><span class="p">;</span>
</code></pre></div></li>
<li><p>실행 코드 </p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// global execution context 의 Scope Chain 을 갖는다.</span>
  <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;console.log(x)&#39;</span><span class="p">);</span> <span class="c1">// 1</span>

  <span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="c1">// A function execution context 의 Scope Chain 을 갖는다.</span>
    <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;console.log(x, y)&#39;</span><span class="p">);</span> <span class="c1">// 1 2</span>

    <span class="kd">function</span> <span class="nx">B</span><span class="p">(){</span>

      <span class="c1">// B function execution context 의 Scope Chain 을 갖는다.</span>

      <span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

      <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;console.log(x, y, z)&#39;</span><span class="p">);</span> <span class="c1">// 1 2 3</span>
    <span class="p">}</span>

    <span class="nx">B</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">A</span><span class="p">();</span>      
</code></pre></div></li>
</ul></li>
<li><p>Function 생성자 함수</p>

<ul>
<li><p><span style="color:#c11f1f">Function 생성자 함수</span>를 통한, <strong>함수 생성 시</strong> 생성되는 [[Scope]] property 에는 Global Execution Context 의 <span style="color:#c11f1f">VO</span> 만 포함된다.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;console.log(x, y);&#39;</span><span class="p">);</span> <span class="c1">// 1, 2</span>

<span class="nx">fn</span><span class="p">();</span>
</code></pre></div></li>
<li><p>globalExecutionContext 의 x 변수에 접근</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="c1">// function execution context</span>

  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;console.log(x);&#39;</span><span class="p">);</span> <span class="c1">// 1</span>

  <span class="nx">fn</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p>functionExecutionContext 의 y 변수에 접근</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

  <span class="c1">// function execution context</span>

  <span class="c1">// AFunctionExecutionContext.AO.y</span>
  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">(</span><span class="s1">&#39;console.log(y);&#39;</span><span class="p">);</span> <span class="c1">// Uncaught ReferenceError: y is not defined</span>

  <span class="nx">fn</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
</ul></li>
<li><p>Prototype Chain 확장 검색</p>

<ul>
<li>만약 <strong>Scope Chain</strong> 내부 <span style="color:#c11f1f">VO</span> 에 원하는 <strong>식별자 이름</strong>이 없을경우, <span style="color:#c11f1f">VO</span> 객체의 <strong>원형</strong>인 Object.prototype 까지 검색 후 찾아낸다.</li>
<li><p>즉 <em>Global Execution Context 내부 <span style="color:#c11f1f">VO</span> 는 그 원형인 Object.prototype 객체를 참조할 수 있다.</em></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="kd">function</span> <span class="nx">A</span><span class="p">(){</span>

    <span class="c1">// 어떤 execution context 의 VO 에도 x 속성이 선언하지 않았다.</span>

    <span class="c1">// function execution context</span>
    <span class="c1">// globalExecutionContext.VO.__proto__.x 속성을 참조한다.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">dir</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="p">}</span>

<span class="c1">// Object 객체의 원형을 확장한다.</span>
<span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="nx">A</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// A function object</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">},</span>              
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
          <span class="nx">__proto__</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">A</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
        <span class="nx">__proto__</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>              
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><p><strong>Scope Chain</strong> 을 <strong>확장</strong>하는 with 문 과 catch 절</p>

<ul>
<li><p>with 문</p>

<ul>
<li>with 문을 만나면, 해당 Execution Context 의 <strong>Scope Chain</strong> 은 전달된 인자로 <strong>확장</strong>된다.<p></li>
<li><p><span style="color:#c11f1f">실행 코드</span></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// global execution context</span>

<span class="c1">// globalExecutionContext.VO.person</span>
<span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Nicholas&#39;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span>
<span class="p">};</span>

<span class="c1">// globalExecutionContext.VO.num2</span>
<span class="kd">var</span> <span class="nx">num2</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// globalExecutionContext.VO.displayInfo</span>
<span class="kd">function</span> <span class="nx">displayInfo</span><span class="p">(){</span>

    <span class="c1">// function execution context</span>
    <span class="c1">// displayInfoFunctionExecutionContext.AO.count</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

    <span class="c1">// with 문에 전달된 인자(person)로 해당 Scope Chain 이 확장된다.</span>
    <span class="kd">with</span> <span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Angel&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">18</span><span class="p">}){</span>

        <span class="c1">// 확장된 Scope Chain 을 통해 객체 속성에 접근한다.</span>
        <span class="c1">// displayInfoFunctionExecutionContext.scopeChain.withObject.name</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// &#39;Angel&#39;</span>
        <span class="c1">// displayInfoFunctionExecutionContext.scopeChain.withObject.age</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">age</span><span class="p">);</span> <span class="c1">// 18</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">displayInfo</span><span class="p">();</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">&lt;</span><span class="nx">displayInfo</span><span class="o">&gt;</span> <span class="nx">functionExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">},</span>
        <span class="nx">count</span><span class="o">:</span> <span class="mi">5</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="c1">// with 문으로 인해, Scope Chain 이 확장된다.(Scope Chain 의 가장 앞(ScopeChain[0])에 추가된다.</span>
        <span class="kd">with</span><span class="p">(</span><span class="nx">VO</span><span class="p">(</span><span class="nx">person</span><span class="p">))</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Angel&#39;</span><span class="p">,</span>
          <span class="nx">age</span><span class="o">:</span> <span class="mi">18</span>
        <span class="p">},</span>    
        <span class="nx">AO</span><span class="p">(</span><span class="nx">VO</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">arguments</span><span class="o">:</span> <span class="p">{</span>
          <span class="p">},</span>
          <span class="nx">count</span><span class="o">:</span> <span class="mi">5</span>
        <span class="p">},</span>                                  
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Nicholas&#39;</span><span class="p">,</span>
            <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span>
          <span class="p">},</span>
          <span class="nx">displayInfo</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
          <span class="nx">num2</span><span class="o">:</span> <span class="mi">10</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">person</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Nicholas&#39;</span><span class="p">,</span>
          <span class="nx">age</span><span class="o">:</span> <span class="mi">30</span>
        <span class="p">},</span>
        <span class="nx">displayInfo</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">reference</span> <span class="nx">to</span> <span class="kd">function</span> <span class="o">&gt;</span><span class="p">,</span>
        <span class="nx">num2</span><span class="o">:</span> <span class="mi">10</span>
      <span class="p">},</span>
      <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span>
      <span class="p">]</span>                  
    <span class="p">}</span>
  <span class="p">];</span>
</code></pre></div></li>
</ul></li>
<li><p>catch 절</p>

<ul>
<li><p>catch 절을 만나면, 해당 Execution Context 의 <strong>Scope Chain</strong> 은 전달된 인자(ex)로 <strong>확장</strong>된다.<p></p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">  <span class="c1">// global execution context</span>

  <span class="k">try</span><span class="p">{</span>

    <span class="nx">a</span><span class="p">;</span> <span class="c1">// error</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="nx">ex</span><span class="p">){</span>

    <span class="c1">// globalExecutionContext.scopeChain.catchObject(ex).message</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></li>
<li><p><span style="color:#c11f1f">ECStack</span> 내부</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">ECStack</span> <span class="o">=</span> <span class="p">[</span>
      <span class="nx">globalExecutionContext</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">},</span>
        <span class="nx">Scope</span><span class="p">(</span><span class="nx">Scope</span> <span class="nx">Chain</span><span class="p">)</span><span class="o">:</span> <span class="p">[</span>
          <span class="k">catch</span><span class="p">(</span><span class="nx">VO</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">exception</span> <span class="nx">object</span><span class="o">&gt;</span><span class="p">))</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;a is not defined&#39;</span><span class="p">,</span>
            <span class="p">...</span>
          <span class="p">},</span>                    
          <span class="nx">globalExecutionContext</span><span class="p">.</span><span class="nx">VO</span><span class="o">:</span> <span class="p">{</span>
          <span class="p">}</span>
        <span class="p">]</span>                   
      <span class="p">}</span>
    <span class="p">];</span>
</code></pre></div></li>
</ul></li>
</ul></li>
</ul>

<h2 id="url">참고 URL</h2>

<ul>
<li><p><a href="http://dmitrysoshnikov.com/ecmascript/chapter-4-scope-chain/">ECMA-262-3 in detail. Chapter 4. Scope chain.</a><p></p></li>
<li><p><a href="http://archive.oreilly.com/pub/a/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html">Writing Efficient JavaScript: Chapter 7 - Even Faster Websites</a></p></li>
</ul>

  </div>
  <div data-count="10" id="recommend-article"></div>
</article>

<section class="post-footer">
  <div class="related-posts">
    <div class="related-posts-title"><h2>Related Posts</h2></div>
    <div class="related-posts-list">
      <ul>
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/04/21/es6-object-literal/" title="ES6 object initializer">ES6 object initializer</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/03/24/es6-destructuring-assignment/" title="ES6 Destructuring assignment">ES6 Destructuring assignment</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/02/24/es6-const/" title="ES6 const">ES6 const</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/02/23/es6-let/" title="ES6 let">ES6 let</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/02/18/es6-arrow-function/" title="ES6 Arrow Function & This Test">ES6 Arrow Function & This Test</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/02/15/es6-class/" title="ES6 Class #1">ES6 Class #1</a></li>
          
          
          <!---->
        
          <!-- match 를 false 로 초기화한다 -->
          <!---->
          
          <!-- 현재 page.categories === category 와 동일하다면. -->
          
              <li><a href="/blog/javascript/2016/02/05/proto/" title="__proto__ 속성과 프로토타입 위임 과정">__proto__ 속성과 프로토타입 위임 과정</a></li>
          
          
          <!---->
        
      </ul>
    </div>
  </div>
</section>

<section class="comments">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'mohwa'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</section>



      <div class="separator"></div>
    </div>
  </div>
  <footer>
    <section>
  <ul class="links">
      <li><a href="https://twitter.com/yanione" title="follow me" target="_blank"><i class="icon-twitter"></i></a></li>
      <li><a href="https://github.com/mohwa" title="github page" target="_blank"><i class="icon-github"></i></a></li>
  </ul>
<section>

  </footer>
  <script>
    <!-- Google Analytics -->
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-30470280-2', 'auto');
    ga('send', 'pageview');

    // include jekyll full text search
    // https://github.com/christian-fei/Simple-Jekyll-Search
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('results-container'),
      json: '/blog/search.json',
      searchResultTemplate: '<li><a href="{href}">{title}</a>&nbsp;&nbsp;&nbsp;{date}</li>',
      noResultsText: 'No results found'
    });

  </script>
  <script src="http://b.readtrend.com/j/s.js"></script>
</body>
</html>
